/*! VersionVI: 30F200057k x */
function WDTableauAssociatif(n,t,i){arguments.length&&(this.m_bSansEspace=0!=(n&this.ms_nSansEspace),this.m_bSansCasse=0!=(n&this.ms_nSansCasse),this.m_bAvecDoublon=0!=(n&this.ms_nAvecDoublon),this.m_oValeurParDefaut=t,this.m_nTypeCle=i,this.m_oValeurs={},this.m_tabElements=[])}function WDIterateur(n,t){arguments.length&&(this.m_oCible=n,this.m_bAscendant=!!(t&2),this.m_bSelectionne=!!(t&4),this.m_nCompteur=-1,this.ms_tabIterateurs.push(this))}function WDIterateurTableau(n){if(arguments.length){while(this.__bEstTableauAPlusieursDimensions(n))n=this.__tabLineariseTableau(n);WDIterateur.prototype.constructor.apply(this,arguments)}}function WDIterateurTableauAssociatif(n,t,i){arguments.length&&(WDIterateurTableau.prototype.constructor.apply(this,arguments),this.m_bFiltre=null!==i&&undefined!==i,this.m_bFiltre&&(this.m_oCleFiltre=i))}function WDIterateurChaine(n,t,i){arguments.length&&(this.m_sSeparateur=null===i?"\t":i,WDIterateurTableau.prototype.constructor.apply(this,[n.length>0?n.split(this.m_sSeparateur):[],t]))}function WDIterateurChainePosition(n,t,i,r){var o,e,u,f;if(arguments.length){for(0!=(r&this.ms_nDepuisFin)&&t&2&&(t-=2),o=0!=(r&this.ms_nMotComplet),r&this.ms_nSansCasse&&(n=n.toLowerCase(),i=i.toLowerCase()),e=[],u=n.indexOf(i);-1!=u;u=n.indexOf(i,u+1)){if(o){if(f=u-1,0<=f&&null==n.charAt(f).match(this.ms_oDebutFinMot))continue;if(f=u+i.length,f<n.length&&null==n.charAt(f).match(this.ms_oDebutFinMot))continue}e.push(u+1)}WDIterateurTableau.prototype.constructor.apply(this,[e,t])}}function WDIterateurTableZRNavigateur(){arguments.length&&(WDIterateur.prototype.constructor.apply(this,arguments),this.m_nForceSelectionInitial=this.m_oCible.nGetForceSelection())}function WDIterateurListeCombo(n){if(arguments.length){WDIterateur.prototype.constructor.apply(this,arguments);var i=n.length,t=[];clWDUtil.bForEach(n.options,function(n,i){return n.selected&&(t.push(i),n.selected=!1),!0});this.m_tabSelection=t;this.m_nOccurrence=this.m_bSelectionne?t.length:i}}var clWDTableau={},clWLangage;clWDTableau.__bEstAssociatif=function(n){return n instanceof WDTableauAssociatif};clWDTableau.__bEstTableau=function(n,t){return n instanceof Array?!0:Array.isArray?Array.isArray(n):"object"==typeof n&&undefined!==n.length?!0:t&&"string"!=typeof n?undefined!==n.length:!1};clWDTableau.__oCalculIndiceEffectif=function(n,t){switch(t){case 1:default:return t-1;case WDIterateur.prototype.ms_oElementCourant:var i=WDIterateur.prototype.s_oGetIterateur(n);return i?i.nGetCompteurDirect():undefined;case 2271560482:case-2023406814:return n.length-1}};clWDTableau.TableauSupprimeTout=function(n){this.__bEstAssociatif(n)?n.SupprimeTout():this.__bEstTableau(n)&&(n.length=0)};clWDTableau.nTableauSupprime=function(n,t){return this.__bEstAssociatif(n)?n.nSupprime(t):this.__bEstTableau(n)?(n.splice(this.__oCalculIndiceEffectif(n,t),1),1):0};clWDTableau.nTableauOccurrence=function(n){return this.__bEstAssociatif(n)?n.GetProp(23):this.__bEstTableau(n,!0)?n.length:1};clWDTableau.nTableauOccurrenceRecursif=function(n,t){if(this.__bEstAssociatif(n))return this.nTableauOccurrence(n);if(this.__bEstTableau(n,!0)){if(t&&undefined===n.length)return 1;for(var r=0,u=n.length,i=0;i<u;i++)r+=this.nTableauOccurrenceRecursif(n[i],!0);return r}return 1};Array.prototype.nOccurrenceRecursif=function(){return clWDTableau.nTableauOccurrenceRecursif(this)};clWDTableau.TableauInsere=function(n,t,i){var u,r,f;if(this.__bEstAssociatif(n))n.SetValeur(t,i);else if(this.__bEstTableau(n))if(u=t-1,this.__bEstTableau(i))for(f=i.length,r=0;r<f;r++)n.splice(u+r,0,i[r]);else n.splice(u,0,i)};clWDTableau.ContenuInitial=function(n,t,i,r){var e=i[t],o=t+1,f,s,u;for(n.length=e,f=o<i.length,s=r instanceof Function,u=0;u<e;u++)n[u]===undefined&&(n[u]=f?[]:s?new r:r),f&&this.ContenuInitial(n[u],o,i,r)};clWDTableau.oCreeGetIndice=function(n,t){for(var r,u=arguments.length,i=2;i<u-1;i++)t=t[arguments[i]];for(r=arguments[u-1];t.length<=r;)t.push(new n);return t[r]};WDTableauAssociatif.prototype.ms_nSansEspace=1;WDTableauAssociatif.prototype.ms_nSansCasse=16;WDTableauAssociatif.prototype.ms_nAvecDoublon=1073741824;WDTableauAssociatif.prototype.__sGetCle=function(n){var i,t;switch(this.m_nTypeCle){case 2:return!1!=n;case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 14:return i=parseInt(n,10),isNaN(i)?0:i;case 11:case 12:return parseFloat(n);case 16:case 19:return t=""+n,this.m_bSansEspace&&(t=clWDUtil.sSupprimeEspaces(t)),this.m_bSansCasse&&(t=t.toLowerCase()),t;default:return n}};WDTableauAssociatif.prototype.__tabGetValeurs=function(n){return this.m_oValeurs[this.__sGetCle(n)]};WDTableauAssociatif.prototype.__tabCreeValeurs=function(n){var t=[];return this.m_oValeurs[this.__sGetCle(n)]=t,t};WDTableauAssociatif.prototype.__oCalculIndiceEffectif=function(n){var t,i;switch(n){case 1:if(this.m_nTypeCle>=15)t=0;else return n;break;case WDIterateur.prototype.ms_oElementCourant:if(i=WDIterateur.prototype.s_oGetIterateur(this),i)t=i.nGetCompteurDirect();else return undefined;break;case 2271560482:case-2023406814:t=this.m_tabElements.length-1;break;default:if(this.m_nTypeCle>=15&&"number"==typeof n)t=parseInt(n,10)-1;else return n}return 0<=t&&t<this.m_tabElements.length?this.m_tabElements[t].m_oCle:undefined};WDTableauAssociatif.prototype.GetProp=function(n,t){switch(n){case 23:if(undefined!==t){var i=this.__tabGetValeurs(t);return undefined===i?0:i.length}return this.m_tabElements.length;case 24:return 0==this.GetProp(23,t);default:return null}};WDTableauAssociatif.prototype.SetContenu=function(n){var t,r,u,f,i;if(this.SupprimeTout(),clWDTableau.__bEstAssociatif(n))for(u=n.m_tabElements,r=u.length,t=0;t<r;t++)f=u[t],this.SetValeur(f.m_oCle,f.m_oValeur);else if(clWDTableau.__bEstTableau(n))for(r=n.length,t=0;t<r;t++)i=n[t],clWDTableau.__bEstTableau(i)&&2==i.length&&this.SetValeur(i[0],i[1])};WDTableauAssociatif.prototype.SetValeur=function(n,t){var i=this.__tabGetValeurs(n),r;undefined===i&&(i=this.__tabCreeValeurs(n));this.m_bAvecDoublon||undefined===i[0]?(r={m_oCle:n,m_oValeur:t},i.push(r),this.m_tabElements.push(r)):(i[0].m_oCle=n,i[0].m_oValeur=t)};WDTableauAssociatif.prototype.SetValeurIndice=function(n,t,i){var r=this.oGetValeurIndiceComplet(n,t,!0);r.m_oCle=n;r.m_oValeur=i};WDTableauAssociatif.prototype.oGetValeur=function(n){if(this.m_bAvecDoublon)throw new WDErreur(203);else{var t=this.__tabGetValeurs(n);return undefined!==t?t[0].m_oValeur:this.m_oValeurParDefaut}};WDTableauAssociatif.prototype.oGetValeurIndice=function(n,t){var i=this.oGetValeurIndiceComplet(n,t,!0);return undefined!==i?i.m_oValeur:this.m_oValeurParDefaut};WDTableauAssociatif.prototype.oGetValeurIndiceComplet=function(n,t,i){var r=this.__tabGetValeurs(n);if(undefined===r)if(i)throw new WDErreur(201);else return undefined;else if(t<0||r.length<=t)if(i)throw new WDErreur(202,r.length,t+1);else return undefined;return r[t]};WDTableauAssociatif.prototype.oGetValeurDirect=function(n,t){return this.m_tabElements[t?n:this.m_tabElements.length-1-n]};WDTableauAssociatif.prototype.SupprimeTout=function(){this.m_oValeurs={};this.m_tabElements.length=0};WDTableauAssociatif.prototype.nSupprime=function(n){var r=this.__oCalculIndiceEffectif(n),u=0,t=this.__tabGetValeurs(r),i,f;if(undefined!==t)for(u=t.length,delete this.m_oValeurs[this.__sGetCle(r)],f=t.length,i=0;i<f;i++)clWDUtil.SupprimeDansTableau(this.m_tabElements,t[i]);return u};WDIterateur.prototype.ms_oElementCourant={};WDIterateur.prototype.ms_tabIterateurs=[];WDIterateur.prototype.__s_bCompareCible=function(n,t){return n.bSurCible(t)};WDIterateur.prototype.s_oGetIterateur=function(n){return clWDUtil.oDansTableauFct(WDIterateur.prototype.ms_tabIterateurs,WDIterateur.prototype.__s_bCompareCible,n,null)};WDIterateur.prototype.s_oDeclareIterateur=function(n,t,i,r,u){var f;return f=clWDTableau.__bEstAssociatif(n)?new WDIterateurTableauAssociatif(n,t,i):undefined!==n.nodeType?new WDIterateurListeCombo(n,t):clWDTableau.__bEstTableau(n)?new WDIterateurTableau(n,t,i):window.WDTableZRNavigateur&&n instanceof WDTableZRNavigateur?new WDIterateurTableZRNavigateur(n,t):typeof n=="string"?r?new WDIterateurChainePosition(n,t,i,u):new WDIterateurChaine(n,t,i):new WDIterateur(n),f.Suivant(),f};WDIterateur.prototype.s_LibereIterateur=function(n){n._vLibere();clWDUtil.SupprimeDansTableau(WDIterateur.prototype.ms_tabIterateurs,n,!0)};WDIterateur.prototype.bSurCible=function(n){return n===this.m_oCible};WDIterateur.prototype.Suivant=function(){this.m_nCompteur++;this.m_bFini=!this._vbSuivant()};WDIterateur.prototype.bEstFini=function(){return this.m_bFini};WDIterateur.prototype._vbSuivant=function(){return!1};WDIterateur.prototype._vLibere=clWDUtil.m_pfVide;WDIterateur.prototype.nGetCompteur=function(){return this.nGetCompteurDirect()+1};WDIterateur.prototype.nGetCompteurDirect=function(){return this.m_nCompteur};WDIterateurTableau.prototype=new WDIterateur;WDIterateurTableau.prototype.constructor=WDIterateurTableau;WDIterateurTableau.prototype.__bEstTableauAPlusieursDimensions=function(n){return clWDUtil.bDansTableauFct(n,clWDTableau.__bEstTableau,undefined)};WDIterateurTableau.prototype.__tabLineariseTableau=function(n){for(var i=[],r=n.length,t=0;t<r;t++)i=i.concat(n[t]);return i};WDIterateurTableau.prototype.__nGetCompteurReel=function(){return this.m_bAscendant?this.m_nCompteur:this.m_oCible.length-this.m_nCompteur-1};WDIterateurTableau.prototype._vbSuivant=function(){return this.m_nCompteur<this.m_oCible.length};WDIterateurTableau.prototype.oGetValeur=function(){return this.m_oCible[this.__nGetCompteurReel()]};WDIterateurTableau.prototype.oGetCle=function(){return this.__nGetCompteurReel()+1};WDIterateurTableau.prototype.SetValeur=function(n){this.m_oCible[this.__nGetCompteurReel()]=n};WDIterateurTableauAssociatif.prototype=new WDIterateurTableau;WDIterateurTableauAssociatif.prototype.constructor=WDIterateurTableauAssociatif;WDIterateurTableauAssociatif.prototype._vbSuivant=function(){return this.m_oValeurComplet=this.m_bFiltre?this.m_oCible.oGetValeurIndiceComplet(this.m_oCleFiltre,this.m_nCompteur,!1):this.m_oCible.oGetValeurDirect(this.m_nCompteur,this.m_bAscendant),this.m_oValeurComplet!==undefined};WDIterateurTableauAssociatif.prototype.oGetValeur=function(){return this.m_oValeurComplet.m_oValeur};WDIterateurTableauAssociatif.prototype.oGetCle=function(){return this.m_oValeurComplet.m_oCle};WDIterateurTableauAssociatif.prototype.SetValeur=function(n){this.m_oValeurComplet.m_oValeur=n};WDIterateurChaine.prototype=new WDIterateurTableau;WDIterateurChaine.prototype.constructor=WDIterateurChaine;WDIterateurChaine.prototype.oGetCle=function(){var n=this.__nGetCompteurReel();return 0==n?1:this.m_oCible.slice(0,n).join("").length+n*this.m_sSeparateur.length+1};WDIterateurChainePosition.prototype=new WDIterateurTableau;WDIterateurChainePosition.prototype.constructor=WDIterateurChaine;WDIterateurChainePosition.prototype.ms_nDepuisFin=1;WDIterateurChainePosition.prototype.ms_nMotComplet=2;WDIterateurChainePosition.prototype.ms_nSansCasse=4;WDIterateurChainePosition.prototype.ms_oDebutFinMot=new RegExp("\\W","");WDIterateurTableZRNavigateur.prototype=new WDIterateur;WDIterateurTableZRNavigateur.prototype.constructor=WDIterateurTableZRNavigateur;WDIterateurTableZRNavigateur.prototype._vbSuivant=function(){var n;return this.m_bSelectionne?this.m_nCompteur<this.m_oCible.SelectOccurrence()&&(n=this.m_oCible.Select(this.m_nCompteur+1)-1):this.m_nCompteur<this.m_oCible.Occurrence()&&(n=this.m_nCompteur),undefined!==n?(this.m_oCible.ForceSelection(n),!0):!1};WDIterateurTableZRNavigateur.prototype._vLibere=function(){this.m_oCible.ForceSelection(this.m_nForceSelectionInitial)};WDIterateurTableZRNavigateur.prototype.oGetValeur=function(){return this.m_oCible.GetValeur()};WDIterateurTableZRNavigateur.prototype.oGetCle=function(){return this.m_nCompteur+1};WDIterateurListeCombo.prototype=new WDIterateur;WDIterateurListeCombo.prototype.constructor=WDIterateurTableZRNavigateur;WDIterateurListeCombo.prototype._vbSuivant=function(){return this.m_nCompteur<this.m_nOccurrence?(this.m_oCible.selectedIndex=this._oGetValeur(),!0):!1};WDIterateurListeCombo.prototype._vLibere=function(){var n=this.m_oCible,t=n.options;n.selectedIndex=-1;clWDUtil.bForEach(this.m_tabSelection,function(n){return t[n].selected=!0,!0})};WDIterateurListeCombo.prototype._oGetValeur=function(){return this.m_bSelectionne?this.m_tabSelection[this.m_nCompteur]:this.m_nCompteur};WDIterateurListeCombo.prototype.oGetValeur=function(){return this._oGetValeur()+1};WDIterateurListeCombo.prototype.oGetCle=function(){return this.m_nCompteur+1};clWLangage={};clWLangage.sConcatSeparateur=function(n,t,i){return t=""+t,undefined!==n?(n=""+n,0==n.length?t="":(t.length>n.length||t==n.substring(n.length-t.length))&&(t="")):n="",undefined!==i?(i=""+i,0==i.length?t="":(t.length>i.length||t==i.substring(0,t.length))&&(t="")):i="",n+t+i};clWLangage.sSelonInline=function(n){for(var r=arguments.length-2,i,t=1;t<=r;t++)if(n==t)return arguments[t];if(i=arguments[arguments.length-1],undefined!==i)return i;throw new WDErreur(200,n,r);};clWLangage.sDateSys=function(){return clWDUtil.sGetDateHeureWL(new Date,!1,!0,!1)};clWLangage.sHeureSys=function(){return clWDUtil.sGetDateHeureWL(new Date,!1,!1,!0)};clWLangage.__xnDateHeureDifference=function(n,t,i,r){return this.__xnGetJSFromWL(t,i,r)-this.__xnGetJSFromWL(n,i,r)};clWLangage.__xoGetDHFromWL=function(n,t,i){return new this.WDDateHeure(t,i,n,undefined,!1)};clWLangage.__xoGetJSFromWL=function(n,t,i){return this.__xoGetDHFromWL(n,t,i).m_oValeur};clWLangage.__xnGetJSFromWL=function(n,t,i){return this.__xoGetJSFromWL(n,t,i).getTime()};clWLangage.nDateDifference=function(n,t){return clWDUtil.dGetArrondiVersZero(this.__xnDateHeureDifference(n,t,!0,!1)/864e5)};clWLangage.nDateHeureDifference=function(n,t){return clWLangage.__sDureeVersChaine(new this.WDDuree(this.__xnDateHeureDifference(n,t,!0,!0)),"+/-JJJJJJJHHMMSSLL")};clWLangage.nHeureDifference=function(n,t){return clWDUtil.dGetArrondiVersZero(this.__xnDateHeureDifference(n,t,!1,!0)/10)};clWLangage.__sGetSigneObligatoire=function(n){return 0<=n.m_nValeur?"+":"-"};clWLangage.__sGetSigneOptionnel=function(n){return 0<=n.m_nValeur?"":"-"};clWLangage.__sGetJourSur7=function(n){return this.__GetProprietePositifComplete(n,2,7)};clWLangage.__sGetJour=function(n){return this.__GetProprietePositif(n,2)};clWLangage.__sGetHeure=function(n){return this.__GetProprietePositifComplete(n,3,2)};clWLangage.__sGetMinute=function(n){return this.__GetProprietePositifComplete(n,4,2)};clWLangage.__sGetSeconde=function(n){return this.__GetProprietePositifComplete(n,5,2)};clWLangage.__sGetMilliseconde=function(n){return this.__GetProprietePositifComplete(n,6,3)};clWLangage.__sGetCentiemeseconde=function(n){return clWDUtil.sCompleteEntier(Math.floor(this.__GetProprietePositif(n,6)/10),2)};clWLangage.__GetProprietePositif=function(n,t){return Math.abs(n.GetProp(t))};clWLangage.__GetProprietePositifComplete=function(n,t,i){return clWDUtil.sCompleteEntier(this.__GetProprietePositif(n,t),i)};clWLangage.__xsDeformateSigne=function(n,t){if(0<n.length){switch(n.charAt(n.length-1)){case"+":break;case"-":t.m_nValeur=-t.m_nValeur;break;default:throw new WDErreur(204);}return n.substr(0,n.length-1)}return n};clWLangage.__xsDeformateJourSur7=function(n,t){return this.__xsDeformateNombre(n,t,7,864e5)};clWLangage.__xsDeformateJour=function(n,t){for(var r=864e5,i;0<n.length;){if(i=parseInt(n.charAt(n.length-1),10),isNaN(i))break;else t.m_nValeur+=i*r,r*=10;n=n.substr(0,n.length-1)}return n};clWLangage.__xsDeformateHeure=function(n,t){return this.__xsDeformateNombre(n,t,2,36e5)};clWLangage.__xsDeformateMinute=function(n,t){return this.__xsDeformateNombre(n,t,2,6e4)};clWLangage.__xsDeformateSeconde=function(n,t){return this.__xsDeformateNombre(n,t,2,1e3)};clWLangage.__xsDeformateMilliseconde=function(n,t){return this.__xsDeformateNombre(n,t,3,1)};clWLangage.__xsDeformateCentiemeseconde=function(n,t){return this.__xsDeformateNombre(n,t,2,10)};clWLangage.__xsDeformateNombre=function(n,t,i,r){return n=clWDUtil.sCompleteEntier(n,i),t.m_nValeur+=parseInt(n.substr(n.length-i),10)*r,n.substr(0,n.length-i)};clWLangage.m_tabDureeVersChaineFormat=[[["+/-"],clWLangage.__sGetSigneObligatoire,clWLangage.__xsDeformateSigne],[["+"],clWLangage.__sGetSigneOptionnel,clWLangage.__xsDeformateSigne],[["JJJJJJJ"],clWLangage.__sGetJourSur7,clWLangage.__xsDeformateJourSur7],[["J","D"],clWLangage.__sGetJour,clWLangage.__xsDeformateJour],[["HH"],clWLangage.__sGetHeure,clWLangage.__xsDeformateHeure],[["MM"],clWLangage.__sGetMinute,clWLangage.__xsDeformateMinute],[["SS"],clWLangage.__sGetSeconde,clWLangage.__xsDeformateSeconde],[["LLL"],clWLangage.__sGetMilliseconde,clWLangage.__xsDeformateMilliseconde],[["LL"],clWLangage.__sGetCentiemeseconde,clWLangage.__xsDeformateCentiemeseconde]];clWLangage.__sCorrigeFormatDureePourConstantes=function(n){switch(n){case 0:return"+JHHMMSSLLL";case 1:return"+JHHMMSSLL";default:return n}};clWLangage.__sDureeVersChaine=function(n,t){var r=clWDUtil.__tabParseFormat(t,this.m_tabDureeVersChaineFormat,!1),i=[];return clWDUtil.bForEach(r,function(t){switch(typeof t){case"string":i.push(t);break;case"function":i.push(t.apply(clWLangage,[n]))}return!0}),i.join("")};clWLangage.sDureeVersChaine=function(n,t){return t=this.__sCorrigeFormatDureePourConstantes(t),this.__sDureeVersChaine(new this.WDDuree(n),t)};clWLangage.sChaineVersDuree=function(n,t){var u,f,r,i;for(t=this.__sCorrigeFormatDureePourConstantes(t),u=clWDUtil.__tabParseFormat(t,this.m_tabDureeVersChaineFormat,!0),f=new this.WDDuree(undefined),r=u.length-1;0<=r;r--){i=u[r];switch(typeof i){case"string":if(i.length<=n.length)n=n.substr(0,n.length-i.length);else return null;break;case"function":try{n=i.apply(clWLangage,[n,f])}catch(e){if(clWDUtil.bCatch(e))return null;throw e;}}}return f};clWLangage.nDateVersEntier=function(n){return this.__xoGetDHFromWL(n,!0,!1).toNumber()};clWLangage.nHeureVersEntier=function(n){return this.__xoGetDHFromWL(n,!1,!0).toNumber()};clWLangage.sEntierVersDate=function(n,t){var r=this.__xoGetDHFromWL(n,!0,!1),i=r.m_oValeur;switch(t){case"A":case"Y":return clWDUtil.sCompleteEntier(i.getFullYear(),4);case"M":return clWDUtil.sCompleteEntier(i.getMonth()+1,2);case"J":case"D":return clWDUtil.sCompleteEntier(i.getDate(),2);default:return r.toString()}};clWLangage.sEntierVersHeure=function(n){return this.__xoGetDHFromWL(n,!1,!0).toString().substr(0,8)};clWLangage.__xnEntierVersJour=function(n){return this.__xoGetJSFromWL(n,!0,!1).getDay()};clWLangage.nEntierVersJour=function(n){var t=this.__xnEntierVersJour(n);return t==0?7:t};clWLangage.sEntierVersJourEnLettres=function(n){return clWDUtil.sGetJourSemaine(this.__xnEntierVersJour(n))};clWLangage.nEntierVersMoisEnLettres=function(n){return clWDUtil.sGetMois(this.__xoGetJSFromWL(n,!0,!1).getMonth())};clWLangage.nNumeroDeSemaine=function(n){var f=this.__xoGetDHFromWL(n,!0,!1),i=new this.WDDateHeure(!0,!1,f,undefined,!1),u;i.SetProp(2,1);i.SetProp(1,1);var e=i.toNumber(),r=f.toNumber()-e,t=(e+657071)%7;switch(t){case 0:t=7;case 5:case 6:return u=8-t,r>=u?Math.floor((r-u)/7)+1:0;case 1:case 2:case 3:case 4:return Math.floor((r+t-1)/7)+1}};clWLangage.WDDateHeure=function(n,t,i,r,u){arguments.length&&(this.m_bDate=n,this.m_bHeure=t,this.m_sValeurInvalide=null,undefined!==r?this.m_oValeur=r:(this.m_oValeur=new Date,undefined!==i&&this.__SetValeur(i,u),t||this.m_oValeur.setHours(0,0,0,0)))};clWLangage.WDDateHeure.prototype.__toString=function(){return clWDUtil.sGetDateHeureWL(this.m_oValeur,!1,this.m_bDate,this.m_bHeure)};clWLangage.WDDateHeure.prototype.toString=function(){return""===this.m_sValeurInvalide?this.m_sValeurInvalide:(this._xDateValide(),this.__toString())};clWLangage.WDDateHeure.prototype.toStringAvecInvalide=function(){return this.bDateValide()?this.__toString():this.m_sValeurInvalide};clWLangage.WDDateHeure.prototype.toNumber=function(){this._xDateValide();var n=this.m_oValeur;return this.m_bDate&&this.m_bHeure?0:this.m_bDate?Math.floor((n.getTime()-n.getTimezoneOffset()*6e4)/864e5)+62092:this.m_bHeure?clWDUtil.dGetArrondiVersZero((n.getHours()*36e5+n.getMinutes()*6e4+n.getSeconds()*1e3+n.getMilliseconds())/10):void 0};clWLangage.WDDateHeure.prototype.bDateValide=function(){return null===this.m_sValeurInvalide};clWLangage.WDDateHeure.prototype._xDateValide=function(){if(!this.bDateValide())throw new WDErreur(204);};clWLangage.WDDateHeure.prototype.__oAdditionOffset=function(n){this.m_bDate&&this.m_bHeure||(this.m_bDate?n=clWDUtil.dGetArrondiVersZero(n/864e5)*864e5:this.m_bHeure&&(n-=clWDUtil.dGetArrondiVersZero(n/864e5)*864e5));var t=new clWLangage.WDDateHeure(this.m_bDate,this.m_bHeure);return t.m_oValeur.setTime(this.m_oValeur.getTime()+n),t};clWLangage.WDDateHeure.prototype.__xoAdditionOffset=function(n){return this._xDateValide(),this.__oAdditionOffset(n)};clWLangage.WDDateHeure.prototype.oAdditionDuree=function(n){return this.__xoAdditionOffset(n.m_nValeur)};clWLangage.WDDateHeure.prototype.oSoustractionDate=function(n){return this._xDateValide(),n._xDateValide(),new clWLangage.WDDuree(this.m_oValeur.getTime()-n.m_oValeur.getTime()-(this.m_oValeur.getTimezoneOffset()-n.m_oValeur.getTimezoneOffset())*6e4)};clWLangage.WDDateHeure.prototype.oSoustractionDuree=function(n){return this.__xoAdditionOffset(-n.m_nValeur)};clWLangage.WDDateHeure.prototype.GetProp=function(n){this._xDateValide();switch(n){case 0:return this.m_bDate?this.m_oValeur.getFullYear():0;case 1:return this.m_bDate?this.m_oValeur.getMonth()+1:0;case 2:return this.m_bDate?this.m_oValeur.getDate():0;case 3:return this.m_bHeure?this.m_oValeur.getHours():0;case 4:return this.m_bHeure?this.m_oValeur.getMinutes():0;case 5:return this.m_bHeure?this.m_oValeur.getSeconds():0;case 6:return this.m_bHeure?this.m_oValeur.getMilliseconds():0;case 7:return new clWLangage.WDDateHeure(!0,!1,undefined,this.m_oValeur,!1);case 8:return new clWLangage.WDDateHeure(!1,!0,undefined,this.m_oValeur,!1);default:return null}};clWLangage.WDDateHeure.prototype.__SetProp=function(n,t,i){this._xDateValide();var r,u;switch(n){case 0:r=this.m_oValeur.getDate();this.m_oValeur.setFullYear(this.__nGetValeurDansBornes(t,0,9999,i));break;case 1:r=this.m_oValeur.getDate();this.m_oValeur.setMonth(this.__nGetValeurDansBornes(t,1,12,i)-1);break;case 2:u=this.m_oValeur.getMonth();this.m_oValeur.setDate(this.__nGetValeurDansBornes(t,1,31,i));i&&u!=this.m_oValeur.getMonth()&&this.m_oValeur.setDate(0);break;case 3:this.m_oValeur.setHours(this.__nGetValeurDansBornes(t,0,23,i));break;case 4:this.m_oValeur.setMinutes(this.__nGetValeurDansBornes(t,0,59,i));break;case 5:this.m_oValeur.setSeconds(this.__nGetValeurDansBornes(t,0,59,i));break;case 6:this.m_oValeur.setMilliseconds(this.__nGetValeurDansBornes(t,0,999,i));break;case 7:new clWLangage.WDDateHeure(!0,!1,undefined,this.m_oValeur,!1).SetValeur(t);break;case 8:new clWLangage.WDDateHeure(!1,!0,undefined,this.m_oValeur,!1).SetValeur(t)}undefined!==r&&this.m_oValeur.getDate()!=r&&this.m_oValeur.setDate(0)};clWLangage.WDDateHeure.prototype.__nGetValeurDansBornes=function(n,t,i,r){if(n=parseInt(n,10),r){if(n<t)return t;if(i<n)return i}return n};clWLangage.WDDateHeure.prototype.SetProp=function(n,t){this.__SetProp(n,t,!0)};clWLangage.WDDateHeure.prototype.SetPropCombine=function(n,t){this.__SetProp(n,t,!1)};clWLangage.WDDateHeure.prototype.SetValeur=function(n){this.__SetValeur(n,!1)};clWLangage.WDDateHeure.prototype.__SetValeur=function(n,t){this.m_sValeurInvalide=null;var i=!0;switch(typeof n){case"string":i=this.__bSetValeurChaine(n);break;case"number":i=this.__bSetValeurNombre(n);break;case"object":i=this.__bSetValeurObjet(n)}if(!i)if(t||""===n)this.m_sValeurInvalide=n+"";else throw new WDErreur(204);};clWLangage.WDDateHeure.prototype.__bSetValeurChaine=function(n){if(clWDUtil.bSetDateHeureFromWL(this.m_oValeur,n,!1,this.m_bDate,this.m_bHeure,1)){var t=n;if(this.m_bHeure&&(t=clWDUtil.sCompleteChaine(t,this.m_bDate?17:9,"0")),t==this.toString())return!0}return!1};clWLangage.WDDateHeure.prototype.__bSetValeurNombre=function(n){var t,i;if(this.m_bDate&&this.m_bHeure)return!1;if(t=this.m_oValeur,this.m_bDate)return i=t.getHours()*36e5+t.getMinutes()*6e4+t.getSeconds()*1e3+t.getMilliseconds(),t.setTime((n-62092)*864e5+i),!0;if(this.m_bHeure){if(864e4<=n)return!1;t.setHours(Math.floor(n/36e4),Math.floor(n%36e4/6e3),Math.floor(n%6e3/100),n%100*10)}return!0};clWLangage.WDDateHeure.prototype.__bSetValeurObjet=function(n){var t;if(n instanceof Date)t=n;else if(n instanceof clWLangage.WDDateHeure)t=n.m_oValeur,this.m_sValeurInvalide=n.m_sValeurInvalide;else return!1;return this.m_bDate&&this.m_bHeure?this.m_oValeur.setTime(t.getTime()):this.m_bDate?this.m_oValeur.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()):this.m_bHeure&&this.m_oValeur.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),this.bDateValide()};clWLangage.WDDuree=function(n){this.m_nValeur=0;undefined!==n&&this.SetValeur(n)};clWLangage.WDDuree.prototype.toString=function(){return clWLangage.__sDureeVersChaine(this,"+JHHMMSSLLL")};clWLangage.WDDuree.prototype.oAdditionDuree=function(n){return new clWLangage.WDDuree(this.m_nValeur+n.m_nValeur)};clWLangage.WDDuree.prototype.oAdditionEntier=function(n){return new clWLangage.WDDuree(this.m_nValeur+n)};clWLangage.WDDuree.prototype.oSoustractionDuree=function(n){return new clWLangage.WDDuree(this.m_nValeur-n.m_nValeur)};clWLangage.WDDuree.prototype.oMultiplicationNombre=function(n){return new clWLangage.WDDuree(this.m_nValeur*n)};clWLangage.WDDuree.prototype.fDivisionDuree=function(n){return this.m_nValeur/n.m_nValeur};clWLangage.WDDuree.prototype.oDivisionNombre=function(n){return new clWLangage.WDDuree(this.m_nValeur/n)};clWLangage.WDDuree.prototype.GetProp=function(n){switch(n){case 2:return this.__tabGetDecompose()[0];case 3:return this.__tabGetDecompose()[1];case 4:return this.__tabGetDecompose()[2];case 5:return this.__tabGetDecompose()[3];case 6:return this.__tabGetDecompose()[4];case 28:return this.m_nValeur/864e5;case 29:return this.m_nValeur/36e5;case 30:return this.m_nValeur/6e4;case 31:return this.m_nValeur/1e3;case 32:return this.m_nValeur;default:return null}};clWLangage.WDDuree.prototype.SetProp=function(n,t){var r,i,u,f;switch(n){case 2:r=0;break;case 3:r=1;break;case 4:r=2;break;case 5:r=3;break;case 6:r=4;break;case 28:i=864e5;break;case 29:i=36e5;break;case 30:i=6e4;break;case 31:i=1e3;break;case 32:i=1}undefined!==r?(u=this.__tabGetDecompose(),u[r]=parseInt(t,10),this.__Recompose(u,!1,!1)):undefined!==i&&(f=parseFloat(t)*i,this.m_nValeur=clWDUtil.fGetArrondiVersZero(f)(f))};clWLangage.WDDuree.prototype.SetPropCombine=clWLangage.WDDuree.prototype.SetProp;clWLangage.WDDuree.prototype.__tabGetDecompose=function(){var t=[0,0,0,0,0],n=this.m_nValeur,i=clWDUtil.fGetArrondiVersZero(n);return t[4]=n%1e3,n=i(n/1e3),t[3]=n%60,n=i(n/60),t[2]=n%60,n=i(n/60),t[1]=n%24,n=i(n/24),t[0]=n,t};clWLangage.WDDuree.prototype.__Recompose=function(n,t,i){if(i&&(n[1]<0||24<=n[1]||n[2]<0||60<=n[2]||n[3]<0||60<=n[3]||n[4]<0||1e3<=n[4]))throw new WDErreur(204);this.m_nValeur=n[0]*864e5+n[1]*36e5+n[2]*6e4+n[3]*1e3+n[4];t&&(this.m_nValeur=-this.m_nValeur)};clWLangage.WDDuree.prototype.SetValeur=function(n){var t=!0;switch(typeof n){case"string":t=this.__bSetValeurChaine(n);break;case"number":t=this.__bSetValeurNombre(n);break;case"object":t=this.__bSetValeurObjet(n)}if(!t)throw new WDErreur(204);};clWLangage.WDDuree.prototype.__bSetValeurChaine=function(n){var t,i;n+="";t=!1;switch(n.charAt(0)){case"+":n=n.substr(1);break;case"-":n=n.substr(1);t=!0}return parseInt(n,10)!=n?!1:(n=clWDUtil.sCompleteEntier(n,10),i=[parseInt(n.substr(0,n.length-9),10),parseInt(n.substr(n.length-9,2),10),parseInt(n.substr(n.length-7,2),10),parseInt(n.substr(n.length-5,2),10),parseInt(n.substr(n.length-3),10)],this.__Recompose(i,t,!0),!0)};clWLangage.WDDuree.prototype.__bSetValeurNombre=function(n){return this.SetProp(32,n),!0};clWLangage.WDDuree.prototype.__bSetValeurObjet=function(n){if(n instanceof clWLangage.WDDuree)this.m_nValeur=n.m_nValeur;else return!1;return!0}