/*! VersionVI: 30F200057k x */
function WDBarreBoutonOnOffRiche(n,t,i,r,u){arguments.length&&(WDBarreBoutonOnOff.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null]]),this.m_sStyle=r,this.m_tabStyleValeur=u)}function WDBarreBoutonPopupRiche(n,t,i,r,u){var e,h;if(arguments.length&&(WDBarreBoutonPopup.prototype.constructor.apply(this,[n,t,"ExecuteCommande",[i,!1,null],r]),e=HTML_TOOLBAR[u],e))for(var o=r.getElementsByTagName("span"),f=0,s=o.length,f=0;f<s;f++)h=o[f],clWDUtil.SupprimeFils(o[f]),e[f]!==undefined&&o[f].appendChild(document.createTextNode(e[f]))}function WDSaisieRicheCbm(n,t,i,r,u,f){var o,e,c,s,h;for(this.m_oObjetParent=n,this.m_oCombo=t,this.m_sCommande=i,this.m_sStyle=r,this.m_oCombo.options.length=0,o=HTML_TOOLBAR[f],c=u.length,e=0;e<c;e++)s=u[e],s&&(h=s.sN,o&&o[e]&&(h=o[e]+" ("+h+")"),this.m_oCombo.options[this.m_oCombo.options.length]=new Option(h,s.sV));n.bGestionTableZR()||this.vPostPlaceBarre()}function WDSaisieRiche(){if(arguments.length){WDBarre.prototype.constructor.apply(this,arguments);this.m_bBaliseP=!0;var n=this;this.m_fKeyDown=function(t){return n.bOnKeyDown(t)};this.m_fRafBarreTrueMasqueAutre=function(t){return n.__RafBarreMasqueAutre(t||event)};this.m_fRafBarreSans=function(t){return n.RafBarre(t||event)}}}WDBarreBoutonOnOffRiche.prototype=new WDBarreBoutonOnOff;WDBarreBoutonOnOffRiche.prototype.constructor=WDBarreBoutonOnOffRiche;WDBarreBoutonOnOffRiche.prototype.ExecuteCommande=function(n){var t=this.m_oObjetParent.oGetParamEtat(n,!1);if(t[0]&&this.m_sStyle!="textAlign"){this.m_oRange&&(delete this.m_oRange,delete this.m_bForceActif);switch(this._veGetEtatSpecifique(n,this.ms_eEtatNormal,t)){case this.ms_eEtatNormal:this.m_bForceActif=!0;break;case this.ms_eEtatActif:this.m_bForceActif=!1}this.m_oRange=t[0]}WDBarreBoutonOnOff.prototype.ExecuteCommande.apply(this,arguments)};WDBarreBoutonOnOffRiche.prototype.bActif=function(n,t){if(this.m_oRange){try{if(this.m_oObjetParent.bCompareRange(this.m_oRange,t[0]))return this.m_bForceActif}catch(i){}delete this.m_oRange;delete this.m_bForceActif}if(t[2]&&this.m_sStyle.length)switch(this.m_oParamCommande[0]){case"italic":if(this.__bStyleMatchRecursif(t[1],"em")!=!1)return!0;break;case"underline":if(this.__bStyleMatchRecursif(t[1],"u")!=!1)return!0;break;case"strikeThrough":if(this.__bStyleMatchRecursif(t[1],"strike")!=!1)return!0;break;case"bold":if(t[2][this.m_sStyle]=="normal")return!1;default:if(this.__bStyleMatch(t[2][this.m_sStyle]))return!0}return!1};WDBarreBoutonOnOffRiche.prototype.__bStyleMatchRecursif=function(n,t){while(n&&n!=this.m_oObjetParent.m_oData){if(this.__bStyleMatch(clWDUtil.oGetCurrentStyle(n)[this.m_sStyle])||n.tagName&&clWDUtil.bBaliseEstTag(n,t))return!0;n=n.parentNode}return!1};WDBarreBoutonOnOffRiche.prototype.__bStyleMatch=function(n){for(var r=this.m_tabStyleValeur.length,t,i=0;i<r;i++)if(t=this.m_tabStyleValeur[i],t)if(t.bTst){if(n==t.sVal)return!0}else if(n!=t.sVal)return!0;return!1};WDBarreBoutonPopupRiche.prototype=new WDBarreBoutonPopup;WDBarreBoutonPopupRiche.prototype.constructor=WDBarreBoutonPopupRiche;WDBarreBoutonPopupRiche.prototype.OnClickP=function(n){var t=clWDUtil.oGetTarget(n);clWDUtil.bBaliseEstTag(t,"div")&&(this.m_oParamCommande[2]=this.__sConversionCouleur(clWDUtil.oGetCurrentStyle(t).backgroundColor),WDBarreBouton.prototype.ExecuteCommande.apply(this,[n]));WDBarreBoutonPopup.prototype.OnClickP.apply(this,arguments)};WDBarreBoutonPopupRiche.prototype.__sConversionCouleur=function(n){return clWDUtil.sRVB2HTML(clWDUtil.tabHTML2RVB(n))};WDSaisieRicheCbm.prototype.vPrePlaceBarre=function(){this.m_oCombo.onchange=null};WDSaisieRicheCbm.prototype.vPostPlaceBarre=function(){var n=this;this.m_oCombo.onchange=function(t){n.OnChange(t||event)}};WDSaisieRicheCbm.prototype.OnChange=function(n){var t=this.m_oObjetParent.oGetRange();t&&(this.m_oRange=t);this.m_oObjetParent.ExecuteCommande(n,[this.m_sCommande,!1,this.m_oCombo.options[this.m_oCombo.selectedIndex].value])};WDSaisieRicheCbm.prototype.RafEtatSimple=function(n){this.RafEtat(n,this.m_oObjetParent.oGetParamEtat(n,!1))};WDSaisieRicheCbm.prototype.RafEtat=function(n,t){if(this.m_oRange){try{if(this.m_oObjetParent.bCompareRange(this.m_oRange,t[0]))return}catch(r){}delete this.m_oRange}if(t[2]){var i=t[2][this.m_sStyle];switch(this.m_sCommande){case"FontSize":this.__RafEtat_Taille(n,i);break;case"FontName":this.__RafEtat_Police(n,i);break;case"FormatBlock":this.__RafEtat_Format(n,t[1])}}};WDSaisieRicheCbm.prototype.__RafEtat_Taille=function(n,t){var i,r,u;t.replace(/'/g,"");t.charAt(t.length-2)=="p"&&(i=parseFloat(t),t.charAt(t.length-1)=="t"&&(i*=96/72),t=i<11.5?"1":i<14.5?"2":i<17?"3":i<21?"4":i<28?"5":i<40?"6":"7");u=this.__tabRechercheValeurCombo(t,function(n,t){return n.toUpperCase()==t.value.toUpperCase()});u.length>0?r=u[0]:(r=this.m_oCombo.options.length,this.m_oCombo.options[r]=new Option(t,t));this.__Selection(r)};WDSaisieRicheCbm.prototype.__tabSplitPolices=function(n){for(var i=n.split(","),u=i.length,r,t=0;t<u;t++){for(r=i[t].length;r>0&&(i[t].charAt(0)=="'"||i[t].charAt(0)==" ");)i[t]=i[t].substring(1),r--;while(r>0&&(i[t].charAt(r-1)=="'"||i[t].charAt(r-1)==" "))i[t]=i[t].substring(0,r-1),r--}return i};WDSaisieRicheCbm.prototype.__RafEtat_Police=function(n,t){var u=this.__tabSplitPolices(t),f=u.join(","),s=function(n,t){return n.toUpperCase()==WDSaisieRicheCbm.prototype.__tabSplitPolices(t.value)[0].toUpperCase()},i,e=this.__tabRechercheValeurCombo(u[0],s),r,o;if(e.length>0){for(o=e.length,r=0;r<o;r++)if(this.__tabSplitPolices(this.m_oCombo.options[e[r]].value).join(",").toUpperCase()==f.toUpperCase()){i=e[r];break}i===undefined&&(i=this.m_oCombo.options.length,this.m_oCombo.options[i]=new Option(u[0]+"("+f+")",f))}else i=this.m_oCombo.options.length,this.m_oCombo.options[i]=new Option(u[0],f);this.__Selection(i)};WDSaisieRicheCbm.prototype.__RafEtat_Format=function(n,t){var i,u,f,r;if(!bIE||!n||!clWDUtil.bBaliseEstTag(n.srcElement,"select")){for(i=0,u=this.m_oObjetParent.m_oData;t&&t!=u;){if(f="<"+clWDUtil.sGetTagName(t)+">",r=this.__tabRechercheValeurCombo(f,function(n,t){return n==t.value}),0<r.length){i=r[0];break}t=t.parentNode}this.__Selection(i)}};WDSaisieRicheCbm.prototype.__tabRechercheValeurCombo=function(n,t){for(var r=[],u=this.m_oCombo.options.length,i=0;i<u;i++)t(n,this.m_oCombo.options[i])&&r.push(i);return r};WDSaisieRicheCbm.prototype.__Selection=function(n){this.m_oCombo.selectedIndex!=n&&(this.m_oCombo.selectedIndex=n)};WDSaisieRiche.prototype=new WDBarre;WDSaisieRiche.prototype.constructor=WDSaisieRiche;WDSaisieRiche.prototype.ms_sSuffixeEditeur="_EDT";WDSaisieRiche.prototype.ms_tabPropBordureSav=["borderTopWidth","borderTopStyle","borderTopColor","borderLeftWidth","borderLeftStyle","borderLeftColor","borderRightWidth","borderRightStyle","borderRightColor","borderBottomWidth","borderBottomStyle","borderBottomColor"];WDSaisieRiche.prototype.ms_tabPropPaddingSav=["paddingLeft","paddingTop","paddingRight","paddingBottom"];WDSaisieRiche.prototype.m_tabDescBarre=[{nType:0,sSuf:"GRA",sCom:"bold",sSty:"fontWeight",tabP:[{sVal:"400",bTst:!1}]},{nType:0,sSuf:"ITA",sCom:"italic",sSty:"fontStyle",tabP:[{sVal:"italic",bTst:!0},{sVal:"oblique",bTst:!0}]},{nType:0,sSuf:"SOU",sCom:"underline",sSty:"textDecoration",tabP:[{sVal:"underline",bTst:!0}]},{nType:0,sSuf:"BAR",sCom:"strikeThrough",sSty:"textDecoration",tabP:[{sVal:"line-through",bTst:!0}]},{nType:0,sSuf:"AGA",sCom:"JustifyLeft",sSty:"textAlign",tabP:[{sVal:"left",bTst:!0}]},{nType:0,sSuf:"ACE",sCom:"JustifyCenter",sSty:"textAlign",tabP:[{sVal:"center",bTst:!0}]},{nType:0,sSuf:"ADR",sCom:"JustifyRight",sSty:"textAlign",tabP:[{sVal:"right",bTst:!0}]},{nType:0,sSuf:"AJU",sCom:"JustifyFull",sSty:"textAlign",tabP:[{sVal:"justify",bTst:!0}]},{nType:0,sSuf:"LNU",sCom:"InsertOrderedList",sSty:"",tabP:[]},{nType:0,sSuf:"LPU",sCom:"InsertUnorderedList",sSty:"",tabP:[]},{nType:0,sSuf:"RMO",sCom:"Outdent",sSty:"",tabP:[]},{nType:0,sSuf:"RPL",sCom:"Indent",sSty:"",tabP:[]},{nType:0,sSuf:"EXP",sCom:"superscript",sSty:"",tabP:[]},{nType:0,sSuf:"IND",sCom:"subscript",sSty:"",tabP:[]},{nType:1,sSuf:"COF",sCom:"BackColor"},{nType:1,sSuf:"COL",sCom:"ForeColor"},{nType:2,sSuf:"LNK",sCom:"OnLink"},{nType:2,sSuf:"IMG",sCom:"OnImage"},{nType:3,sSuf:"FNA",sCom:"FontName",sSty:"fontFamily",tabP:[{sN:"Arial",sV:"Arial,Helvetica,sans-serif"},{sN:"Courier",sV:"Courier New,Courier,mono"},{sN:"Geneva",sV:"Geneva,Verdana,Arial,Helvetica"},{sN:"Georgia",sV:"Georgia,Times New Roman,Times"},{sN:"Helvetica",sV:"Helvetica"},{sN:"Tahoma",sV:"Tahoma,Arial,Helvetica,sans-serif"},{sN:"Times New Roman",sV:"Times New Roman,Times,serif"},{sN:"Verdana",sV:"Verdana,Geneva,Arial,Helvetica"}]},{nType:3,sSuf:"FSI",sCom:"FontSize",sSty:"fontSize",tabP:[{sN:"1",sV:"1"},{sN:"2",sV:"2"},{sN:"3",sV:"3"},{sN:"4",sV:"4"},{sN:"5",sV:"5"},{sN:"6",sV:"6"},{sN:"7",sV:"7"}]},{nType:3,sSuf:"FHE",sCom:"FormatBlock",sSty:"",tabP:[{sN:"div",sV:"<div>"},{sN:"h1",sV:"<h1>"},{sN:"h2",sV:"<h2>"},{sN:"h3",sV:"<h3>"},{sN:"h4",sV:"<h4>"},{sN:"h5",sV:"<h5>"},{sN:"h6",sV:"<h6>"},{sN:"pre",sV:"<pre>"}]}];WDSaisieRiche.prototype.Init=function(n,t){this.m_bBaliseP=!t;this.__InitInterne(!0,n)};WDSaisieRiche.prototype.__InitInterne=function(n,t){n||this.__Uninit();this.__Init1(n);n&&WDBarre.prototype.Init.apply(this,[t]);this.__Init2(n)};WDSaisieRiche.prototype.__Init1=function(n){if(!this.oGetTableZRParent()){if(this.m_oValeur=this.oGetElementByIdZR(document,""),this._vLiaisonHTML(),n&&this.m_oHote){var t=this.m_oHote.attributes.getNamedItem("TABINDEX");t&&(this.m_sTabIndex=t.nodeValue,this.m_oHote.removeAttribute("TABINDEX",0))}this.__InitCommun()}};WDSaisieRiche.prototype.__Uninit1=function(){this.oGetTableZRParent()||(this.__UninitCommun(),this.m_oHote&&(this.__AppliqueHoteStyleBordure(this.m_oHote),delete this.m_oHoteStyleBordure,clWDUtil.SupprimeFils(this.m_oHote)),this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur)};WDSaisieRiche.prototype.__Init2=function(n){this.bGestionTableZR()&&this.DeplaceBarre(this.oGetElementByIdZRIndice(document,this.nGetTableZRValeur(),this.ms_sSuffixeCommande));this.__InitHookDocumentBarre();this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value);this.RafBarre(null);this.__InitSpecifique(n)};WDSaisieRiche.prototype.__Uninit2=function(){this.__UninitSpecifique();this.__UnhookDocumentBarre()};WDSaisieRiche.prototype.__Uninit=function(){this.oGetTableZRParent()||(this.__Uninit2(),this.__Uninit1())};WDSaisieRiche.prototype.SetEtat=function(){WDBarre.prototype.SetEtat.apply(this,arguments);this.__ActiveModeEditable()};WDSaisieRiche.prototype.__ActiveModeEditable=function(){var n,t,i;switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:n=!0;t="on";i="";break;case WDChamp.prototype.ms_eEtatLectureSeule:n=!1;t="off";i="";break;case WDChamp.prototype.ms_eEtatGrise:n=!1;t="off";i="InactiveBorder"}this.m_oData&&this.m_oDocument&&(bIEAvec11?(this.m_oDocument.contentEditable=n,this.m_oData.contentEditable=n):clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"&&(this.m_oDocument.designMode=t),this.__SetReglesParagraphes(),this.m_oData.style.backgroundColor=i)};WDSaisieRiche.prototype.__SetReglesParagraphes=function(){this.m_bBaliseP?bFF||this.m_oDocument.execCommand("defaultParagraphSeparator",!1,"p"):bFF||bCrm||(bIE11Plus?this.m_oDocument.execCommand("defaultParagraphSeparator",!1,"div"):bIE)};WDSaisieRiche.prototype.__ReactiveModeEditable=function(){if(!bIEAvec11&&clWDUtil.oGetCurrentStyle(this.m_oHote).display!="none"){this.m_oDocument.designMode="off";switch(this.eGetEtat()){default:case WDChamp.prototype.ms_eEtatActif:this.m_oDocument.designMode="on";this.__SetReglesParagraphes();break;case WDChamp.prototype.ms_eEtatLectureSeule:case WDChamp.prototype.ms_eEtatGrise:}}};WDSaisieRiche.prototype.__InitCommun=function(){this.bGestionTableZR()?this.__InitCommunZR():this.__InitCommunIFrame()};WDSaisieRiche.prototype.__InitCommunIFrame=function(){var t=document.createElement("iframe"),n,r,u,i;t.id=this.sGetNomElement(this.ms_sSuffixeEditeur);t.src='javascript:""';this.__OnResize(null,t,t.style);t.frameBorder="0";t.border="0";this.m_sTabIndex&&(t.tabIndex=this.m_sTabIndex);clWDUtil.SupprimeFils(this.m_oHote);this.m_oIFrame=this.m_oHote.appendChild(t);this.m_oDocument=this.m_oIFrame.contentWindow.document;n=[];clWDUtil.bHTML5?n.push("<!DOCTYPE html>"):n.push('<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">');n.push(clWDUtil.bRTL?'<html dir="rtl">':"<html>");n.push('<HEAD xmlns="http://www.w3.org/1999/xhtml">');n.push('<style type="text/css">body{margin:0;padding:2px;overflow:auto;}');r=clWDUtil.sGetCSSTexte("#"+this.m_oHote.id+" p");""!=r&&(n.push("p{"),n.push(r),n.push("}"));n.push("<\/style>");n.push('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><base href="/');n.push(_WD_);n.push('" /><\/head><body><\/body><\/html>');this.m_oDocument.open();this.m_oDocument.write(n.join(""));this.m_oDocument.close();this.m_oData=this.m_oDocument.body;u=clWDUtil.oGetCurrentStyle(this.m_oHote);i={};this.__SaveProprietes(u,this.ms_tabPropBordureSav,i,!1);this.__SaveProprietes(u,this.ms_tabPropPaddingSav,i,!0);this.m_oHoteStyleBordure=i;this.__AppliqueHoteStyleBordure(this.m_oData);this.m_oHote.style.border="0px solid transparent";this.m_oHote.style.padding="0px 0px 0px 0px";this.__CopieStyleBase()};WDSaisieRiche.prototype.__SaveProprietes=function(n,t,i,r){for(var o=t.length,f,e,u=0;u<o;u++)(f=t[u],e=n[f],r&&"0"==e.charAt(0))||(i[f]=e)};WDSaisieRiche.prototype.__AppliqueHoteStyleBordure=function(n){var t=this.m_oHoteStyleBordure;for(var i in t)t.hasOwnProperty(i)&&(n.style[i]=t[i])};WDSaisieRiche.prototype.__InitCommunZR=function(){this.PourToutesLignesTableZR(this.__InitCommunZR_CB,this.nGetTableZRValeur())};WDSaisieRiche.prototype.__InitCommunZR_CB=function(n,t){n!=t?this.__InitCommunZR_HTML(n):this.__InitCommunZR_IFrame(n)};WDSaisieRiche.prototype.__InitCommunZR_IFrame=function(){this.m_oHote&&this.__InitCommunIFrame()};WDSaisieRiche.prototype.__InitCommunZR_HTML=function(n){var i=this.oGetElementByIdZRIndice(document,n,""),t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),r,u;i&&t&&(r=i.attributes.getNamedItem("DISABLED"),t.style.backgroundColor=r&&r.specified?"InactiveBorder":"",t.style.overflow="auto",t.innerHTML=i.value,u=this,t.onclick=function(t){u.OnClickLigne(t||event,n)})};WDSaisieRiche.prototype.__UninitCommun=function(){this.bGestionTableZR()&&this.__UninitCommunZR();this.m_oData=null;delete this.m_oData;this.m_oDocument=null;delete this.m_oDocument;this.m_oIFrame=null;delete this.m_oIFrame};WDSaisieRiche.prototype.__UninitCommunZR=function(){this.PourToutesLignesTableZR(this.__UninitCommunZR_HTML)};WDSaisieRiche.prototype.__UninitCommunZR_HTML=function(n){var t=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);t&&(clWDUtil.SupprimeFils(t),t.onclick=null)};WDSaisieRiche.prototype.__InitSpecifique=function(){var t,n,i;this.m_oValeur&&(t=!1,n=this.m_oValeur.attributes.getNamedItem("READONLY"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatLectureSeule]),t=!0),i=!1,n=this.m_oValeur.attributes.getNamedItem("DISABLED"),n&&n.specified&&(WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatGrise]),i=!0),t||i||this.ms_eEtatActif==this.eGetEtat()||WDBarre.prototype.SetEtat.apply(this,[this.ms_eEtatActif]));this.__ActiveModeEditable();this.__SetMinHeight();this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!0,this.m_oDocument,"keydown",this.m_fKeyDown)};WDSaisieRiche.prototype.__UninitSpecifique=function(){this.m_oDocument&&clWDUtil.AttacheDetacheEvent(!1,this.m_oDocument,"keydown",this.m_fKeyDown)};WDSaisieRiche.prototype.__CopieStyleBase=function(){var r=clWDUtil.oGetCurrentStyle(this.m_oData),i,u,t,n;if(!bFF||null!==r){i=clWDUtil.oGetCurrentStyle(this.m_oHote);u=this.m_oData.style;for(n in i)if(t=i[n],"string"==typeof t){if("border"==n.substr(0,6)||"padding"==n.substr(0,7)||"outline"==n||"margin"==n.substr(0,6)||"overflow"==n.substr(0,8)||"width"==n||"height"==n||"cssText"==n||"background"==n||"font"==n||"webkitBorder"==n.substr(0,12)||"webkitPadding"==n.substr(0,13)||"webkitLogical"==n.substr(0,13))continue;r[n]!=t&&(u[n]=t)}}};WDSaisieRiche.prototype.__RafBarreMasqueAutre=function(n){return AppelMethode("RafBarre",[n],this),this.RafBarre(n,!0)};WDSaisieRiche.prototype._InitBarreAutomatique=function(){clWDUtil.AttacheDetacheEvent(!0,document,"click",this.m_fRafBarreSans);clWDUtil.AttacheDetacheEvent(!0,document,"keyup",this.m_fRafBarreSans)};WDSaisieRiche.prototype.__InitHookDocumentBarre=function(){var n=bIEAvec11?this.m_oData:this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!0,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!0,n,"keyup",this.m_fRafBarreTrueMasqueAutre))};WDSaisieRiche.prototype.__UnhookDocumentBarre=function(){var n=bIEAvec11?this.m_oData:this.m_oDocument;n&&(clWDUtil.AttacheDetacheEvent(!1,n,"click",this.m_fRafBarreTrueMasqueAutre),clWDUtil.AttacheDetacheEvent(!1,n,"keyup",this.m_fRafBarreTrueMasqueAutre))};WDSaisieRiche.prototype._voNewBoutonOnOff=function(n,t){return new WDBarreBoutonOnOffRiche(this,n,t.sCom,t.sSty,t.tabP)};WDSaisieRiche.prototype._voNewBoutonPopup=function(n,t){var i=t.sSuf+"P";return new WDBarreBoutonPopupRiche(this,n,t.sCom,this.oGetElementByIdBarre(document,i),i)};WDSaisieRiche.prototype._voNewBoutonAction=function(n,t){return new WDBarreBouton(this,n,t.sCom)};WDSaisieRiche.prototype._voNewBoutonCombo=function(n,t){return new WDSaisieRicheCbm(this,n,t.sCom,t.sSty,t.tabP,t.sSuf)};WDSaisieRiche.prototype.OnClickLigne=function(n,t){this.bSauveContenu(n);this._OnClickLigneRetarde(n,t)};WDSaisieRiche.prototype._OnClickLigneRetarde=function(n,t){var i=this.oGetTableZRParent();if(i&&i.m_oCache&&i.m_oCache.m_tabRequetes.length>0){this.nSetTimeout(this._OnClickLigneRetarde,clWDUtil.ms_oTimeoutImmediat,null,t);return}this.SetTableZRValeur(n,t);this.__InitInterne(!1)};WDSaisieRiche.prototype._vOnResize=function(n){WDBarre.prototype._vOnResize.apply(this,arguments);this.m_oIFrameOnResizeInterne===undefined&&this.__OnResize(n,this.m_oIFrame,clWDUtil.oGetCurrentStyle(this.m_oIFrame));this.__SetMinHeight()};WDSaisieRiche.prototype.__SetMinHeight=function(){if((clWDUtil.bHTML5||bFF)&&this.m_oData){bFF&&"100%"==this.m_oHote.parentNode.parentNode.parentNode.parentNode.style.height&&(this.m_oIFrame.style.minHeight="0",this.m_oIFrame.style.minHeight=this.m_oHote.parentNode.offsetHeight-3+"px");this.m_oData.style.minHeight="0";var n=clWDUtil.oGetCurrentStyle(this.m_oData),t=n?this.s_nGetOffsetBorderPourHeight(n):0;this.m_oData.style.minHeight=this.m_oIFrame.offsetHeight-4-t+"px"}};WDSaisieRiche.prototype.__OnResize=function(n,t,i){var r=this.s_nGetOffsetBorderPourWidth(i),u=this.s_nGetOffsetBorderPourHeight(i);if(bIEQuirks){if(this.m_oIFrame==t&&clWDUtil.oSupprimeElement(t),n){var f=clWDUtil.oGetCurrentStyle(this.m_oHote),e=f.width,o=f.height;this.m_oHote.style.width="1px";this.m_oHote.style.height="1px";this.m_oIFrameOnResizeInterne=t;this.nSetTimeoutUnique("__OnResizeInterneS1",clWDUtil.ms_oTimeoutNonImmediat200,r,u,e,o);return}}else{t.style.width="100%";t.style.height="100%";return}this.__OnResizeInterne(t,r,u)};WDSaisieRiche.prototype.__OnResizeInterneS1=function(n,t,i,r){this.m_oHote.style.width=i;this.m_oHote.style.height=r;var u=this.m_oIFrameOnResizeInterne;this.m_oIFrameOnResizeInterne=null;delete this.m_oIFrameOnResizeInterne;this.__OnResizeInterne(u,n,t)};WDSaisieRiche.prototype.__OnResizeInterne=function(n,t,i){var r=this.m_oHote.offsetWidth-t,u=this.m_oHote.offsetHeight-i;bIEQuirks&&this.m_oIFrame==n&&this.m_oHote.appendChild(n);n.style.width=(r>=0?r:0)+"px";n.style.height=(u>=0?u:0)+"px";this._DeplaceBarre()};WDSaisieRiche.prototype.OnDisplay=function(n,t){if(WDBarre.prototype.OnDisplay.apply(this,arguments),t&&this.m_oHote&&clWDUtil.bEstFils(this.m_oHote,n,document)){for(var r=!0,u=!1,f=n.getElementsByTagName("iframe"),e=f.length,i=0;i<e;i++)if(this.m_oDocument==f[i].contentWindow.document){u=!0;break}u||(this.__InitInterne(!1),r=!1);bFF&&this.__CopieStyleBase();this.m_oDocument&&this.m_oDocument.body&&(this.m_oDocument.body.style.visibility="");this.__ReactiveModeEditable();r&&this._vOnResize(null)}};WDSaisieRiche.prototype._vOnTableZRAfficheAJAXInterne=function(){WDBarre.prototype._vOnTableZRAfficheAJAXInterne.apply(this,arguments);this.__InitInterne()};WDSaisieRiche.prototype._vOnLigneTableZRAffiche=function(n,t){WDBarre.prototype._vOnLigneTableZRAffiche.apply(this,arguments);t?(this.m_oValeur=this.oGetElementByIdZRIndice(document,n,""),this.m_oHote=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote),this.__InitCommunZR_IFrame(n-1),this.DeplaceBarre(this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeCommande)),this.__InitHookDocumentBarre(),this.m_oData&&this.m_oValeur&&this.__EcraseContenu(this.m_oValeur.value),this.RafBarre(null),this.__InitSpecifique(!1)):this.__InitCommunZR_HTML(n)};WDSaisieRiche.prototype._vOnLigneTableZRMasque=function(n,t,i){t&&(this.bSauveContenu(i),this.__UninitSpecifique(),this.__UnhookDocumentBarre());var r=this.oGetElementByIdZRIndice(document,n,this.ms_sSuffixeHote);r&&(t&&(this.__AppliqueHoteStyleBordure(r),delete this.m_oHoteStyleBordure),clWDUtil.SupprimeFils(r),r.onclick=null);t&&(this.m_oData=null,delete this.m_oData,this.m_oDocument=null,delete this.m_oDocument,this.m_oIFrame=null,delete this.m_oIFrame,this.m_oHote=null,delete this.m_oHote,this.m_oValeur=null,delete this.m_oValeur);WDBarre.prototype._vOnLigneTableZRMasque.apply(this,arguments)};WDSaisieRiche.prototype.RafBarre=function(n,t){var i,r,u;if(t===undefined){if(i=null,!bIE&&n&&(i=clWDUtil.oGetOriginalTarget(n)),!i){i=document.activeElement;try{i.parentNode}catch(f){i=null}}(clWDUtil.bEstFils(i,this.m_oBarre,document)||clWDUtil.bEstFils(i,this.m_oHote,document))&&(t=!0);r=this.oGetTableZRParent();r&&r.m_tabSelection&&r.m_oCache&&(u=r.m_oCache.oGetLigne(r.m_tabSelection[0]),u&&i==u.m_oLigneHTML.oGetLigneLogiqueHTML(u.vnGetColonneHTML())&&(t=!0))}t?this.OnFocus(n):this.OnBlur(n);t&&this.AppelMethodeAutresPtr(WDChamp.prototype.MasqueBarre,[n]);this.m_eModeBarre!=this.ms_eModeBarreAutomatique&&(t=undefined);WDBarre.prototype.RafBarre.apply(this,[n,t])};WDSaisieRiche.prototype._vMasqueBarre=function(n){this.OnBlur(n);WDBarre.prototype._vMasqueBarre.apply(this,arguments)};WDSaisieRiche.prototype.OnFocus=function(n){this.m_bFocus||(this.m_bFocus=!0,this.RecuperePCode(this.ms_nEventNavFocus)(n))};WDSaisieRiche.prototype.OnBlur=function(n){this.m_bFocus&&(this.__SauveContenuAvecOnChange(n),this.RecuperePCode(this.ms_nEventNavBlur)(n),delete this.m_bFocus)};WDSaisieRiche.prototype.__SauveContenuAvecOnChange=function(n){if(this.bSauveContenu(n)){var t=this.RecuperePCode(this.ms_nEventNavChange);t!=clWDUtil.m_pfVide&&t(n)}};WDSaisieRiche.prototype.bOnKeyDown=function(n){var t,i,r;if(n.keyCode==13)if(!bIE||bIE11Plus||this.m_bBaliseP)bFF&&this.m_bBaliseP?this.m_oDocument.execCommand("formatBlock",!1,"p"):bCrm&&this.m_bBaliseP&&(r=this.m_oDocument.body.childNodes,1==r.length&&r[0].nodeName=="#text"&&this.m_oDocument.execCommand("formatBlock",!1,"p"));else if(t=this.oGetRange(),t&&t.duplicate)return t.parentElement&&(i=t.parentElement(),i&&(clWDUtil.bBaliseEstTag(i,"ul")||clWDUtil.bBaliseEstTag(i,"li")))?!0:(t.pasteHTML("<br>"),t.moveStart("character",1),t.moveEnd("character",2),t.select(),t.collapse(!1),t.scrollIntoView(),clWDUtil.bStopPropagation(n));return!0};WDSaisieRiche.prototype.oGetParamEtat=function(n,t){if(this.bGestionTableZR()&&!this.m_oDocument)return[null,null,null];var i=[this.oGetRange(),null,null],r=null;return bIE&&!i[0].duplicate&&(r=i[0].item(0),i[0]=null),t==!1&&(i[1]=r?r:this.oGetSelection(i[0]),i[2]=i[1]?clWDUtil.oGetCurrentStyle(i[1]):null),i};WDSaisieRiche.prototype.oGetRange=function(){if(bIE)return this.m_oDocument.selection.createRange();if(this.m_oDocument.defaultView){var n=this.m_oDocument.defaultView.getSelection();if(n&&n.rangeCount)return n.getRangeAt(0)}return null};WDSaisieRiche.prototype.oGetRangeCpy=function(){var n=this.oGetRange();return bIE?n.duplicate():(n&&n.cloneRange(),null)};WDSaisieRiche.prototype.bCompareRange=function(n,t){return bIE?n.isEqual(t):n.compareBoundaryPoints(0,t)==0&&n.compareBoundaryPoints(2,t)==0};WDSaisieRiche.prototype.oGetSelection=function(n){if(bIE){n=n.duplicate();n.collapse(!0);var t=n.parentElement();return t.document==this.m_oDocument?t:this.m_oData}return n?n.startContainer:null};WDSaisieRiche.prototype.OptimiseContenu=function(){};WDSaisieRiche.prototype.__EcraseContenu=function(n){this.m_oData.innerHTML=n};WDSaisieRiche.prototype.bSauveContenu=function(n){var r=!1,i,t;return this.m_oValeur&&(this.OptimiseContenu(),i=this.m_oValeur.value,t=this.m_oData.innerHTML,this.m_oValeur.value=t,r=i!=t,i.toUpperCase()!=t.toUpperCase()&&this._OnChampModifie(n,t)),r};WDSaisieRiche.prototype.SetValeur=function(n,t){return WDBarre.prototype.SetValeur.apply(this,arguments),this.__EcraseContenu(t),this.bSauveContenu(),this.__ReactiveModeEditable(),this.m_oValeur.value};WDSaisieRiche.prototype.GetValeur=function(){return this.bSauveContenu(),this.m_oValeur.value};WDSaisieRiche.prototype.SetProp=function(n,t,i){i=WDChamp.prototype.SetProp.apply(this,arguments);switch(n){case this.XML_CHAMP_PROP_NUM_COULEUR:return this.m_oDocument.body.style.color=i,i;case this.XML_CHAMP_PROP_NUM_COULEURFOND:return this.m_oDocument.body.style.backgroundColor=i,i;case this.XML_CHAMP_PROP_NUM_ETAT:return this.__InitSpecifique(!1),i;default:return i}};WDSaisieRiche.prototype.OnSubmit=function(n){this.__SauveContenuAvecOnChange(n)};WDSaisieRiche.prototype.SetFocus=function(){bIEAvec11||this.m_oIFrame.contentWindow.focus();this.m_oData.focus();this.RafBarre(null)};WDSaisieRiche.prototype.ExecuteCommande=function(n,t){this.SetFocus();this.m_oDocument.execCommand(t[0],t[1],t[2]);this.SetFocus();this.RafBarre(n,!0)};WDSaisieRiche.prototype.OnLink=function(n){this.__OnPrompt(n,"CreateLink","Link ?","http://",!1)};WDSaisieRiche.prototype.OnImage=function(n){var t=this.oGetRange(),i="http://";bIE&&!t.duplicate&&t.item(0)&&t.item(0).src&&(i=t.item(0).src);this.__OnPrompt(n,"InsertImage","Image ?",i,!0)};WDSaisieRiche.prototype.__OnPrompt=function(n,t,i,r,u){if(bIE&&!u)this.ExecuteCommande(n,[t,!0,""]);else{var f=prompt(i,r);f!=null&&f!=""&&f!=r&&this.ExecuteCommande(n,[t,!1,f])}};WDSaisieRiche.prototype.sGetAltText=function(n){return HTML_TOOLBAR.ALTTEXT[n]};WDSaisieRiche.prototype.RAZIndication=clWDUtil.m_pfVide