/*! VersionVI: 30F200066p x */
function WDSousChamp(n){arguments.length&&(this.m_sAlias=n)}function WDRupture(n,t,i,r,u,f){arguments.length&&(WDSousChamp.prototype.constructor.apply(this,[n]),this.m_nColonne=t,this.m_oPCodesHaut=new WDPCodes(i),this.m_oPCodesBas=new WDPCodes(r),this.m_bVisibleHaut=u,this.m_bVisibleBas=f)}function WDColonne(n,t,i){if(arguments.length){WDSousChamp.prototype.constructor.apply(this,[n]);this.m_eTypeWL=undefined!==t?t:16;var r="_SET_"+i+"_1",u="_GET_"+i+"_1";n==i&&(r+="_I",u+="_I");r+="_C";u+="_C";this.m_pfConversionVersAffichage=window[r];this.m_pfConversionDepuisAffichage=window[u]}}function WDAttribut(n,t,i){if(arguments.length){var r=i[1];WDColonne.prototype.constructor.apply(this,[n,t,r&&r.length?r:n]);this.m_eProprieteAssocie=WDTableZRNavigateur.prototype.s_eGetProprietePrincipale(i[0],i[2]);this.m_sAliasChampAssocie=r;this.m_eTypeChampAssocie=i[2]}}function WDTableColonne(n,t,i){arguments.length&&(WDColonne.prototype.constructor.apply(this,[n,t,n]),this.m_eTypeIDObjet=i[0],this.m_bTri=i[1],this.m_nRecherche=i[2],this.m_nFiltre=i[3],this.m_bVisible=i[4],this.m_bSaisissable=i[5],this.m_eDeplaceInsere=i[6],this.m_nRangCreation=i[7],this.m_nPositionAffichage=i[8],this.m_nLargeur=i[9],this.m_tabOptions=i[10],this.m_oPCodes=new WDPCodes(i[11]),this.m_bAjustable=i[12],this.m_sCouleur=i[13],this.m_sCouleurFond=i[14])}function WDLigne(n,t){arguments.length&&(this.m_tabValeurs=new Array(n),this.m_nDeroule=this.ms_nTous,this.m_nRupturesHaut=this.ms_nRien,this.m_nRupturesBas=this.ms_nRien,this.m_bPCodeAffichage=!1,this.m_bModifieRuptures=!0,this.m_bVerifieFiltre=!0,this.m_bLigneVirtuelle=t)}function WDTableZRNavigateur(n,t){arguments.length&&(WDChampParametresHote.prototype.constructor.apply(this,[n,undefined,undefined]),this.m_oSelection=new WDSelection(this,t),this.m_tabColonnes=[],this.m_tabRuptures=[],this.m_tabLignes=[],this.m_nNbLignesWL=0,this.m_tabTri=[],this.m_tabFiltre=[],this.m_nTAOptions=0,this.ms_tabTablesZRs.DeclareChamp(this))}function WDPopupSaisieTRF(n,t){arguments.length&&(WDPopupSaisie.prototype.constructor.apply(this,[n,!1]),this.m_tabImages=t,clWDUtil.PrechargeImage(t))}function WDCelluleSaisie(n){if(arguments.length){this.m_oChampTable=n;var t=this;this.m_pfOnSubmit=function(n){return t.__bOnSubmit(n||event)};this.m_pfOnBlur=function(n){return t.__bOnBlur(n||event)};this.m_pfOnKeyDown=function(n){return t.__bOnKeyDown(n||event)};this.m_pfOnChange=function(n){return t.__bOnChange(n||event)};this.m_nLigne=WDTableZRNavigateur.prototype.ms_nLigneInvalide;this.m_nColonne=WDTableZRNavigateur.prototype.ms_nColonneInvalide}}function WDMenuContextuelExport(n,t){arguments.length&&(this.m_sAliasChamp=t,WDMenuContextuel.prototype.constructor.apply(this,[n,this.ms_tabOptions,this.ms_eOuvreSensAutomatique]))}function WDMenuContextuelTRF(n,t,i,r,u,f){if(arguments.length){var e=[];clWDUtil.bForEach(this.ms_tabOptions,function(n){return(!n.m_nFiltre||n.m_nFiltre<=0||u&&n.m_bTexte||f&n.m_bNumDateHeure)&&e.push(n),!0});this.m_oGestionnaire=t;this.m_pfAction=i;this.m_nColonne=r;WDMenuContextuel.prototype.constructor.apply(this,[n,e,this.ms_eOuvreBasDroite])}}function WDSelection(n,t){arguments.length&&(this.m_oChampTable=n,this.m_nTypeSelection=t,this.m_nModeSelection=this.ms_nTsLigne,this.m_tabSelection=[])}function WDAffichageColonnes(n,t,i){arguments.length&&(WDDrag.prototype.constructor.apply(this,[0,50]),this.m_oChampTable=n,this.m_tabFleches=t,this.m_oStyleCacheLargeur=i,this.m_sPrefixe="table .wbcol",this.m_tabPositionAffichage=[])}function WDDnDColonne(n,t,i){if(arguments.length){var r=t.bColonneDeplace()?1:0,u=t.bColonneInsereGaucheDroite()?1:0;WDDnDNatif.prototype.constructor.apply(this,[r,u,i,this.ms_nOperationDeplacement]);this.m_oAffichageColonne=n;this.m_oColonne=t}}var clWDTableDefs={ID_POSITION_PIXEL:"POS",ID_TITRE:"TITRES",ID_TRI:"TRI",ID_RECHERCHE:"RECH",ID_FORMAT:"FORMAT",ms_nOptionTAMontreLigne:1,ms_nOptionTAPreserveScroll:2,ms_nOptionTARedessineTitre:4};WDSousChamp.prototype.s_nChercheParAlias=function(n,t){var i=clWDUtil.nDansTableauFct(n,WDSousChamp.prototype.__s_bCompareAlias,t);return clWDUtil.nElementInconnu!=i?i:undefined};WDSousChamp.prototype.__s_bCompareAlias=function(n,t){return n.m_sAlias==t};WDRupture.prototype=new WDSousChamp;WDRupture.prototype.constructor=WDRupture;WDRupture.prototype.RecuperePCode=function(n,t){return(t?this.m_oPCodesHaut:this.m_oPCodesBas).RecuperePCode(n)};WDRupture.prototype.bVisible=function(n){return n?this.m_bVisibleHaut:this.m_bVisibleBas};WDColonne.prototype=new WDSousChamp;WDColonne.prototype.constructor=WDColonne;WDColonne.prototype.oGetValeurInterne=function(n,t){return n!==undefined?this._voGetValeurInterne(n):this._voGetValeurDefaut(t)};WDColonne.prototype._voGetValeurInterne=function(n){switch(typeof n){case"boolean":return n;default:return clWDUtil.oConversionType(n,this.m_eTypeWL)}};WDColonne.prototype._voGetValeurDefaut=function(){return""};WDColonne.prototype.fGetCompare=function(n){return clWDUtil.fGetCompare(n)};WDColonne.prototype.vsLitPropriete=function(n,t,i,r,u,f,e){switch(f){default:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:return this.oGetValeurAvecLigne(t,u,e)}};WDColonne.prototype.oGetValeurAvecLigne=function(n,t,i){var r=t.tabGetValeurs()[n];return i&&this.m_pfConversionVersAffichage&&(r=this.m_pfConversionVersAffichage(r)),r};WDColonne.prototype.bEstTexte=function(){switch(this.m_eTypeWL){case 16:case 17:case 18:case 19:case 81:case 110:case 134:return!0;default:return!1}};WDColonne.prototype.bEstNumerique=function(){return 2<=this.m_eTypeWL&&this.m_eTypeWL<=15};WDColonne.prototype.bEstDateHeure=function(){switch(this.m_eTypeWL){case 24:case 25:case 26:case 27:case 128:case 129:return!0;default:return!1}};WDAttribut.prototype=new WDColonne;WDAttribut.prototype.constructor=WDAttribut;WDAttribut.prototype._voGetValeurInterne=function(n){switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return clWDUtil.bCastToBoolAvecChaine(n);case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:var t=parseInt(n+"",10);return t!=WDChamp.prototype.ms_eEtatActif&&t!=WDChamp.prototype.ms_eEtatLectureSeule&&t!=WDChamp.prototype.ms_eEtatGrise&&(t=WDChamp.prototype.ms_eEtatActif),t;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:default:return WDColonne.prototype._voGetValeurInterne.apply(this,arguments)}};WDAttribut.prototype._voGetValeurDefaut=function(){switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:return!0;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:return WDChamp.prototype.ms_eEtatActif;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:return 0;default:return WDColonne.prototype._voGetValeurDefaut.apply(this,arguments)}};WDAttribut.prototype.vsLitPropriete=function(n,t,i,r,u,f,e){switch(f){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:default:var o=this.oGetValeurAvecLigne(t,u,e);if(e)switch(this.m_eProprieteAssocie){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:if(WDChamp.prototype.ms_nIDObjetImage!=this.m_eTypeChampAssocie)break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VIGNETTE:o=clWDUtil.sGetCheminImage(o)}return o}};WDTableColonne.prototype=new WDColonne;WDTableColonne.prototype.constructor=WDTableColonne;WDTableColonne.prototype.ms_nFiltreRecherche=0;WDTableColonne.prototype.ms_nFiltreEgal=31978;WDTableColonne.prototype.ms_nFiltreCommencePar=31979;WDTableColonne.prototype.ms_nFiltreContient=31980;WDTableColonne.prototype.ms_nFiltreTerminePar=31981;WDTableColonne.prototype.ms_nFiltreDifferent=31982;WDTableColonne.prototype.ms_nFiltreNeCommencePasPar=31983;WDTableColonne.prototype.ms_nFiltreNeContientPas=31984;WDTableColonne.prototype.ms_nFiltreNeTerminePasPar=31985;WDTableColonne.prototype.ms_nFiltreSuperieur=31986;WDTableColonne.prototype.ms_nFiltreSuperieurOuEgal=31987;WDTableColonne.prototype.ms_nFiltreInferieur=31988;WDTableColonne.prototype.ms_nFiltreInferieurOuEgal=31989;WDTableColonne.prototype.ms_nDISans=0;WDTableColonne.prototype.ms_nDIGauche=1;WDTableColonne.prototype.ms_nDIDroite=2;WDTableColonne.prototype.ms_nDIGaucheDroite=3;WDTableColonne.prototype.ms_nDIDeplace=4;WDTableColonne.prototype._voGetValeurInterne=function(n){switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:switch(typeof n){case"string":case"number":return n}break;case WDChamp.prototype.ms_nIDObjetInterrupteur:return clWDUtil.bCastToBoolAvecChaine(n);case WDChamp.prototype.ms_nIDObjetImage:return n+"";case WDChamp.prototype.ms_nIDObjetSaisie:return clWDUtil.oConversionType(n,this.m_eTypeWL)}return WDColonne.prototype._voGetValeurInterne.apply(this,arguments)};WDTableColonne.prototype._voGetValeurDefaut=function(n){switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:return n?0:1;case WDChamp.prototype.ms_nIDObjetInterrupteur:return!1;case WDChamp.prototype.ms_nIDObjetImage:return"";case WDChamp.prototype.ms_nIDObjetSaisie:return clWDUtil.oConversionType("",this.m_eTypeWL)}};WDTableColonne.prototype.s_xfGetFiltre=function(n){switch(n){case this.ms_nFiltreEgal:return clWDUtil.s_bEgal;case this.ms_nFiltreCommencePar:return clWDUtil.s_bCommencePar;case this.ms_nFiltreContient:return clWDUtil.s_bContient;case this.ms_nFiltreTerminePar:return clWDUtil.s_bTerminePar;case this.ms_nFiltreDifferent:return clWDUtil.s_bDifferent;case this.ms_nFiltreNeCommencePasPar:return clWDUtil.s_bNeCommencePasPar;case this.ms_nFiltreNeContientPas:return clWDUtil.s_bNeContientPas;case this.ms_nFiltreNeTerminePasPar:return clWDUtil.s_bNeTerminePasPar;case this.ms_nFiltreSuperieur:return clWDUtil.s_bSuperieur;case this.ms_nFiltreSuperieurOuEgal:return clWDUtil.s_bSuperieurOuEgal;case this.ms_nFiltreInferieur:return clWDUtil.s_bInferieur;case this.ms_nFiltreInferieurOuEgal:return clWDUtil.s_bInferieurOuEgal;default:throw new WDErreur(303,n);}};WDTableColonne.prototype.nGetFiltre=function(){return this.m_nFiltre};WDTableColonne.prototype.SetFiltre=function(n){this.m_nFiltre=n};WDTableColonne.prototype.bGetSaisissable=function(){if(!this.m_bSaisissable)return!1;switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:if(!this.m_tabOptions||0==this.m_tabOptions.length)return!1;break;case WDChamp.prototype.ms_nIDObjetImage:return!1;case WDChamp.prototype.ms_nIDObjetSaisie:if(undefined!==this.m_nLien&&0!=this.m_nLien)return!1}return!0};WDTableColonne.prototype.bColonneInsereGauche=function(){switch(this.m_eDeplaceInsere){case this.ms_nDIGauche:case this.ms_nDIGaucheDroite:case this.ms_nDIDeplace:return!0;default:return!1}};WDTableColonne.prototype.bColonneInsereDroite=function(){switch(this.m_eDeplaceInsere){case this.ms_nDIDroite:case this.ms_nDIGaucheDroite:case this.ms_nDIDeplace:return!0;default:return!1}};WDTableColonne.prototype.bColonneInsereGaucheDroite=function(){return this.ms_nDISans!=this.m_eDeplaceInsere};WDTableColonne.prototype.bColonneDeplace=function(){return this.ms_nDIDeplace==this.m_eDeplaceInsere};WDTableColonne.prototype.vsLitPropriete=function(n,t,i,r,u,f,e){switch(f){case WDTableZRNavigateur.prototype.ms_nAttributTriable:return this.m_bTri;case WDTableZRNavigateur.prototype.ms_nAttributRecherchable:return 0<this.m_nRecherche;case WDTableZRNavigateur.prototype.ms_nAttributDerniereVisible:return n.bDerniereColonneVisible(t);case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:var o=WDColonne.prototype.vsLitPropriete.apply(this,arguments);if(e)switch(this.m_eTypeIDObjet){case WDChamp.prototype.ms_nIDObjetCombo:return this.__sLitValeurCombo(o);case WDChamp.prototype.ms_nIDObjetInterrupteur:return this.__sLitValeurInterrupteur(o,n,t,i);case WDChamp.prototype.ms_nIDObjetImage:return this.__sLitValeurImage(o);case WDChamp.prototype.ms_nIDObjetSaisie:return this.__sLitValeurSaiseOuLien(o)}return o;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR:return this.__sLitCouleurColonneCellule(n,t,u,i,r,!1,e);case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND:return this.__sLitCouleurColonneCellule(n,t,u,i,r,!0,e);default:return WDColonne.prototype.vsLitPropriete.apply(this,arguments)}};WDTableColonne.prototype.__sLitValeurCombo=function(n){switch(typeof n){case"string":return n;case"number":return this.m_tabOptions&&1<=n&&n<=this.m_tabOptions.length?this.m_tabOptions[n-1]:""}return n};WDTableColonne.prototype.__sLitValeurInterrupteur=function(n,t,i,r){var u=['<input type="checkbox"'];return n&&u.push(" checked"),this.bGetSaisissable()?(u.push(' onclick="cl'),u.push(t.m_sAliasChamp),u.push(".OnClickInterrupteur(event,this,"),u.push(r),u.push(","),u.push(i),u.push(');"')):u.push(" disabled"),u.push(">"),u.join("")};WDTableColonne.prototype.__sLitValeurImage=function(n){var t=[];return 0<n.length&&(t.push('<img src="'),t.push(clWDUtil.sGetCheminImage(n+"")),t.push('" '),bIE?t.push("onreadystatechange"):t.push("onload"),t.push('="WDTableZRNavigateur.prototype.s_bRedimImage(this);">')),t.join("")};WDTableColonne.prototype.__sLitValeurSaiseOuLien=function(n){return clWDUtil.sEncodeInnerHTML(n,!0)};WDTableColonne.prototype.__sLitCouleurColonneCellule=function(n,t,i,r,u,f,e){var s=f?this.m_sCouleurFond:this.m_sCouleur,a,h,o,c,v,l;return i?e&&n.m_oSelection&&n.m_oSelection.bGetLigneEstSelectionnee(r)&&(a=n.m_oStyleLigneSelectionne,h=f?a.m_sCouleurFond:a.m_sCouleur,h&&h.length)?h:(o=f?i.m_tabCouleurFond:i.m_tabCouleur,o&&o[t]&&o[t].length)?o[t]:(c=f?i.m_sCouleurFond:i.m_sCouleur,c&&c.length)?c:s&&s.length?s:(v=u%2==0?n.m_oStyleLigneImpair:n.m_oStyleLignePair,l=f?v.m_sCouleurFond:v.m_sCouleur,l&&l.length)?l:"":s||""};WDLigne.prototype.ms_nRien=0;WDLigne.prototype.ms_nTous=4294967295|0;WDLigne.prototype.oGetPropriete=function(n,t){var i={};return!i.m_sCouleur&&this.m_sCouleur&&this.m_sCouleur.length&&(i.m_sCouleur=this.m_sCouleur),!i.m_sCouleurFond&&this.m_sCouleurFond&&this.m_sCouleurFond.length&&(i.m_sCouleurFond=this.m_sCouleurFond),!i.m_sCouleur&&t.m_sCouleur&&t.m_sCouleur.length&&(i.m_sCouleur=t.m_sCouleur),!i.m_sCouleurFond&&t.m_sCouleurFond&&t.m_sCouleurFond.length&&(i.m_sCouleurFond=t.m_sCouleurFond),i};WDLigne.prototype.tabGetValeurs=function(){return this.m_tabValeurs};WDLigne.prototype.tabGetCouleur=function(){return this.m_tabCouleur||(this.m_tabCouleur=new Array(this.tabGetValeurs().length)),this.m_tabCouleur};WDLigne.prototype.tabGetCouleurFond=function(){return this.m_tabCouleurFond||(this.m_tabCouleurFond=new Array(this.tabGetValeurs().length)),this.m_tabCouleurFond};WDLigne.prototype.SetModifieRuptures=function(n){this.m_bModifieRuptures=this.m_bModifieRuptures||n};WDLigne.prototype.bGetClearPCodeAffichage=function(){var n=this.m_bPCodeAffichage;return this.m_bPCodeAffichage=!0,!n};WDLigne.prototype.bGetClearModifieRuptures=function(){var n=this.m_bModifieRuptures;return this.m_bModifieRuptures=!1,n};WDLigne.prototype.nGetRuptures=function(n){return n?this.m_nRupturesHaut:this.m_nRupturesBas};WDLigne.prototype.bGetRupture=function(n,t){return this.bGetRuptureDirect(n,t)||0<n&&this.bGetRupture(n-1,t)};WDLigne.prototype.bGetRuptureDirect=function(n,t){return 0!=(this.nGetRuptures(t)&1<<n)};WDLigne.prototype.bGetRuptureVisible=function(n,t){if(!this.bGetDeroule())if(t){for(var i=n-1;0<=i;i--)if(0==(this.m_nDeroule&1<<i))return!1}else return!1;return this.bGetRupture(n,t)};WDLigne.prototype.bGetDeroule=function(){return this.ms_nTous==this.m_nDeroule};WDLigne.prototype.CopieEnrouleDeroule=function(n,t){var i=1<<t;0==(n.m_nDeroule&i)?this.m_nDeroule&=~i:this.m_nDeroule|=i};WDLigne.prototype.OnSupprime=function(){this.m_tabValeurs.length=0};WDLigne.prototype.EnrouleDeroule=function(n,t,i){var r=1<<n;t===undefined&&(t=0==(this.m_nDeroule&r));t?(this.m_nDeroule|=r,i&&0<n&&this.EnrouleDeroule(n-1,t,i)):this.m_nDeroule&=~r};WDLigne.prototype.bEstEnroule=function(n){var t=1<<n;return 0==(this.m_nDeroule&t)};WDLigne.prototype.SetRupturesHaut=function(n){var t=this.m_nRupturesHaut^n;this.m_nRupturesHaut=n;this.m_nDeroule|=t};WDLigne.prototype.SetRupturesBas=function(n){this.m_nRupturesBas=n};WDLigne.prototype.bGetVerifieFiltre=function(){return this.m_bVerifieFiltre||this.bGetLigneVirtuelle()};WDLigne.prototype.SetVerifieFiltre=function(n){this.m_bVerifieFiltre=n};WDLigne.prototype.bGetLigneVirtuelle=function(){return this.m_bLigneVirtuelle};WDLigne.prototype.RAZLigneVirtuelle=function(){this.m_bLigneVirtuelle=!1};WDTableZRNavigateur.prototype=new WDChampParametresHote;WDTableZRNavigateur.prototype.constructor=WDTableZRNavigateur;WDTableZRNavigateur.prototype.ms_nLigneInvalide=-1;WDTableZRNavigateur.prototype.ms_nColonneInvalide=-1;WDTableZRNavigateur.prototype.ms_sDynO="[%";WDTableZRNavigateur.prototype.ms_sDynF="%]";WDTableZRNavigateur.prototype.ms_sDynSi="[%SI%]";WDTableZRNavigateur.prototype.ms_sDynAlors="[%ALORS%]";WDTableZRNavigateur.prototype.ms_sDynSinon="[%SINON%]";WDTableZRNavigateur.prototype.ms_sDynFin="[%FIN%]";WDTableZRNavigateur.prototype.ms_sInclureHautRupture="INCLURE_HAUTRUPTURE";WDTableZRNavigateur.prototype.ms_sInclureBasRupture="INCLURE_BASRUPTURE";WDTableZRNavigateur.prototype.ms_sCodeHTML30="CODEHTML_30_";WDTableZRNavigateur.prototype.ms_sCodeHTML31="CODEHTML_31_";WDTableZRNavigateur.prototype.ms_sCodeHTML32="CODEHTML_32";WDTableZRNavigateur.prototype.ms_sConditionEgal="=";WDTableZRNavigateur.prototype.ms_sConditionDifferent="!=";WDTableZRNavigateur.prototype.ms_sPropriete="..";WDTableZRNavigateur.prototype.ms_sConversion=";";WDTableZRNavigateur.prototype.ms_nAttributRuptureLigneDebut=-1;WDTableZRNavigateur.prototype.ms_nAttributRuptureLigneFin=-2;WDTableZRNavigateur.prototype.ms_nAttributLigneRepliee=-3;WDTableZRNavigateur.prototype.ms_nAttributIncludeHautRupture=-4;WDTableZRNavigateur.prototype.ms_nAttributIncludeBasRupture=-5;WDTableZRNavigateur.prototype.ms_nAttributLignePaire=-6;WDTableZRNavigateur.prototype.ms_nAttributTriable=-7;WDTableZRNavigateur.prototype.ms_nAttributRecherchable=-8;WDTableZRNavigateur.prototype.ms_nAttributSelected=-9;WDTableZRNavigateur.prototype.ms_nAttributDerniereVisible=-10;WDTableZRNavigateur.prototype.ms_nAttributCodeHTML30=-11;WDTableZRNavigateur.prototype.ms_nAttributCodeHTML31=-12;WDTableZRNavigateur.prototype.ms_nAttributCodeHTML32=-13;WDTableZRNavigateur.prototype.ms_nAttributExiste=-14;WDTableZRNavigateur.prototype.ms_nConversionPoliceGras=4;WDTableZRNavigateur.prototype.ms_nConversionPoliceItalique=5;WDTableZRNavigateur.prototype.ms_nConversionPoliceSouligne=6;WDTableZRNavigateur.prototype.ms_nConversionPoliceTaille=7;WDTableZRNavigateur.prototype.ms_nTdEchange=2147483648;WDTableZRNavigateur.prototype.Init=function(){WDChampParametresHote.prototype.Init.apply(this,arguments);this.__HTMLParse();this.m_oSelection.Init()};WDTableZRNavigateur.prototype.SetValeur=function(n,t){return WDChampParametresHote.prototype.SetValeur.apply(this,arguments),this.m_oSelection.ReinitSelection(this._xnLigneWLLigne(t)),this._nGetSelection()};WDTableZRNavigateur.prototype.GetValeur=function(n,t,i){return t=this._nLigneLigneWL(this._nGetSelection()),WDChampParametresHote.prototype.GetValeur.apply(this,[n,t,i])};WDTableZRNavigateur.prototype.GetProp=function(n){switch(n){case this.XML_CHAMP_PROP_NUM_OCCURRENCE:return this._nGetNbLignesWL();default:return WDChampParametresHote.prototype.GetProp.apply(this,arguments)}};WDTableZRNavigateur.prototype._vLiaisonHTML=function(n,t){n="";WDChampParametresHote.prototype._vLiaisonHTML.apply(this,[n,t])};WDTableZRNavigateur.prototype._vAppliqueParametres=function(){var n=this.m_oParametres,t;clWDUtil.bForEachThis(n.m_tabColonnes,this,this.__bDeclareColonne);clWDUtil.bForEachThis(n.m_tabRuptures,this,this.__bDeclareRupture);this.m_tabSurEntetes=n.m_tabSurEntetes;this.m_bSaisieCascade=n.m_bSaisieCascade;this.m_bSaisieCascade&&this.__AjouteLigneVirtuelle();this.m_oStyleLigneImpair=n.m_oStyleLigneImpair;this.m_oStyleLignePair=n.m_oStyleLignePair;this.m_oStyleLigneSelectionne=n.m_oStyleLigneSelectionne;t=this.m_oDonnees;n.m_tabColonnes=null;n.m_tabRuptures=null};WDTableZRNavigateur.prototype.__bDeclareColonne=function(n){return this.m_tabColonnes.push(new this._vNewColonne(n.m_sAlias,n.m_eTypeWL,n.m_tabProprietesSpecifiques)),!0};WDTableZRNavigateur.prototype.__bDeclareRupture=function(n){return this.m_tabRuptures.push(new this._vNewRupture(n.m_sAlias,this._nGetColonneSelonAlias(n.m_sAliasColonne),n.m_tabPCodesHaut,n.m_tabPCodesBas,n.m_bVisibleHaut,n.m_bVisibleBas)),!0};WDTableZRNavigateur.prototype.AjouteDonnees=function(){var n=this.m_oDonnees;clWDUtil.bForEachThis(n.m_tabLignes,this,this.__bDeclareLigne);n.m_tabLignes=null};WDTableZRNavigateur.prototype.__bDeclareLigne=function(n){var t=[];return clWDUtil.bForEach(n.m_tabCellules,function(n){return t.push(n.m_oContenu),!0}),this._nLigneInsere(!1,t),!0};WDTableZRNavigateur.prototype.__AjouteLigneVirtuelle=function(){this.m_tabLignes.push(new this._vLigne(this._nGetNbColonnes(),!0));this.__LigneModifie([],this.m_tabLignes.length-1,undefined,!0)};WDTableZRNavigateur.prototype.vTableZROnSelectLigne=function(n){this._vSetValeurChampFormulaire(n)};WDTableZRNavigateur.prototype.vTableZROnValideLigne=function(n,t,i){if(t){var r=this._nGetColonneSelonAlias(t.m_sAliasAttribut);undefined!==r&&this.__OnLigneModifieFormulaire(n,[r,this._nGetSelection(),i])}};WDTableZRNavigateur.prototype.s_bRedimImage=function(n){var i,t,f,s;if(bIE&&n.readyState!="complete"||!n.parentNode||(i=n.offsetWidth,t=n.offsetHeight,0==i||0==t))return!1;var u=n.parentNode.parentNode.clientWidth,r=n.parentNode.parentNode.clientHeight,e=u,o=r;if(i<=u){if(t<=r)return!0;e=i*r/t}else t<=r?o=t*u/i:(f=i/t,s=u/r,s>f?e=r*f:o=u*f);return n.style.width=Math.round(e)+"px",n.style.height=Math.round(o)+"px",!0};WDTableZRNavigateur.prototype._nGetNbColonnes=function(){return this.m_tabColonnes.length};WDTableZRNavigateur.prototype._nGetNbRuptures=function(){return this.m_tabRuptures.length};WDTableZRNavigateur.prototype._nGetNbLignes=function(){return this.m_tabLignes.length};WDTableZRNavigateur.prototype._nGetNbLignesWL=function(){return this.m_nNbLignesWL};WDTableZRNavigateur.prototype._oGetColonne=function(n){return this.m_tabColonnes[n]};WDTableZRNavigateur.prototype._nGetColonneSelonAlias=function(n){return WDSousChamp.prototype.s_nChercheParAlias(this.m_tabColonnes,n)};WDTableZRNavigateur.prototype._nGetRuptureSelonAlias=function(n){return WDSousChamp.prototype.s_nChercheParAlias(this.m_tabRuptures,n)};WDTableZRNavigateur.prototype.__nGetAttributSelonChampEtPropriete=function(n,t){return clWDUtil.nDansTableauFct(this.m_tabColonnes,function(i){return i instanceof WDAttribut&&i.m_sAliasChampAssocie==n&&i.m_eProprieteAssocie==WDTableZRNavigateur.prototype.s_eGetProprietePrincipale(t,i.m_eTypeChampAssocie)||i instanceof WDTableColonne&&i.m_sAlias==n&&WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR==t})};WDTableZRNavigateur.prototype.s_eGetProprietePrincipale=function(n,t){switch(t){case WDChamp.prototype.ms_nIDObjetLibelle:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR}break;case WDChamp.prototype.ms_nIDObjetBouton:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR}break;case WDChamp.prototype.ms_nIDObjetImage:switch(n){case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:return WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR}}return n};WDTableZRNavigateur.prototype.__RupturesEntreLignes=function(n,t,i,r){var u,s=this.m_tabRuptures,o,e;if(n&&t){u=WDLigne.prototype.ms_nRien;for(var h=n.tabGetValeurs(),c=t.tabGetValeurs(),l=this._nGetNbRuptures(),f=0;f<l;f++)o=s[f].m_nColonne,h[o]!=c[o]&&(u|=1<<f)}else u=WDLigne.prototype.ms_nTous;n&&(e=n.nGetRuptures(!1),n.SetRupturesBas(u),this.__AppelPCodeAffichageRuptures(i,u,e,!1));t&&(e=t.nGetRuptures(!0),t.SetRupturesHaut(u),this.__AppelPCodeAffichageRuptures(r,u,e,!0))};WDTableZRNavigateur.prototype.__AppelPCodeAffichageRuptures=function(n,t,i,r){for(var f=this.m_tabRuptures,e=f.length,u=0;u<e;u++)t&1<<u&&this.__AppelPCodeAffichage(n,f[u].RecuperePCode(this.ms_nEventNavAffichageLigne,r))};WDTableZRNavigateur.prototype.__TableAfficheCalculs=function(n){for(var r=this.m_tabLignes,u=this._nGetNbLignes(),e=this.RecuperePCode(this.ms_nEventNavAffichageLigne),i,f,t=n;t<u;t++)r[t].bGetClearPCodeAffichage()&&this.__AppelPCodeAffichage(t,e);if(0<this._nGetNbRuptures())for(t=0<n?n-1:n;t<u;t++)i=r[t],i.bGetClearModifieRuptures()&&(t==0&&this.__RupturesEntreLignes(undefined,i,undefined,0),f=t<u-1?r[t+1]:undefined,this.__RupturesEntreLignes(i,f,t,t+1))};WDTableZRNavigateur.prototype.__AppelPCodeAffichage=function(n,t){if(t!=clWDUtil.m_pfVide)try{var i=this.m_bEnPCodeAffichageLigne;return this.m_bEnPCodeAffichageLigne=!0,this.__oAppelPCodeSurLigne(n,t)}finally{this.m_bEnPCodeAffichageLigne=i}};WDTableZRNavigateur.prototype.__oAppelPCodeSurLigne=function(n,t,i){if(t!=clWDUtil.m_pfVide)try{var r=this.nGetForceSelection();return this.ForceSelection(n),this._voAppelPCodeSurLigne(n,t,i)}finally{this.m_oSelection.ForceSelection(r)}};WDTableZRNavigateur.prototype._voAppelPCodeSurLigne=function(n,t,i){return t(i)};WDTableZRNavigateur.prototype.__OnLigneModificationRuptures=function(n){this.ms_nLigneInvalide==n&&(n=0);var t=this.m_tabLignes[n];t&&t.SetModifieRuptures(!0)};WDTableZRNavigateur.prototype.__OnLigneModification=function(n,t,i,r){var u=this.m_tabLignes[n],e,f;!r&&u.bGetLigneVirtuelle()&&(u.RAZLigneVirtuelle(),this.__AjouteLigneVirtuelle(),this._OnNbLignesChange());this.__OnLigneModificationRuptures(n-1);this.__OnLigneModificationRuptures(n);this._bAvecFiltre()&&(e=u.bGetVerifieFiltre(),f=this._bVerifieFiltre(u.tabGetValeurs()),u.SetVerifieFiltre(f),e!=f&&this._OnNbLignesChange());this._TableAfficheLigne(n,t,i)};WDTableZRNavigateur.prototype.__LigneModifie=function(n,t,i,r){for(var e=this.m_tabLignes[t].tabGetValeurs(),f=this.m_tabColonnes,o=f.length,u=0;u<o;u++)e[u]=f[u].oGetValeurInterne(n[u],r);this.__OnLigneModification(t,undefined,i,r)};WDTableZRNavigateur.prototype._HTMLAffiche=function(n,t){if(clWDUtil.SupprimeFilsEtOnFocus(n,!1),bIE&&clWDUtil.bBaliseEstTag(n,"table")){var i=(n.outerHTML+"").split("><");n.outerHTML=i[0]+">"+t.join("")+"<"+i[i.length-1]}else n.innerHTML=t.join("");this._vLiaisonHTML()};WDTableZRNavigateur.prototype.__TableAffiche=function(n){var u={},r,i;this._vPreAffiche(u);this.__TableAfficheCalculs(n);for(var f=[],o=this.m_tabLignes,e=0,s=this._nGetNbLignes(),t=0;t<s;t++)(r=o[t],r.bGetVerifieFiltre())&&(this._vHTMLGenereLigne(t,e,r,f),e++);this._HTMLAffiche(this.m_oHote,f);bIEQuirks&&(i=_JGE(this.m_sAliasChamp,document,!0,!1),i&&clWDUtil.oGetCurrentStyle(i).position=="absolute"&&(i.className=i.className));this._vPostAffiche(u);clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,this.m_oHote)};WDTableZRNavigateur.prototype._vPreAffiche=function(n){this.__MemoriseFocus(n)};WDTableZRNavigateur.prototype.__MemoriseFocus=function(n){var t,i,r;try{t=document.activeElement;t&&clWDUtil.bEstFils(t,this.m_oHote,document)&&(i=t.name,i&&i.length&&(r=clWDUtil.nDansTableau(document.getElementsByName(i),t),clWDUtil.nElementInconnu==r&&(r=0),n.m_sFocusNom=i,n.m_nFocusIndice=r))}catch(u){}};WDTableZRNavigateur.prototype._vPostAffiche=function(n){this.__SetOnBlurChange();this.__OnAffichageLignes();this.__ReplaceFocus(n)};WDTableZRNavigateur.prototype.__SetOnBlurChange=function(){for(var f=clWDUtil.tabGetElements(this.m_oHote,!1),o=f.length,t,i,r,u,e,n=0;n<o;n++)t=f[n],i=[],clWDUtil.bEstAliasAttributZR(t,i)&&(r=this._nLigneWLLigne(i[0]),u=this._nGetColonneSelonAlias(i[1]),r!==undefined&&u!==undefined&&(e=t.onchange!==undefined?"onchange":"onblur",clWDUtil.SetOnXxx(t,e,this,this.__OnLigneModifieFormulaire,[u,r],!0)))};WDTableZRNavigateur.prototype.__OnLigneModifieFormulaire=function(n,t){var f=t[0],e=t[1],r,u=this.m_tabColonnes[f],i;if(2<t.length)r=u.oGetValeurInterne(t[2]);else{i=clWDUtil.oGetTarget(n);r=i.value;switch(i.type.toLowerCase()){case"checkbox":r=!!i.checked;break;case"radio":if(!i.checked)return;break;case"select-multiple":case"select-one":r=i.selectedIndex!=-1?parseInt(i.options[i.selectedIndex].value,10):-1;break;case"text":u.m_pfConversionDepuisAffichage&&(r=u.m_pfConversionDepuisAffichage(r))}}this.m_tabLignes[e].tabGetValeurs()[f]=r;this.__OnLigneModification(e,this.ms_nLigneInvalide,0==this._nGetNbRuptures())};WDTableZRNavigateur.prototype.__OnAffichageLignes=function(){for(var i=this._nGetSelection(),t=0,r=this.m_tabLignes,u=this._nGetNbLignes(),n=0;n<u;n++)r[n].bGetVerifieFiltre()&&(t++,this.m_tabChampsFils._AppelMethodePtr(WDChamp.prototype.OnLigneTableZRAffiche,[t,n==i]))};WDTableZRNavigateur.prototype.__ReplaceFocus=function(n){n.m_nFocusIndice!==undefined&&this.nSetTimeoutUnique("__SetFocus",clWDUtil.ms_oTimeoutImmediat,n)};WDTableZRNavigateur.prototype.__SetFocus=function(n){if(n.m_nFocusIndice!==undefined)try{document.getElementsByName(n.m_sFocusNom)[n.m_nFocusIndice].focus()}catch(t){}};WDTableZRNavigateur.prototype._OnNbLignesChange=function(){var n,i,t,r;if(this._bAvecFiltre())for(n=0,i=this.m_tabLignes,r=this._nGetNbLignes(),t=0;t<r;t++)i[t].bGetVerifieFiltre()&&n++;else n=this._nGetNbLignes();this.m_bSaisieCascade&&n--;this.m_nNbLignesWL=n};WDTableZRNavigateur.prototype._bLigneSupprime=function(n){var t=this.m_tabLignes[n];return t.OnSupprime(),this.m_tabLignes.splice(n,1),t.bGetLigneVirtuelle()&&this.__AjouteLigneVirtuelle(),this._OnNbLignesChange(),this.m_oSelection.OnLigneSupprime(n),this.__OnLigneModificationRuptures(n-1),!0};WDTableZRNavigateur.prototype._LigneSupprimeTout=function(){this.m_oSelection.bSelectAucun();clWDUtil.bForEach(this.m_tabLignes,function(n){return n.OnSupprime(),!0});this.m_tabLignes.length=0;this.m_bSaisieCascade&&this.__AjouteLigneVirtuelle();this._OnNbLignesChange();this._TableAffiche()};WDTableZRNavigateur.prototype.__s_nTriCompare=function(n,t,i){var r,f;if(n.bGetLigneVirtuelle())return 1;if(t.bGetLigneVirtuelle())return-1;for(var e=n.tabGetValeurs(),o=t.tabGetValeurs(),s=i.length,u=0;u<s;u++)if(r=i[u],f=r.m_fCompare(e[r.m_nColonne],o[r.m_nColonne]),0!=f)return r.m_bCroissant?f:-f;return 0};WDTableZRNavigateur.prototype.__nLigneCherche=function(n,t,i,r){for(var f=this.m_tabColonnes[n],o=f.oGetValeurInterne(t),s=f.fGetCompare(i),h=this.m_tabLignes,c=this._nGetNbLignes(),e,u=r;u<c;u++)if((e=h[u],e.bGetVerifieFiltre())&&0==s(f.oGetValeurAvecLigne(n,e,!1),o))return u;return this.ms_nLigneInvalide};WDTableZRNavigateur.prototype._vsLitPropriete=function(n,t,i,r,u){switch(r){case this.XML_CHAMP_PROP_NUM_VALEUR:return t+1;case this.XML_CHAMP_PROP_NUM_COULEURFOND:return i.m_sCouleurFond!==undefined?i.m_sCouleurFond:"";case this.ms_nAttributRuptureLigneDebut:return t%this.m_nNbLignesLogiquesParLignePhysique==0;case this.ms_nAttributRuptureLigneFin:return t%this.m_nNbLignesLogiquesParLignePhysique==this.m_nNbLignesLogiquesParLignePhysique-1;case this.ms_nAttributLigneRepliee:return!1==this.m_tabLignes[n].bGetDeroule();case this.ms_nAttributIncludeHautRupture:return this.__bGetRuptureVisible(n,u,!0);case this.ms_nAttributIncludeBasRupture:return this.__bGetRuptureVisible(n,u,!1);case this.ms_nAttributLignePaire:return 1==t%2;case this.ms_nAttributSelected:return this.m_oSelection.bGetLigneEstSelectionnee(n)?"SELECTED":"";case this.ms_nAttributCodeHTML30:return this.__nGetNbCOLPSANPourCelluleSurEntete(u);case this.ms_nAttributCodeHTML31:return this.__nGetColonneRedimPourCelluleSurEntete(u);case this.ms_nAttributCodeHTML32:return this._vnGetColSpanRupture();case this.ms_nAttributExiste:return this.__bGetAttributAutomatiqueExiste(u);default:return""}};WDTableZRNavigateur.prototype.__bGetRuptureVisible=function(n,t,i){return this.m_tabRuptures[t].bVisible(i)?this.m_tabLignes[n].bGetRuptureVisible(t,i):!1};WDTableZRNavigateur.prototype.__nGetNbCOLPSANPourCelluleSurEntete=function(n){for(var u=this._nGetNbColonnes(),t=n%u,o=(n-t)/u,f=this.m_tabSurEntetes[o][t],e=0,i=0,r;0<f;)r=this._oGetColonne(t),r.m_bVisible&&(e=i+1,i=i+1,r.m_bAjustable&&i++),t++,f--;return e};WDTableZRNavigateur.prototype.__nGetColonneRedimPourCelluleSurEntete=function(n){for(var u,r=this._nGetNbColonnes(),t=n%r,f=(n-t)/r,e=this.m_tabSurEntetes[f][t],i=t+e-1;t<=i;i--)if(u=this._oGetColonne(t),u.m_bVisible)return i;return t};WDTableZRNavigateur.prototype._vnGetColSpanRupture=function(){return""};WDTableZRNavigateur.prototype.__bGetAttributAutomatiqueExiste=function(n){return!!this._nGetColonneSelonAlias(n)};WDTableZRNavigateur.prototype._bVerifieFiltre=function(n){return clWDUtil.bForEach(this.m_tabFiltre,function(t){return t.m_fFiltre(n[t.m_nColonne],t.m_sValeur)})};WDTableZRNavigateur.prototype._oGetProprieteColonneAvecIndice=function(n,t,i,r,u){return this._oGetColonne(n).vsLitPropriete(this,n,t,i,this.m_tabLignes[t],r,u)};WDTableZRNavigateur.prototype._xLigneModifie=function(n,t){var i=this._xnLigneWLLigne(t,this._nGetSelection());this.__LigneModifie(n,i)};WDTableZRNavigateur.prototype._nLigneInsere=function(n,t,i){var r=this._nLigneWLLigne(i),f,u,e,s,o;if(r===undefined&&this.m_bSaisieCascade&&(r=this._nGetNbLignes()-1),f=new this._vLigne(this._nGetNbColonnes()),r!==undefined?this.m_tabLignes.splice(r,0,f):(this.m_tabLignes.push(f),r=this._nGetNbLignes()-1),this._OnNbLignesChange(),this.__LigneModifie(t,r),this.m_oSelection.OnLigneInsere(r),n){if(this._TriEncore(),this.m_tabLignes[r]!=f)for(e=this._nGetNbLignes(),u=0;u<e;u++)if(this.m_tabLignes[u]==f){r=u;break}this.__LigneModifie(t,r)}if(e=this._nGetNbRuptures(),0<e){if(0<r)for(s=this.m_tabLignes[r-1],u=0;u<e;u++)if(f.bGetRuptureDirect(u,!0))break;else f.CopieEnrouleDeroule(s,u);if(r<this._nGetNbLignes()-1)for(o=this.m_tabLignes[r+1],u=0;u<e;u++)if(o.bGetRuptureDirect(u,!0))break;else f.CopieEnrouleDeroule(o,u)}return this._nLigneLigneWL(r)};WDTableZRNavigateur.prototype._TableAffiche=function(n,t){this.m_bEnPCodeAffichageLigne===undefined&&(this.m_nLigneAfficheSuivante=0,undefined!==n&&(this.m_nTAOptions|=n,this.m_nTAParametre=t),this.nSetTimeoutUnique("_Affiche",clWDUtil.ms_oTimeoutImmediat))};WDTableZRNavigateur.prototype._TableAfficheLigne=function(n,t,i){if(!i&&this.m_bEnPCodeAffichageLigne===undefined){var r=n;0<n&&r--;this.m_nLigneAfficheSuivante=this.m_nLigneAfficheSuivante===undefined?r:Math.min(r,this.m_nLigneAfficheSuivante);undefined!==t&&this.ms_nLigneInvalide!=t&&(this.m_nTAOptions|=clWDTableDefs.ms_nOptionTAMontreLigne,this.m_nTAParametre=t);this.nSetTimeoutUnique("_Affiche",clWDUtil.ms_oTimeoutImmediat)}};WDTableZRNavigateur.prototype._Affiche=function(){this.AnnuleTimeXXX("_Affiche",!1);var n;this.m_nTAOptions&clWDTableDefs.ms_nOptionTAPreserveScroll&&(n=this.m_oHote.parentNode.scrollTop);this.m_nTAOptions&clWDTableDefs.ms_nOptionTARedessineTitre&&this._vTableAfficheTitres();this.__TableAffiche(this.m_nLigneAfficheSuivante);this.m_nTAOptions&clWDTableDefs.ms_nOptionTAMontreLigne&&(n=this.oGetIDElement(this._nLigneLigneWL(this.m_nTAParametre)).offsetTop);undefined!==n&&(this.m_oHote.parentNode.scrollTop=n);this.m_nTAParametre=null;this.m_nTAOptions=0;this.m_oCelluleSaisie&&this.m_oCelluleSaisie.OnMAJDonnees()};WDTableZRNavigateur.prototype._vTableAfficheTitres=clWDUtil.m_pfVide;WDTableZRNavigateur.prototype.OnChangementSelection=function(n,t,i){(t&&this.RecuperePCode(this.ms_nEventNavSelectLigne)(i),this.m_bDansSelectionExterne&&this._vbAvecCouleurDeFondSelection())||this._TableAfficheLigne(n)};WDTableZRNavigateur.prototype._nLigneDeplace=function(n,t,i,r){var e=t,u=this.m_tabLignes,f=u[n];return i?(u[n]=u[t],u[t]=f,this.__OnLigneModification(n),this.__OnLigneModification(t,r?t:this.ms_nLigneInvalide)):(u.splice(n,1),n<t&&t--,u.splice(t,0,f),this.__OnLigneModification(t,r?t:this.ms_nLigneInvalide),this.__OnLigneModificationRuptures(n-1)),this.m_oSelection.OnLigneDeplace(n,e,i),this._nLigneLigneWL(t)};WDTableZRNavigateur.prototype._nGetSelection=function(){return this.m_oSelection.nGetSelection()};WDTableZRNavigateur.prototype.nGetForceSelection=function(){return this.m_oSelection.nGetForceSelection()};WDTableZRNavigateur.prototype.ForceSelection=function(n){return this.m_oSelection.ForceSelection(n)};WDTableZRNavigateur.prototype._nIndiceRupture=function(n,t){var r=this._nGetRuptureSelonAlias(n),u,i;if(r!==undefined)for(u=this.m_tabLignes,i=t;0<=i;i--)if(u[i].bGetRupture(r,!0))return this._nLigneLigneWL(i);return this.ms_nLigneInvalide};WDTableZRNavigateur.prototype._xnGetColonneSelonAlias=function(n){var t=this._nGetColonneSelonAlias(n);if(undefined===t)throw new WDErreur(302,n);return t};WDTableZRNavigateur.prototype._xoGetColonneSelonAlias=function(n){return this.m_tabColonnes[this._xnGetColonneSelonAlias(n)]};WDTableZRNavigateur.prototype._Tri=function(n){var t,i,u,e,f,r;this._TriAnnule();t=!0;switch(n){case"-":t=!1;case"+":for(u=this._nGetNbColonnes(),i=0;i<u;i++)this._ActiveTri(i,t);break;default:for(e=n.split("\t"),u=e.length,f=0;f<u;f++){r=e[f];t=!0;switch(r.substring(0,1)){case"-":t=!1;case"+":r=r.substring(1)}i=this._xnGetColonneSelonAlias(r);this._ActiveTri(i,t)}}this._TriEncore()};WDTableZRNavigateur.prototype._ActiveTri=function(n,t){var i=this.m_tabColonnes[n];this.m_tabTri.push({m_fCompare:i.fGetCompare(),m_nColonne:n,m_bCroissant:t});this._vInvalidePourTRF(n,t)};WDTableZRNavigateur.prototype._TriSurUneColonne=function(n,t){this._TriAnnule();this._ActiveTri(n,t);this._TriEncore()};WDTableZRNavigateur.prototype._TriEncore=function(){var n=this.m_tabTri;0<n.length&&(this.m_tabLignes.sort(function(){return WDTableZRNavigateur.prototype.__s_nTriCompare(arguments[0],arguments[1],n)}),this.m_oSelection.ReinitSelection(0))};WDTableZRNavigateur.prototype.SelectExterne=function(n){try{var t=this.m_bDansSelectionExterne;this.m_bDansSelectionExterne=!0;this.m_oSelection.ReinitSelectionSansReselection(this._nLigneWLLigne(n))}finally{this.m_bDansSelectionExterne=t}};WDTableZRNavigateur.prototype._vInvalidePourTRF=clWDUtil.m_pfVide;WDTableZRNavigateur.prototype._TriAnnule=function(){for(var t=this.m_tabTri,i=t.length,n=0;n<i;n++)this._vInvalidePourTRF(t[n].m_nColonne);this.m_tabTri.length=0};WDTableZRNavigateur.prototype._bAvecFiltre=function(){return 0<this.m_tabFiltre.length};WDTableZRNavigateur.prototype._bFiltreAnnule=function(){var n=this._bAvecFiltre();return this.m_tabFiltre.length=0,n};WDTableZRNavigateur.prototype._xnLigneCherche=function(n,t,i,r){var f=this._xnGetColonneSelonAlias(n),u=this.ms_nLigneInvalide;return u=this.__nLigneCherche(f,t,i,r),this._nLigneLigneWL(u)};WDTableZRNavigateur.prototype._EnrouleDerouleI=function(n,t,i,r,u){var o=this.m_tabLignes[n],s,f,h,e;if(this.__RupturesEntreLignes(this.m_tabLignes[n-1],o,n-1,n),o.bGetRupture(t,!0)){for(o.EnrouleDeroule(t,i,r),s=o,h=this._nGetNbLignes(),f=n+1;f<h;f++)if(e=this.m_tabLignes[f],this.__RupturesEntreLignes(s,e,f-1,f),e.bGetRupture(t,!0))break;else e.EnrouleDeroule(t,i,r),s=e;u&&this._TableAfficheLigne(n)}};WDTableZRNavigateur.prototype._xEnrouleDeroule=function(n,t,i){var f=this._xnLigneWLLigne(n,this._nGetSelection()),r,u;t===undefined?(r=0<this._nGetNbRuptures()?0:undefined,u=!0):(r=this._nGetRuptureSelonAlias(t),u=!1);r!==undefined&&0<=r&&this._EnrouleDerouleI(f,r,i,u,!0)};WDTableZRNavigateur.prototype._EnrouleDerouleTout=function(n){for(var u=this._nGetNbLignes(),i,r,t=0;t<u;t++)for(r=this._nGetNbRuptures(),i=0;i<r;i++)this._EnrouleDerouleI(t,i,n,!0,!1);this._TableAffiche()};WDTableZRNavigateur.prototype._xnSelectPlusMoins=function(n,t,i){for(var u=i.length,r=0;r<u;r++)i[r]=this._xnLigneWLLigne(i[r],this._nGetSelection());return this.m_oSelection.xSelectPlusMoins(n,t,i),i.length?i[0]:this.ms_nLigneInvalide};WDTableZRNavigateur.prototype._bDesactiveFiltreUneColonne=function(n){var i=clWDUtil.nDansTableauFct(this.m_tabFiltre,this.__s_bCompareRTFParColonne,n),t;return clWDUtil.nElementInconnu!=i?(this.m_tabFiltre.splice(i,1),t=this.m_tabColonnes[n],t.SetFiltre(t.ms_nFiltreRecherche),!0):!1};WDTableZRNavigateur.prototype.__s_bCompareRTFParColonne=function(n,t){return n.m_nColonne==t};WDTableZRNavigateur.prototype._ActiveFiltre=function(n,t,i){var r=WDTableColonne.prototype.s_xfGetFiltre(t);this._bDesactiveFiltreUneColonne(n);this.m_tabColonnes[n].SetFiltre(t);this.m_tabFiltre.push({m_nColonne:n,m_fFiltre:r,m_nFiltre:t,m_sValeur:i});this._Refiltre(!0,!0)};WDTableZRNavigateur.prototype._Refiltre=function(n,t){var u,i,f,r;if(n){for(u=this.m_tabLignes,f=this._nGetNbLignes(),i=0;i<f;i++)r=u[i],r.SetVerifieFiltre(this._bVerifieFiltre(r.tabGetValeurs()));this._OnNbLignesChange();t&&this._TableAffiche();this.m_oSelection.ReinitSelection(0);this._vInvalidePourTRF()}};WDTableZRNavigateur.prototype.nGetLigneAfficheeAutour=function(n){for(var i=this.m_tabLignes,r=this._nGetNbLignes(),t=n;t<r;t++)if(i[t].bGetVerifieFiltre())return t;for(t=n-1;0<=t;t--)if(i[t].bGetVerifieFiltre())return t;return this.ms_nLigneInvalide};WDTableZRNavigateur.prototype._nLigneWLLigne=function(n,t,i,r,u){var f,o,e,s;if(r&&n===this.ms_nLigneInvalide?f=this._nGetSelection():n===undefined?f=t:(f=parseInt(n,10),isNaN(f)||f--),f!==undefined){if(!isNaN(f)&&0<=f&&(f<this._nGetNbLignesWL()||u&&this.m_bSaisieCascade&&f==this._nGetNbLignesWL()))if(this._bAvecFiltre()){for(o=this.m_tabLignes,s=o.length,e=0;e<=s;e++)if(o[e].bGetVerifieFiltre()&&0==f--)return e}else return f;return i}return f};WDTableZRNavigateur.prototype._xnLigneWLLigne=function(n,t,i,r){var f=this._nGetNbLignes(),u;if(0==f)throw new WDErreur(300,n);if(u=this._nLigneWLLigne(n,t,i,r),u===i)throw new WDErreur(301,n,1,f);return u};WDTableZRNavigateur.prototype._nLigneLigneWL=function(n){if(n!=this.ms_nLigneInvalide){if(this._bAvecFiltre()){for(var r=this.m_tabLignes,i=0,t=0;t<=n;t++)r[t].bGetVerifieFiltre()&&i++;return i}return n+1}return this.ms_nLigneInvalide};WDTableZRNavigateur.prototype.Ajoute=function(n){return this.ms_nLigneInvalide!=this._nLigneInsere(!0,(""+n).split("\t"))};WDTableZRNavigateur.prototype.AjouteLigne=function(){return this._nLigneInsere(!0,this.__tabArgumentsVersTableau(arguments,0))};WDTableZRNavigateur.prototype.Modifie=function(n,t){this._xLigneModifie((""+n).split("\t"),t)};WDTableZRNavigateur.prototype.ModifieLigne=function(n){this._xLigneModifie(this.__tabArgumentsVersTableau(arguments,1),n)};WDTableZRNavigateur.prototype.Insere=function(n,t){return this.ms_nLigneInvalide!=this._nLigneInsere(!1,(""+n).split("\t"),t)};WDTableZRNavigateur.prototype.InsereLigne=function(n){this._nLigneInsere(!1,this.__tabArgumentsVersTableau(arguments,1),n)};WDTableZRNavigateur.prototype.DeplaceLigne=function(n,t,i){var r=this._xnLigneWLLigne(n,undefined,undefined,!0),u=this._xnLigneWLLigne(t,undefined,undefined,!0);return r!=u?this._nLigneDeplace(r,u,0!=(i&this.ms_nTdEchange),0!=(i&65536)):n};WDTableZRNavigateur.prototype.Supprime=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection());this._bLigneSupprime(t)};WDTableZRNavigateur.prototype.SupprimeTout=function(){this._LigneSupprimeTout()};WDTableZRNavigateur.prototype.Occurrence=function(n){n===undefined&&(n=1);switch(n){case 1:return this._nGetNbLignesWL();case 2:return this._nGetNbColonnes();default:return this.ms_nLigneInvalide}};WDTableZRNavigateur.prototype.IndiceRupture=function(n,t){var i=this._xnLigneWLLigne(t,this._nGetSelection());return this._nIndiceRupture(n,i)};WDTableZRNavigateur.prototype.Trie=function(n,t){t?this._Tri(n):this._TriAnnule()};WDTableZRNavigateur.prototype.Cherche=function(n,t,i,r){var u=this._nLigneWLLigne(r,0,0);return this._xnLigneCherche(n,t,0==i,u)};WDTableZRNavigateur.prototype.Enroule=function(n,t){this._xEnrouleDeroule(n,t,!1)};WDTableZRNavigateur.prototype.EnrouleTout=function(){this._EnrouleDerouleTout(!1)};WDTableZRNavigateur.prototype.Deroule=function(n,t){this._xEnrouleDeroule(n,t,!0)};WDTableZRNavigateur.prototype.DerouleTout=function(){this._EnrouleDerouleTout(!0)};WDTableZRNavigateur.prototype.EnrouleDeroule=function(n,t,i){if(i)for(var r=i.target,u=i.currentTarget,f=document.body;r&&r!=u&&r!=f;){if(r.hasAttribute&&r.hasAttribute("onclick")||r.onclick)return;r=r.parentNode}this._xEnrouleDeroule(n,t)};WDTableZRNavigateur.prototype.bGetEnrouleRupture=function(n,t){for(var i=this._nGetRuptureSelonAlias(n),r=this._xnLigneWLLigne(t,this._nGetSelection()),u=this.m_tabLignes[r];0<=i;i--)if(u.bEstEnroule(i))return!0;return!1};WDTableZRNavigateur.prototype.SetEnrouleRupture=function(n,t,i){this._xEnrouleDeroule(t,n,!i)};WDTableZRNavigateur.prototype.DesactiveFiltre=function(n){var t,i;undefined!==n?(i=this._xnGetColonneSelonAlias(n),t=this._bDesactiveFiltreUneColonne(i)):t=this._bFiltreAnnule();this._Refiltre(t,!0)};WDTableZRNavigateur.prototype.Select=function(n,t){var i=undefined!==n?n-1:0;return undefined===t&&(t=WDSelection.prototype.ms_nTsLigne),this._nLigneLigneWL(this.m_oSelection.xnSelect(i,t))};WDTableZRNavigateur.prototype.SelectMoins=function(){this._xnSelectPlusMoins(this.m_oSelection.bSelectMoins,this.m_oSelection.bSelectAucun,arguments)};WDTableZRNavigateur.prototype.SelectOccurrence=function(n){return undefined===n&&(n=WDSelection.prototype.ms_nTsLigne),this.m_oSelection.xnSelectOccurrence(n)};WDTableZRNavigateur.prototype.SelectPlus=function(){var n=this._xnSelectPlusMoins(this.m_oSelection.bSelectPlus,this.m_oSelection.SelectTous,arguments);this.ms_nSelectionSimple!=this.m_oSelection.m_nTypeSelection&&this.ms_nLigneInvalide!=n&&this._TableAfficheLigne(n,n)};WDTableZRNavigateur.prototype.SupprimeSelect=function(){for(var t=WDSelection.prototype.ms_nTsLigne,i=[],r=this.m_oSelection.xnSelectOccurrence(t),n=0;n<r;n++)i.push(this.m_oSelection.xnSelect(n,t));clWDUtil.bForEachThis(i,this,this._bLigneSupprime)};WDTableZRNavigateur.prototype.ActiveFiltre=function(n,t,i){this._ActiveFiltre(this._xnGetColonneSelonAlias(n),t,i)};WDTableZRNavigateur.prototype.EchangeLigne=function(n,t){this.DeplaceLigne(n,t,this.ms_nTdEchange)};WDTableZRNavigateur.prototype.oGetValeurColonne=function(n,t,i){var r=this._xnGetColonneSelonAlias(n),u;return t!=this.XML_CHAMP_PROP_NUM_VALEUR&&undefined===i?this._oGetColonne(r).vsLitPropriete(this,r,undefined,undefined,undefined,t,!1):(u=this._xnLigneWLLigne(i,this._nGetSelection()),this._oGetProprieteColonneAvecIndice(r,u,u,t,!1))};WDTableZRNavigateur.prototype.oGetProprieteCellule=function(n,t,i){if(n<0||this._nGetNbColonnes()<n)throw new WDErreur(301,n,1,this._nGetNbColonnes());var u=n-1,r=this._xnLigneWLLigne(t,this._nGetSelection());return this._oGetProprieteColonneAvecIndice(u,r,r,i,!1)};WDTableZRNavigateur.prototype.oSetProprieteColonne=function(n){var t=this._xnGetColonneSelonAlias(n);return this._oGetColonne(t)};WDTableZRNavigateur.prototype.oGetLigne=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection()),i=this.m_oSelection.bGetLigneEstSelectionnee(t)?this.m_oStyleLigneSelectionne:undefined,r=t%2==0?this.m_oStyleLigneImpair:this.m_oStyleLignePair;return this.m_tabLignes[t].oGetPropriete(i,r)};WDTableZRNavigateur.prototype.oGetLigneSet=function(n){var t=this._xnLigneWLLigne(n,this._nGetSelection());return this.__OnLigneModification(t),this.m_tabLignes[t]};WDTableZRNavigateur.prototype.tabGetLigneSet=function(n,t){var i=this.oGetLigneSet(t);switch(n){default:case this.XML_CHAMP_PROP_NUM_VALEUR:return i.tabGetValeurs();case this.XML_CHAMP_PROP_NUM_COULEUR:return i.tabGetCouleur();case this.XML_CHAMP_PROP_NUM_COULEURFOND:return i.tabGetCouleurFond()}};WDTableZRNavigateur.prototype.__oGetValeurDefautAttributAutomatique=function(n,t){switch(t){default:case this.XML_CHAMP_PROP_NUM_VALEUR:return"";case this.XML_CHAMP_PROP_NUM_COULEUR:return"#000000";case this.XML_CHAMP_PROP_NUM_COULEURFOND:return"transparent";case this.XML_CHAMP_PROP_NUM_ETAT:return 0;case this.XML_CHAMP_PROP_NUM_VISIBLE:return!0;case this.XML_CHAMP_PROP_NUM_IMAGE:return"";case this.XML_CHAMP_PROP_NUM_POLICEGRAS:return!1;case this.XML_CHAMP_PROP_NUM_POLICEITALIQUE:return!1;case this.XML_CHAMP_PROP_NUM_POLICESOULIGNE:return!1;case this.XML_CHAMP_PROP_NUM_POLICETAILLE:return 12;case this.XML_CHAMP_PROP_NUM_VIGNETTE:return""}};WDTableZRNavigateur.prototype.SetAttributAutomatique=function(n,t,i,r,u,f){var e=this.__nGetAttributSelonChampEtPropriete(n,t),o,s;clWDUtil.nElementInconnu==e&&(e=this._nGetNbColonnes(),o=new this._vNewAttributAutomatique("ATT_"+n+"_"+t,u,[t,n,r]),this.m_tabColonnes.push(o),s=this.__oGetValeurDefautAttributAutomatique(n,t),clWDUtil.bForEach(this.m_tabLignes,function(n){return n.m_tabValeurs.push(s),!0}));this.tabGetLigneSet(this.XML_CHAMP_PROP_NUM_VALEUR,i)[e]=f};WDTableZRNavigateur.prototype.oGetAttributAutomatique=function(n,t,i){var u=this.__nGetAttributSelonChampEtPropriete(n,t),r;return clWDUtil.nElementInconnu!=u?(r=this._xnLigneWLLigne(i,this._nGetSelection()),this._oGetProprieteColonneAvecIndice(u,r,r,this.XML_CHAMP_PROP_NUM_VALEUR,!1)):this.__oGetValeurDefautAttributAutomatique(n,t)};WDTableZRNavigateur.prototype.OnChange=function(){this._TableAffiche()};WDTableZRNavigateur.prototype.__HTMLParse=function(){var n=clWDUtil.sGetHTMLDansCommentaire(this.m_oHote);this.m_oElementsHTML=this._voHTMLParse(n)};WDTableZRNavigateur.prototype.__tabHTMLParse=function(n){var t=[];return this.__nHTMLParseInterne(n,0,t),t};WDTableZRNavigateur.prototype.__nHTMLParseInterne=function(n,t,i,r){for(;;){var u=n.indexOf(this.ms_sDynO,t);if(t=this.__nHTMLParseFixe(n,t,u,i),-1==u)return t;if(n.substr(u,this.ms_sDynFin.length)==this.ms_sDynFin)return u+this.ms_sDynFin.length;n.substr(u,this.ms_sDynSi.length)==this.ms_sDynSi?t=this.__nHTMLParseSi(n,u,i):n.substr(u,this.ms_sDynSinon.length)==this.ms_sDynSinon?(t+=u+this.ms_sDynSinon.length,i=r):t=this.__nHTMLParsePropriete(n,u,i)}};WDTableZRNavigateur.prototype.__nHTMLParseFixe=function(n,t,i,r){var u;return u=-1!=i?n.substring(t,i):n.substring(t),u.length>0&&r.push({vVersHTML:this.VersHTML_Fixe,m_sValeur:u}),t+u.length};WDTableZRNavigateur.prototype.__nHTMLParseSi=function(n,t,i){var r={vVersHTML:this.VersHTML_Condition,m_sValeur:"",m_bDifferent:!1,m_tabElementsHTMLSi:[],m_tabElementsHTMLSinon:[],m_oPropriete:null};t+=this.ms_sDynSi.length;var o=n.indexOf(this.ms_sDynAlors,t),f=n.substring(t,o),u=f.indexOf(this.ms_sConditionDifferent),e;return-1==u?(u=f.indexOf(this.ms_sConditionEgal),e=u+this.ms_sConditionEgal.length,r.m_bDifferent=!1):(e=u+this.ms_sConditionDifferent.length,r.m_bDifferent=!0),-1!=e&&(r.m_oPropriete=this.__oParsePropriete(f.substring(0,u)),r.m_sValeur=f.substring(e,o),i.push(r)),this.__nHTMLParseInterne(n,o+this.ms_sDynAlors.length,r.m_tabElementsHTMLSi,r.m_tabElementsHTMLSinon)};WDTableZRNavigateur.prototype.__nHTMLParsePropriete=function(n,t,i){t+=this.ms_sDynO.length;var r=n.indexOf(this.ms_sDynF,t);return i.push({vVersHTML:this.VersHTML_Propriete,m_oPropriete:this.__oParsePropriete(n.substring(t,r))}),r+this.ms_sDynF.length};WDTableZRNavigateur.prototype.ms_oMatchAttAuto=/^ATT_(\w+)_(\d+)$/;WDTableZRNavigateur.prototype.__oParsePropriete=function(n){var t={m_nColonne:undefined,m_oAttributAutomatique:undefined,m_ePropriete:this.XML_CHAMP_PROP_NUM_VALEUR,m_eConversion:undefined},f=n.indexOf(this.ms_sConversion),i,r,u;return-1!=f&&(t.m_eConversion=parseInt(n.substring(f+this.ms_sConversion.length),10),n=n.substring(0,f)),i=n.indexOf(this.ms_sPropriete),-1!=i&&(r=[],t.m_ePropriete=this.__eParsePPPropriete(n.substring(i+this.ms_sPropriete.length),r),r[0]!==undefined&&(t.m_oParametre=r[0]),n=n.substring(0,i)),u=n.match(this.ms_oMatchAttAuto),null!=u?t.m_oAttributAutomatique={m_sAliasChamp:u[1],m_ePropriete:parseInt(u[2],10)}:t.m_nColonne=this._nGetColonneSelonAlias(n),t};WDTableZRNavigateur.prototype.__eParsePPPropriete=function(n,t){switch(n){case"COULEUR":return this.XML_CHAMP_PROP_NUM_COULEUR;case"COULEURFOND":return this.XML_CHAMP_PROP_NUM_COULEURFOND;case"RUPTURELIGNE_DEBUT":return this.ms_nAttributRuptureLigneDebut;case"RUPTURELIGNE_FIN":return this.ms_nAttributRuptureLigneFin;case"LIGNEREPLIEE":return this.ms_nAttributLigneRepliee;case"LIGNEPAIRE":return this.ms_nAttributLignePaire;case"TRIABLE":return this.ms_nAttributTriable;case"RECHERCHABLE":return this.ms_nAttributRecherchable;case"SELECTED":return this.ms_nAttributSelected;case"DERNIEREVISIBLE":return this.ms_nAttributDerniereVisible;case this.ms_sCodeHTML32:return this.ms_nAttributCodeHTML32;default:return this.__bParsePPProprieteDouble(n,t,this.ms_sInclureHautRupture,!0)?this.ms_nAttributIncludeHautRupture:this.__bParsePPProprieteDouble(n,t,this.ms_sInclureBasRupture,!0)?this.ms_nAttributIncludeBasRupture:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML30,!0)?this.ms_nAttributCodeHTML30:this.__bParsePPProprieteDouble(n,t,this.ms_sCodeHTML31,!0)?this.ms_nAttributCodeHTML31:this.__bParsePPProprieteDouble(n,t,"EXISTE_",!1)?this.ms_nAttributExiste:this.XML_CHAMP_PROP_NUM_VALEUR}};WDTableZRNavigateur.prototype.__bParsePPProprieteDouble=function(n,t,i,r){if(n.substr(0,i.length)==i){var u=n.substr(i.length);return t[0]=r?parseInt(u,10):u,!0}return!1};WDTableZRNavigateur.prototype.__HTMLGenere=function(n,t,i,r,u){for(var e=r.length,f=0;f<e;f++)r[f].vVersHTML.apply(this,[n,t,i,r[f],u])};WDTableZRNavigateur.prototype.VersHTML_Fixe=function(n,t,i,r,u){u.push(r.m_sValeur)};WDTableZRNavigateur.prototype.VersHTML_Propriete=function(n,t,i,r,u){u.push(this.__sGetPropriete(n,t,i,r.m_oPropriete,!1))};WDTableZRNavigateur.prototype.VersHTML_Condition=function(n,t,i,r,u){var f=r.m_sValeur==this.__sGetPropriete(n,t,i,r.m_oPropriete,!0);(r.m_bDifferent?!f:f)?this.__HTMLGenere(n,t,i,r.m_tabElementsHTMLSi,u):r.m_tabElementsHTMLSinon&&this.__HTMLGenere(n,t,i,r.m_tabElementsHTMLSinon,u)};WDTableZRNavigateur.prototype.__sGetPropriete=function(n,t,i,r,u){var f,e=r.m_oAttributAutomatique,o;return e&&(o=this.__nGetAttributSelonChampEtPropriete(e.m_sAliasChamp,e.m_ePropriete),clWDUtil.nElementInconnu!=o?(r.m_oAttributAutomatique=undefined,r.m_nColonne=o):f=this.__oGetValeurDefautAttributAutomatique(e.m_sAliasChamp,e.m_ePropriete)),r.m_nColonne!==undefined?f=this.m_tabColonnes[r.m_nColonne].vsLitPropriete(this,r.m_nColonne,n,t,i,r.m_ePropriete,!0):undefined===f&&(f=this._vsLitPropriete(n,t,i,r.m_ePropriete,r.m_oParametre,u)),this.__sConversion(f,r.m_eConversion)};WDTableZRNavigateur.prototype.__sConversion=function(n,t){if(t!==undefined){var i;switch(t){case this.ms_nConversionPoliceGras:if(typeof n=="boolean")return n?"bold":"normal";break;case this.ms_nConversionPoliceItalique:if(typeof n=="boolean")return n?"italic":"normal";break;case this.ms_nConversionPoliceSouligne:if(typeof n=="boolean")return n?"underline":"none";break;case this.ms_nConversionPoliceTaille:if(typeof n=="string"&&(i=parseInt(n,10),i==n&&(n=i)),typeof n=="number"||0!=n)return n+"pt"}}return n};WDPopupSaisieTRF.prototype=new WDPopupSaisie;WDPopupSaisieTRF.prototype.constructor=WDPopupSaisieTRF;WDPopupSaisieTRF.prototype.__tabGetImagesRechercheFiltre=function(n){switch(n.m_nRecherche){default:case 1:case 2:case 3:return n.ms_nFiltreRecherche==n.nGetFiltre()?this.m_tabImages[1]:this.m_tabImages[2]}};WDPopupSaisieTRF.prototype.__AfficheImage=function(n,t,i,r){var u=this.__tabGetImagesRechercheFiltre(i);undefined!==t&&t===this.m_nColonneRecherche&&(r=2);n.src=u[r]};WDPopupSaisieTRF.prototype.__AjouteOnXxxSurImages=function(n,t,i,r,u){var f=this;t&&(t.onclick=i?function(t){f.OnOuvreMenuTRF(t||event,n,r,u)}:function(t){f.OnRechercheColonne(t||event,n,this)},t.onmouseover=function(){f.OnRechercheSurvol(n,this,1)},t.onmouseout=function(){f.OnRechercheSurvol(n,this,0)})};WDPopupSaisieTRF.prototype.__SupprimeOnXxxSurImages=function(n){n&&(n.onmouseout=null,n.onmouseover=null,n.onclick=null)};WDPopupSaisieTRF.prototype.__Debut=function(n,t,i,r,u){var f=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_FORMAT,i);this.Debut(n,t.parentNode,t.offsetWidth,r,u,f,[t,i])};WDPopupSaisieTRF.prototype.AjouteLienImages=function(n,t){for(var o=n.length,i=0;i<o;i++){var r=n[i],f=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_TRI,i),s=r.m_bTri;f&&clWDUtil.SetDisplay(f,s);var u=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,i),e=0<r.m_nRecherche,h=1<r.m_nRecherche;u&&(clWDUtil.SetDisplay(u,e),this.__AfficheImage(u,i,r,0));t||this.__AjouteOnXxxSurImages(i,e?u:null,h,r.bEstTexte(),r.bEstNumerique()||r.bEstDateHeure())}};WDPopupSaisieTRF.prototype.SupprimeLienImages=function(n){for(var i,t=0;t<n;t++)i=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,t),this.__SupprimeOnXxxSurImages(i)};WDPopupSaisieTRF.prototype.AfficheImageTri=function(n,t){var i=this.m_tabImages[0],r=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_TRI,n);r&&(r.src=undefined!==t?t?i[1]:i[2]:i[0])};WDPopupSaisieTRF.prototype._vDebut=function(n,t,i,r,u){WDPopupSaisie.prototype._vDebut.apply(this,arguments);var e=u[0],f=u[1];this.m_oImage=e;this.m_nColonneRecherche=f;this.__AfficheImage(e,f,this.m_oChampParent._oGetColonne(f),0)};WDPopupSaisieTRF.prototype._vValide=function(n,t){WDPopupSaisie.prototype._vValide.apply(this,arguments);this.__Valide(n,this.m_nColonneRecherche,t,!1)};WDPopupSaisieTRF.prototype.__Valide=function(n,t,i,r){var u=this.m_oChampParent._oGetColonne(t),f,e;r||(i=this.__ConversionMasqueModele(i,u.m_sAlias,!0));f=i+"";e=u.nGetFiltre();u.ms_nFiltreRecherche==e?f.length>0&&this.m_oChampParent.OnRecherche(n,t,i):f.length>0?this.m_oChampParent.OnFiltre(n,t,e,i):this.m_oChampParent.OnAnnuleFiltre(n,t)};WDPopupSaisieTRF.prototype._vAnnule=function(){var n,t;WDPopupSaisie.prototype._vAnnule.apply(this,arguments);n=this.m_oChampParent._oGetColonne(this.m_nColonneRecherche);this.m_nColonneRecherche=null;t=this.m_oImage;this.m_oImage=null;t&&n&&this.__AfficheImage(t,undefined,n,0)};WDPopupSaisieTRF.prototype.OnRechercheColonne=function(n,t,i){this.__Debut(n,i,t,!0,"")};WDPopupSaisieTRF.prototype.OnRechercheSurvol=function(n,t,i){this.__AfficheImage(t,n,this.m_oChampParent._oGetColonne(n),i)};WDPopupSaisieTRF.prototype.OnOuvreMenuTRF=function(n,t,i,r){WDMenuContextuelTRF.prototype.s_Ouvre(n,this,this.OnSaisieLoupe,t,i,r)};WDPopupSaisieTRF.prototype.OnSaisieLoupe=function(n,t,i,r){if(-1==i){this.__Valide(n,t,"",!0);return}this.m_oChampParent._oGetColonne(t).SetFiltre(i);var u=this.m_oChampParent.oGetIDElement(clWDTableDefs.ID_TITRE,clWDTableDefs.ID_RECHERCHE,t);this.__Debut(n,u,t,!1,r)};WDCelluleSaisie.prototype.ms_nColonneSuivante=-1;WDCelluleSaisie.prototype.ms_nColonnePrecedente=-2;WDCelluleSaisie.prototype.ms_nSaisieSans=0;WDCelluleSaisie.prototype.ms_nSaisieEnCours=1;WDCelluleSaisie.prototype.ms_nSaisieSansDocument=2;WDCelluleSaisie.prototype.ms_nContinueSaisieSans=0;WDCelluleSaisie.prototype.ms_nContinueSaisieLigneCourante=1;WDCelluleSaisie.prototype.ms_nContinueSaisieLignePrecedente=2;WDCelluleSaisie.prototype.ms_nContinueSaisieLigneSuivante=3;WDCelluleSaisie.prototype.bSaisieEnCours=function(n){switch(this.__eGetSaisieEnCours(n)){case this.ms_nSaisieSans:return!1;case this.ms_nSaisieEnCours:return!0;case this.ms_nSaisieSansDocument:return this.SaisieFin(!1,!1,WDTableZRNavigateur.prototype.ms_nColonneInvalide,null),!1}};WDCelluleSaisie.prototype.bSaisieEnCoursDansCellule=function(n,t){return this.bSaisieEnCours()&&n==this.m_nLigne&&t==this.m_nColonne};WDCelluleSaisie.prototype.OnMAJDonnees=function(n){this.m_bEntreEnSaisieSurProchainAffichage&&(this._vPrepareSaisieForceSurMAJDonnees(),this.OnClickCellule(this.m_nLigne,this.m_nColonne,!1,n))};WDCelluleSaisie.prototype.OnClickCellule=function(n,t,i,r){this.m_bEntreEnSaisieSurProchainAffichage=!1;switch(this.m_oChampTable.eColonneTypeIDObjet(t)){case WDChamp.prototype.ms_nIDObjetInterrupteur:case WDChamp.prototype.ms_nIDObjetImage:this.bSaisieEnCours()&&this.SaisieFin(!0,!1,undefined,r);return}switch(this.__eGetSaisieEnCours(!1)){case this.ms_nSaisieEnCours:if(this.m_nLigne==n&&this.m_nColonne==t)return;case this.ms_nSaisieSansDocument:this.m_nLigne==n?this.SaisieFin(!0,!0,t,r):this.SaisieFin(!0,!1,undefined,r);return}var u=this._vbSaisieCommence(n,t,i);this._vSetEtat(n,t);u&&this.SaisieCommence(r)};WDCelluleSaisie.prototype.SaisieCommence=function(n){var s,h,r,a,u,t,v,l,f,y,e,c,i,o;if(!this.bSaisieEnCours(!0)){if(this.__ClearOnDblClick(),!this.m_oChampTable.bColonneSaisissable(this.m_nColonne)||!this._vbCreeLigneVirtuelle()){this._vClearEtat();return}s=this._voGetCellule();switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetInterrupteur:h=s.getElementsByTagName("input")[0];clWDUtil.AttacheDetacheEvent(!0,h,"keydown",this.m_pfOnKeyDown);clWDUtil.DonneFocus(h);this.__bOnXxxPourCodeNav(n,h,WDChamp.prototype.ms_nEventNavFocus,"focus");return}r=document.createElement("form");r.method="post";r.action="javascript:return false;";a=this._vnGetHauteurLigne();u=a-(bIEQuirks?4:0);r.style.width="100%";r.style.height=u+"px";switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetCombo:for(v=this.m_oChampTable.nGetValeurCellule(this.m_nLigne,this.m_nColonne),t=document.createElement("select"),l=this.m_oChampTable.tabContenuCellule(this.m_nLigne,this.m_nColonne),y=l.length,f=0;f<y;f++)e=document.createElement("option"),e=t.appendChild(e),e.innerHTML=clWDUtil.sEncodeInnerHTML(l[f],!1,!0),e.value=f,v==f&&(e.selected=!0);break;case WDChamp.prototype.ms_nIDObjetSaisie:default:c=this.m_oChampTable.sGetValeurCellule(this.m_nLigne,this.m_nColonne)+"";-1!=c.indexOf("\r")||-1!=c.indexOf("\n")?t=document.createElement("textarea"):(t=document.createElement("input"),t.type="text");t.value=c;this.__SetMasqueModele(t,this.m_oChampTable.oGetIDElement(clWDTableDefs.ID_FORMAT,this.m_nColonne))}for(i=s;clWDUtil.bBaliseEstTag(i,"div")&&i.style.backgroundColor=="";)i=i.parentNode;o=clWDUtil.oGetCurrentStyle(i);t.style.width="100%";t.style.height=u+"px";t.style.borderWidth="0";t.style.borderStyle="solid";t.style.borderColor=o.backgroundColor;t.style.fontFamily=o.fontFamily;t.style.fontWeight=o.fontWeight;t.style.fontStyle=o.fontStyle;t.style.fontSize=o.fontSize;u<=18&&u>0&&(t.style.fontSize=Math.max(u-4,6)+"px");clWDUtil.SupprimeFils(s);r.appendChild(t);this.m_oFormulaire=s.appendChild(r);this.m_oSaisie=this.m_oFormulaire.elements[0];clWDUtil.AttacheDetacheEvent(!0,this.m_oFormulaire,"submit",this.m_pfOnSubmit);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"blur",this.m_pfOnBlur);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"keydown",this.m_pfOnKeyDown);clWDUtil.AttacheDetacheEvent(!0,this.m_oSaisie,"change",this.m_pfOnChange);this.m_fOldClick=i.onclick;i.onclick=null;this.m_oParentTable=i;clWDUtil.DonneFocus(this.m_oSaisie);this.__bOnXxxPourCodeNav(n,this.m_oSaisie,WDChamp.prototype.ms_nEventNavFocus,"focus")}};WDCelluleSaisie.prototype.SaisieFin=function(n,t,i,r){var h,o,s;this.__ClearOnDblClick();switch(this.__eGetSaisieEnCours(!1)){case this.ms_nSaisieSansDocument:case this.ms_nSaisieEnCours:if(n&&!1!==this.__bValideMasqueModele(r)){var f="",e=-1,c=this.m_oChampTable._oGetColonne(this.m_nColonne),u;switch(this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)){case WDChamp.prototype.ms_nIDObjetCombo:h=this.m_oSaisie.value;e=parseInt(h,10);f=this.m_oChampTable.tabContenuCellule(this.m_nLigne,this.m_nColonne)[e];break;case WDChamp.prototype.ms_nIDObjetInterrupteur:u=this._voGetCellule().getElementsByTagName("input")[0];e=u.checked?1:0;f=u.checked?"1":"0";break;case WDChamp.prototype.ms_nIDObjetSaisie:default:f=this.__ConversionMasqueModele(this.m_oSaisie.value,c.m_sAlias,this._vbAvecMasqueModele())}if(this.m_oChampTable.SetValeurCellule(this.m_nLigne,this.m_nColonne,f,e),t)switch(i){case this.ms_nColonnePrecedente:i=this.__nGetColonneSaisieSuivante(i,-1,clWDUtil.s_bSuperieurOuEgal,0);break;case this.ms_nColonneSuivante:i=this.__nGetColonneSaisieSuivante(i,1,clWDUtil.s_bInferieur,this.m_oChampTable._nGetNbColonnes())}}u&&clWDUtil.AttacheDetacheEvent(!1,u,"keydown",this.m_pfOnKeyDown);this.m_oSaisie&&(clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"change",this.m_pfOnChange),clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"keydown",this.m_pfOnKeyDown),clWDUtil.AttacheDetacheEvent(!1,this.m_oSaisie,"blur",this.m_pfOnBlur),clWDUtil.bHTMLVideDepuisVariable(this,"m_oSaisie"));this.m_oFormulaire&&(clWDUtil.AttacheDetacheEvent(!1,this.m_oFormulaire,"submit",this.m_pfOnSubmit),clWDUtil.bHTMLVideDepuisVariable(this,"m_oFormulaire"));this.m_oParentTable&&(this.m_oParentTable.onclick=this.m_fOldClick,this.m_fOldClick=null,this.m_oParentTable=null);this.__ClearMasqueModele();o=this.__nContinueSaisie(t,i);s=this._vbMAJLigne(n&&this.ms_nContinueSaisieLigneCourante!=o);switch(o){case this.ms_nContinueSaisieSans:this._vClearEtat();break;case this.ms_nContinueSaisieLigneCourante:this.m_nColonne=i;this.SaisieCommence(r);return;case this.ms_nContinueSaisieLignePrecedente:this.__PrepareSaisieLigneAutre(r,-1,this.m_oChampTable._nGetNbColonnes(),clWDUtil.s_bSuperieurOuEgal,0,s);break;case this.ms_nContinueSaisieLigneSuivante:this.__PrepareSaisieLigneAutre(r,1,-1,clWDUtil.s_bInferieur,this.m_oChampTable._nGetNbColonnes(),s)}}this._vSupprimeLignesVirtuelles()};WDCelluleSaisie.prototype.bDetacheFormulaire=function(){return this.bSaisieEnCours()&&this.m_oFormulaire?(this.m_oFormulaire=this.m_oFormulaire.parentNode.removeChild(this.m_oFormulaire),!0):!1};WDCelluleSaisie.prototype.AttacheFormulaire=function(n){if(n){var t=this._voGetCellule();clWDUtil.SupprimeFils(t);this.m_oFormulaire=t.appendChild(this.m_oFormulaire)}};WDCelluleSaisie.prototype._vPrepareSaisieForceSurMAJDonnees=function(){};WDCelluleSaisie.prototype._vbSaisieCommence=function(n,t,i){return this.m_oChampTable.m_oSelection.bGetLigneEstSelectionnee(n)&&!i};WDCelluleSaisie.prototype._voGetCellule=function(){var n=this.m_oChampTable.oGetIDCelluleRel(this.m_nLigne,this.m_nColonne);return n?n.parentNode.parentNode:null};WDCelluleSaisie.prototype._vSetEtat=function(n,t){WDTableZRNavigateur.prototype.ms_nLigneInvalide!=this.m_nLigne&&WDTableZRNavigateur.prototype.ms_nColonneInvalide!=this.m_nColonne&&this.__ClearOnDblClick();this.m_nLigne=n;this.m_nColonne=t;this.__SetOnDblClick()};WDCelluleSaisie.prototype._vClearEtat=function(){this.m_nLigne=WDTableZRNavigateur.prototype.ms_nLigneInvalide;this.m_nColonne=WDTableZRNavigateur.prototype.ms_nColonneInvalide};WDCelluleSaisie.prototype._vnGetHauteurLigne=function(){return this._voGetCellule().clientHeight};WDCelluleSaisie.prototype._vbMAJLigne=function(){return this.m_oChampTable.__OnLigneModification(this.m_nLigne),!0};WDCelluleSaisie.prototype._vbCreeLigneVirtuelle=clWDUtil.m_pfVide;WDCelluleSaisie.prototype._vSupprimeLignesVirtuelles=clWDUtil.m_pfVide;WDCelluleSaisie.prototype._vbAvecMasqueModele=clWDUtil.m_pfVide;WDCelluleSaisie.prototype.__nGetColonneSaisieSuivante=function(n,t,i,r){for(var u=this.m_nColonne+t;i(u,r);u+=t)if(this.m_oChampTable.bColonneSaisissable(u))return u;return n};WDCelluleSaisie.prototype.__PrepareSaisieLigneAutre=function(n,t,i,r,u,f){var o=this.m_nLigne+t,e;this._vClearEtat();this.m_nLigne=o;this.m_nColonne=i;this.m_nColonne=this.__nGetColonneSaisieSuivante(-1,t,r,u);-1!=this.m_nColonne&&(this.m_bEntreEnSaisieSurProchainAffichage=!0);f||(e=this,clWDUtil.nSetTimeout(function(){e.OnMAJDonnees()},clWDUtil.ms_oTimeoutImmediat))};WDCelluleSaisie.prototype.__eGetSaisieEnCours=function(n){return this.m_oFormulaire?clWDUtil.bEstDansDocument(this.m_oFormulaire)?this.ms_nSaisieEnCours:this.ms_nSaisieSansDocument:!n&&0<=this.m_nColonne&&WDChamp.prototype.ms_nIDObjetInterrupteur==this.m_oChampTable.eColonneTypeIDObjet(this.m_nColonne)?this.ms_nSaisieEnCours:this.ms_nSaisieSans};bIEQuirks?(WDCelluleSaisie.prototype.__SetOnDblClick=function(){var n=this._voGetCellule(),t;n&&(this.m_pfOnDblClick||(t=this,this.m_pfOnDblClick=function(n){t.SaisieCommence(n||event)}),n.ondblclick=this.m_pfOnDblClick)},WDCelluleSaisie.prototype.__ClearOnDblClick=function(){var n=this._voGetCellule();n&&(n.ondblclick=null)}):(WDCelluleSaisie.prototype.__SetOnDblClick=clWDUtil.m_pfVide,WDCelluleSaisie.prototype.__ClearOnDblClick=clWDUtil.m_pfVide);WDCelluleSaisie.prototype.__bOnSubmit=function(n){return this.SaisieFin(!0,!0,this.ms_nColonneSuivante,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnBlur=function(n){var t=clWDUtil.oGetTarget(n);return this.__bOnXxxPourCodeNav(n,t,WDChamp.prototype.ms_nEventNavBlur,"blur"),this.SaisieFin(!0,!1,undefined,n),clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnKeyDown=function(n){var t=clWDUtil.oGetTarget(n);switch(n.keyCode){case 9:this.SaisieFin(!0,!0,n.shiftKey?this.ms_nColonnePrecedente:this.ms_nColonneSuivante,n);break;case 27:this.SaisieFin(!1,undefined,undefined,n);break;case 37:if(this.__bOnFlecheGaucheDroite(n,t,!1))this.SaisieFin(!0,!0,this.ms_nColonnePrecedente,n);else return!0;break;case 39:if(this.__bOnFlecheGaucheDroite(n,t,!0))this.SaisieFin(!0,!0,this.ms_nColonneSuivante,n);else return!0;break;default:return!0}return clWDUtil.bStopPropagation(n)};WDCelluleSaisie.prototype.__bOnChange=function(n){var i=clWDUtil.oGetTarget(n),r=!1===this.__bOnXxxPourCodeNav(n,i,WDChamp.prototype.ms_nEventNavChange,"change"),t;if(clWDUtil.bBaliseEstTag(i,"select")){if(t=n.keyCode,undefined!==t)switch(t){case 9:this.SaisieFin(!0,!0,n.shiftKey?this.ms_nColonnePrecedente:this.ms_nColonneSuivante,n);break;default:return r}return clWDUtil.bStopPropagation(n)}return r};WDCelluleSaisie.prototype.__bOnFlecheGaucheDroite=function(n,t,i){switch(clWDUtil.sGetTagName(t)){case"input":switch(t.type.toLowerCase()){case"checkbox":return!0;case"text":var r=this.__nGetCurseur(n,t,i);return!i&&r==0||i&&r==t.value.length}break;case"select":return!0}return!1};WDCelluleSaisie.prototype.__nGetCurseur=function(n,t,i){var f=i?t.selectionEnd:t.selectionStart,u,r;return typeof f=="number"?f:(u=document.selection.createRange(),r=t.value.length,i?r-u.moveEnd("character",r):-u.moveStart("character",-r))};WDCelluleSaisie.prototype.__bOnXxxPourCodeNav=function(n,t,i,r){var f=t.parentNode.parentNode["on"+r],u;return f?f(n):(u=this.m_oChampTable._oGetColonne(this.m_nColonne),u&&this.m_oChampTable.__oAppelPCodeSurLigne&&this.m_oChampTable.__oAppelPCodeSurLigne(this.m_nLigne,u.m_oPCodes.RecuperePCode(i),n),!0)};WDCelluleSaisie.prototype.__nContinueSaisie=function(n,t){if(n)switch(t){case this.ms_nColonnePrecedente:return 0<this.m_nLigne?this.ms_nContinueSaisieLignePrecedente:this.ms_nContinueSaisieSans;case this.ms_nColonneSuivante:return this.ms_nContinueSaisieLigneSuivante;case undefined:return this.ms_nContinueSaisieSans;default:return this.m_oChampTable.bColonneSaisissable(t)?this.ms_nContinueSaisieLigneCourante:this.ms_nContinueSaisieSans}else return this.ms_nContinueSaisieSans};WDCelluleSaisie.prototype.__SetMasqueModele=WDPopupSaisie.prototype.__SetMasqueModele;WDCelluleSaisie.prototype.__bValideMasqueModele=WDPopupSaisie.prototype.__bValideMasqueModele;WDCelluleSaisie.prototype.__ClearMasqueModele=WDPopupSaisie.prototype.__ClearMasqueModele;WDCelluleSaisie.prototype.__ConversionMasqueModele=WDPopupSaisie.prototype.__ConversionMasqueModele;WDMenuContextuelExport.prototype=new WDMenuContextuel;WDMenuContextuelExport.prototype.constructor=WDMenuContextuelExport;WDMenuContextuelExport.prototype.ms_sNomTraductions="TABLE_EXPORT";WDMenuContextuelExport.prototype.ms_tabOptions=[{m_sExtension:"xls",m_sCommande:"EXPORTXLS",m_oLibelle:{m_sTraduction:"EXCEL",sLibelle:"Exporter vers Excel...",sTitre:"Exporter le contenu vers Excel..."}},{m_sExtension:"rtf",m_sCommande:"EXPORTRTF",m_oLibelle:{m_sTraduction:"WORD",sLibelle:"Exporter vers Word...",sTitre:"xporter le contenu vers Word..."}},{m_sExtension:"xml",m_sCommande:"EXPORTXML",m_oLibelle:{m_sTraduction:"XML",sLibelle:"Exporter vers XML...",sTitre:"Exporter le contenu vers XML..."}},{m_sExtension:"pdf",m_sCommande:"EXPORTPDF",m_oLibelle:{m_sTraduction:"PDF",sLibelle:"Imprimer en PDF...",sTitre:"Imprimer vers un fichier PDF..."}}];WDMenuContextuelExport.prototype._vAction=function(n,t){_JCL(_PU_+(window._WDR_?"":"/export."+t.m_sExtension)+"?WD_ACTION_="+t.m_sCommande+"&"+this.m_sAliasChamp,bFF?"_blank":"_self","","")};WDMenuContextuelExport.prototype._vbFiltre=clWDUtil.m_pfVide;WDMenuContextuel.prototype.s_OuvreExport=function(n,t){new WDMenuContextuelExport(n,t)};WDMenuContextuelTRF.prototype=new WDMenuContextuel;WDMenuContextuelTRF.prototype.constructor=WDMenuContextuelTRF;WDMenuContextuelTRF.prototype.ms_sNomTraductions="TABLE_FILTRE";WDMenuContextuelTRF.prototype.ms_tabOptions=[{m_nFiltre:0,m_oLibelle:{m_sTraduction:"RECHERCHE",sLibelle:"Rechercher"},m_sImage:"TableCherche.gif",m_bSeparateur:!0},{m_oLibelle:{m_sTraduction:"FILTRE",sLibelle:"Filtres :"},m_sImage:"TableFiltre.gif",m_bInactif:!0},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreEgal,m_bTexte:!0,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_EGAL",sLibelle:"Est \ufffdgal \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreCommencePar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_COMMENCE",sLibelle:"Commence par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreContient,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_CONTIENT",sLibelle:"Contient"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreTerminePar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_TERMINE",sLibelle:"Se termine par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreDifferent,m_bTexte:!0,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_DIFFERENT",sLibelle:"Est diff\u00e9rent de"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeCommencePasPar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_COMMENCE_PAS",sLibelle:"Ne commence pas par"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeContientPas,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_CONTIENT_PAS",sLibelle:"Ne contient pas"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreNeTerminePasPar,m_bTexte:!0,m_oLibelle:{m_sTraduction:"FILTRE_TERMINE_PAS",sLibelle:"Ne se termine pas par"},m_bSeparateur:!0},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreSuperieur,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_SUPERIEUR",sLibelle:"Sup\u00e9rieur \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreSuperieurOuEgal,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_SUPERIEUR_EGAL",sLibelle:"Sup\u00e9rieur ou \u00e9gal \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreInferieur,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_INFERIEUR",sLibelle:"Inf\u00e9rieur \u00e0"}},{m_nFiltre:WDTableColonne.prototype.ms_nFiltreInferieurOuEgal,m_bNumDateHeure:!0,m_oLibelle:{m_sTraduction:"FILTRE_INFERIEUR_EGAL",sLibelle:"Inf\u00e9rieur ou \u00e9gal \u00e0"},m_bSeparateur:!0},{m_nFiltre:-1,m_oLibelle:{m_sTraduction:"FILTRE_SUPPRIME",sLibelle:"Supprimer le filtre"},m_sImage:"TableFiltre.gif"}];WDMenuContextuelTRF.prototype._vAction=function(n,t){this.m_pfAction.apply(this.m_oGestionnaire,[n,this.m_nColonne,t.m_nFiltre,""])};WDMenuContextuelTRF.prototype.s_Ouvre=function(n,t,i,r,u,f){new WDMenuContextuelTRF(n,t,i,r,u,f)};WDSelection.prototype.ms_nSelectionSans=0;WDSelection.prototype.ms_nSelectionSimple=1;WDSelection.prototype.ms_nSelectionMultiple=2;WDSelection.prototype.ms_nTsLigne=0;WDSelection.prototype.ms_nTsCellule=2;WDSelection.prototype.ms_nTsLigneCellule=10;WDSelection.prototype.ms_nTsColonneCellule=11;WDSelection.prototype.ms_nLigneInvalide=WDTableZRNavigateur.prototype.ms_nLigneInvalide;WDSelection.prototype.Init=function(){this._MAJValeurChampFormulaire()};WDSelection.prototype._MAJValeurChampFormulaire=function(){this.m_oChampTable.m_oChampFormulaire.value=this.m_oChampTable._nLigneLigneWL(this.nGetSelection())};WDSelection.prototype._OnChangementSelection=function(n,t,i){this._MAJValeurChampFormulaire();this.m_oChampTable.OnChangementSelection(n,t,i)};WDSelection.prototype.nGetSelection=function(){return undefined!==this.m_nForceSelection?this.m_nForceSelection:this.m_tabSelection.length?this.m_tabSelection[0].m_nLigne:this.ms_nLigneInvalide};WDSelection.prototype.nGetForceSelection=function(){return this.m_nForceSelection};WDSelection.prototype.ForceSelection=function(n){this.m_nForceSelection=n};WDSelection.prototype.ReinitSelection=function(n){this.SetModeSelection(this.ms_nTsLigne,!0);this.ms_nSelectionSans!=this.m_nTypeSelection&&this.SelectPlusDirect(n,!0,null)};WDSelection.prototype.ReinitSelectionSansReselection=function(n){this.ms_nTsLigne==this.m_nModeSelection&&1==this.m_tabSelection.length&&this.bGetLigneEstSelectionnee(n)||this.ReinitSelection(n)};WDSelection.prototype.SetModeSelection=function(n,t){(n!=this.m_nModeSelection||t)&&this.bSelectAucun();this.m_nModeSelection=n};WDSelection.prototype.bGetLigneEstSelectionnee=function(n){return clWDUtil.nElementInconnu!=this._nGetRangLigneSelection(n)};WDSelection.prototype._nGetRangLigneSelection=function(n){return clWDUtil.nDansTableauFct(this.m_tabSelection,this.__s_nCompareSelectionLigne,n)};WDSelection.prototype.__s_nCompareSelectionLigne=function(n,t){return n.m_nLigne==t};WDSelection.prototype.xnSelectOccurrence=function(n){switch(n){default:throw new WDErreur(303,n);case this.ms_nTsLigne:case this.ms_nTsCellule:return this.m_nModeSelection==n?this.m_tabSelection.length:0}};WDSelection.prototype.xnSelect=function(n,t){var i,u,r;switch(t){default:i=t;break;case this.ms_nTsLigneCellule:case this.ms_nTsColonneCellule:i=this.ms_nTsCellule}if(u=this.xnSelectOccurrence(i),n<0||u<=n||this.m_nModeSelection!=t)return this.ms_nLigneInvalide;r=this.m_tabSelection[n];switch(t){default:return r.m_nLigne;case this.ms_nTsColonneCellule:return r.m_nColonne}};WDSelection.prototype.xSelectPlusMoins=function(n,t,i){if(this.ms_nTsLigne==this.m_nModeSelection)if(i.length)for(var u=i.length,r=0;r<u;r++)n.apply(this,[i[r]]);else t.apply(this,[null])};WDSelection.prototype.bSelectMoins=function(n){for(var t=!1,i;clWDUtil.nElementInconnu!=(i=this._nGetRangLigneSelection(n));)this._SelectMoinsRang(i,null),t=!0;return t};WDSelection.prototype._SelectMoinsRang=function(n,t){var i=this.m_tabSelection.splice(n,1)[0];this._OnChangementSelection(i.m_nLigne,!1,t)};WDSelection.prototype.bSelectPlus=function(n,t,i){return this.bGetLigneEstSelectionnee(n)?!1:(this.SelectPlusDirect(n,t,i),!0)};WDSelection.prototype.SelectPlusDirect=function(n,t,i){this.ms_nSelectionMultiple!=this.m_nTypeSelection&&this.bSelectAucun(i);var r={m_nLigne:n};return this.m_tabSelection.push(r),this._OnChangementSelection(n,t,i),!0};WDSelection.prototype.bSelectAucun=function(n,t){for(var r=!1,u=this.m_tabSelection,i=0;i<u.length;)t!=u[i].m_nLigne?(this._SelectMoinsRang(i,n),r=!0):i++;return r};WDSelection.prototype.SelectTous=function(n){if(this.ms_nSelectionMultiple==this.m_nTypeSelection)for(var i=this.m_oChampTable._nGetNbLignes(),t=0;t<i;t++)this.bSelectPlus(t,!1,n)};WDSelection.prototype.OnLigneInsere=function(n){1==this.m_oChampTable._nGetNbLignes()?this.ReinitSelection(0):clWDUtil.bForEach(this.m_tabSelection,function(t){return n<=t.m_nLigne&&t.m_nLigne++,!0})};WDSelection.prototype.OnLigneSupprime=function(n){var i=this.bSelectMoins(n),t;clWDUtil.bForEach(this.m_tabSelection,function(t){return n<t.m_nLigne&&t.m_nLigne--,!0});i&&this.ms_nSelectionSimple==this.m_nTypeSelection&&(t=this.m_oChampTable.nGetLigneAfficheeAutour(n),this.ms_nLigneInvalide!=t&&this.bSelectPlus(t,!0))};WDSelection.prototype.OnLigneDeplace=function(n,t,i){var f,e,o,u,s,r;if(i)f=this._nGetRangLigneSelection(n),e=this._nGetRangLigneSelection(t),clWDUtil.nElementInconnu!=f&&(this.m_tabSelection[f].m_nLigne=t),clWDUtil.nElementInconnu!=e&&(this.m_tabSelection[e].m_nLigne=n);else for(o=this.m_tabSelection,s=o.length,u=0;u<s;u++)r=o[u],r.m_nLigne==n&&(r.m_nLigne=t),n<r.m_nLigne&&r.m_nLigne<t?r.m_nLigne--:t<=r.m_nLigne&&r.m_nLigne<n&&r.m_nLigne++};WDSelection.prototype.OnSelectLigne=function(n,t,i,r){var h;if(this.ms_nSelectionSans!=this.m_nTypeSelection&&undefined!==n&&this.m_oChampTable.m_oCelluleSaisie&&!this.m_oChampTable.m_oCelluleSaisie.bSaisieEnCoursDansCellule(n,t)){var e=i&&!r?i.ctrlKey:!1,o=i&&!r?i.shiftKey:!1,u=!1,s=this.m_nTypeSelection==WDSelection.prototype.ms_nSelectionSimple||r;if(!s&&(e||o)||(u|=this.bSelectAucun(i,n)),clWDUtil.nElementInconnu!=(h=this._nGetRangLigneSelection(n)))e&&(this._SelectMoinsRang(h,i),u=!0),r&&(u|=this.bSelectPlus(n,!0,i));else{if(!s&&o&&this.m_tabSelection.length){var f=this.m_tabSelection[0].m_nLigne,c=f<n?1:-1,l=this.m_oChampTable.m_tabLignes;for(f+=c;f!=n;f+=c)l[n].bGetVerifieFiltre()&&(u|=this.bSelectPlus(f,!0,i))}u|=this.bSelectPlus(n,!0,i)}this.m_oChampTable.m_oCelluleSaisie&&this.m_oChampTable.m_oCelluleSaisie.OnClickCellule(n,t,u,i)}};WDAffichageColonnes.prototype=new WDDrag;WDAffichageColonnes.prototype.constructor=WDAffichageColonnes;WDAffichageColonnes.prototype.Init=function(n){var i=this.m_tabPositionAffichage,r,t,f,u;for(i.length&&(this.LibereTitres(),i.length=0),i.length=n.length,f=n.length,t=0;t<f;t++)r=n[t],u=this.m_oChampTable.oGetIDElement(clWDTableDefs.ID_TITRE,t),i[r.m_nPositionAffichage]={m_oColonne:r,m_oTitreColonne:u,m_oDeplace:new WDDnDColonne(this,r,u)}};WDAffichageColonnes.prototype.InitTitres=function(){for(var r=this.m_tabPositionAffichage,e=r.length,u=!1,n=0;n<e;n++){var t=r[n],f=t.m_oColonne,i=this.m_oChampTable.oGetIDElement(clWDTableDefs.ID_TITRE,f.m_nRangCreation);t.m_oTitreColonne=i;i&&t.m_oDeplace._InitElement(i);u&=undefined!==f.m_nLargeur}u&&this.__FigeColonnes()};WDAffichageColonnes.prototype.LibereTitres=function(){for(var r=this.m_tabPositionAffichage,u=r.length,t,i,n=0;n<u;n++)t=r[n],i=t.m_oTitreColonne,i&&t.m_oDeplace._LibereElement(i)};WDAffichageColonnes.prototype.DeplaceColonne=function(n,t){var r,u,f,i;if(n.bColonneDeplace()&&(r=n.m_nPositionAffichage,t!=r)){if(u=this.m_tabPositionAffichage,f=u.splice(r,1)[0],u.splice(t,0,f),f.m_oColonne.m_nPositionAffichage=t,r<t)for(i=r;i<t;i++)u[i].m_oColonne.m_nPositionAffichage--;else for(i=t+1;i<=r;i++)u[i].m_oColonne.m_nPositionAffichage++;this.m_oChampTable.ChangeOrdreColonne(!0,n)}};WDAffichageColonnes.prototype.nGetPositionAffichageValide=function(n,t){for(var i=this.m_tabPositionAffichage,r=i.length;0<=n&&n<r;n+=t)if(i[n].m_oColonne.m_bVisible)return n;return undefined};WDAffichageColonnes.prototype.oGetColonneInvisible=function(n){var i=this.m_tabPositionAffichage,r=i.length,t;return 0<=n&&n<r&&(t=i[n].m_oColonne,!t.m_bVisible)?t:null};WDAffichageColonnes.prototype.bDerniereColonneVisible=function(n){var t=this.m_tabPositionAffichage,i;if(t[n].m_oColonne.m_bAjustable)return!1;for(i=t.length;n<i;n++)if(t[n].m_oColonne.m_bVisible)return!1;return!0};WDAffichageColonnes.prototype.ColonnesRestaure=function(){this.__bRedimEffectue()&&(this.m_oStyleCacheLargeur.CreationAjout(),this.__RestaureLargeurColonnes_StyleEnCreation(this.m_tabColonnesTaille),this.m_oStyleCacheLargeur.CreationFin(),this.m_oChampTable.m_oHote.style.width=this.m_sTableTaille,this.m_oChampTable.m_oTitrePosPixel&&(this.m_oChampTable.m_oTitrePosPixel.style.width=this.m_sTableTitreTaille),this.m_tabColonnesTaille=null,this.m_sTableTaille=null,this.m_sTableTitreTaille=null)};WDAffichageColonnes.prototype._vbOnMouseDown=function(n,t,i){return(this.m_oChampTable._oGetColonne(t).m_nLargeur=this.m_oChampTable.oGetIDCelluleRel(0,t).parentNode.offsetWidth,!WDDrag.prototype._vbOnMouseDown.apply(this,[n]))?!1:(this.__bRedimEffectue()||(this.m_oStyleCacheLargeur.CreationAjout(),this.__ColonnesFige_StyleEnCreation(),this.m_oStyleCacheLargeur.CreationFin()),this.m_oColonne=this.m_oChampTable._oGetColonne(t),this.m_nLargeurOriginale=this.m_oChampTable.oGetIDCelluleRel(0,t).parentNode.offsetWidth,this.m_nLargeurMinimale=i,!0)};WDAffichageColonnes.prototype._vOnMouseMove=function(n){var t,i;WDDrag.prototype._vOnMouseMove.apply(this,arguments);t=this.nGetOffsetPosX(n)+this.m_nLargeurOriginale;t<8&&(t=8);this.m_nLargeurMinimale!=-1&&t<this.m_nLargeurMinimale&&(t=this.m_nLargeurMinimale);this.m_oColonne.m_nLargeur=t;this.m_oStyleCacheLargeur.CreationAjout();this.__SetDimColonne(this.m_oColonne,t);this.m_oStyleCacheLargeur.CreationFin();this.m_oChampTable.bMAJNbLignesVisibles&&this.m_oChampTable.bMAJNbLignesVisibles(!0,!0)&&(this.m_oStyleCacheLargeur.CreationAjout(),i=this.__tabSauveLargeurColonnes_StyleEnCreation(!1),this.m_oStyleCacheLargeur.CreationFin(),this.m_oChampTable.bMAJNbLignesVisibles(!0,!1)&&(this.m_oStyleCacheLargeur.CreationAjout(),this.__RestaureLargeurColonnes_StyleEnCreation(i),this.m_oStyleCacheLargeur.CreationFin()));bIE&&!clWDUtil.bHTML5&&(this.m_oChampTable.m_oHote.className+="",this.m_oChampTable.m_oTitrePosPixel.className+="")};WDAffichageColonnes.prototype._vOnMouseUp=function(){this.m_nLargeurMinimale=null;this.m_nLargeurOriginale=null;this.m_oColonne=null;WDDrag.prototype._vOnMouseUp.apply(this,arguments)};WDAffichageColonnes.prototype.__tabSauveLargeurColonnes_StyleEnCreation=function(n){for(var f=[],i=0,t=this.m_oChampTable.oGetIDCelluleRel(0,i),o=this.m_oChampTable._nGetNbColonnes(),r,e,u;t||i<o;){if(t){while(!clWDUtil.bBaliseEstTag(t,"td"))t=t.parentNode;r=clWDUtil.oGetCurrentStyle(t);e=r.visibility;(e=="visible"||e=="inherit")&&r.display!="none"&&((clWDUtil.oGetCurrentStyle(t).width+"").indexOf("%")==-1&&n||(u=t.offsetWidth,bIEQuirks||(u-=WDChamp.prototype.s_nGetOffsetBorderPourWidth(r)),n?(f[i]=clWDUtil.oGetCurrentStyle(t).width,this.__SetDimColonne(this.m_oChampTable._oGetColonne(i),u)):f[i]=u))}i++;t=this.m_oChampTable.oGetIDCelluleRel(0,i)}return f};WDAffichageColonnes.prototype.__RestaureLargeurColonnes_StyleEnCreation=function(n){for(var i=n.length,t=0;t<i;t++)n[t]!==undefined&&this.__SetDimColonne(this.m_oChampTable._oGetColonne(t),n[t])};WDAffichageColonnes.prototype.__bRedimEffectue=function(){return!!this.m_tabColonnesTaille};WDAffichageColonnes.prototype.__ColonnesFige_StyleEnCreation=function(){var n=this.m_oChampTable.m_oHote,t=this.m_oChampTable.m_oTitrePosPixel;this.m_sTableTaille=n.style.width;t&&(this.m_sTableTitreTaille=t.style.width);this.m_tabColonnesTaille=this.__tabSauveLargeurColonnes_StyleEnCreation(!0);n.style.width="";t&&(t.style.width="");clWDUtil.bHTML5||(n.width&&""!=n.width&&(n.width=""),n.parentNode.style.width&&""!=n.parentNode.style.width&&(n.parentNode.style.width=""),t&&t.width&&""!=t.width&&(t.width=""))};WDAffichageColonnes.prototype.__SetDimColonne=function(n,t){var i=(t+"").indexOf("%")!=-1?"":"px";this.m_oStyleCacheLargeur.Ajoute(this.m_sPrefixe+n.m_sAlias,["width:"+t+i])};WDDnDColonne.prototype=new WDDnDNatif;WDDnDColonne.prototype.constructor=WDDnDColonne;WDDnDColonne.prototype._vSetDonneesDnD=function(){WDDnDNatif.prototype._vSetDonneesDnD.apply(this,arguments);this._SetEventDataSelonTypeAvecCorrection(this.ms_tabTypes[0],this.m_oColonne.m_sAlias)};WDDnDColonne.prototype._vnGetOperationSurDrop=function(){var n=this.ms_oDnDSource,t;if(n instanceof WDDnDColonne&&this.m_oAffichageColonne===n.m_oAffichageColonne){if(t=this.__oPositionAffichageCible(n),!t)return this.ms_nOperationSans}else return this.ms_nOperationSans;return WDDnDNatif.prototype._vnGetOperationSurDrop.apply(this,arguments)};WDDnDColonne.prototype._vnOnDragSurvol=function(n,t){return t=WDDnDNatif.prototype._vnOnDragSurvol.apply(this,arguments),this.ms_nDnDEntreeChamp==n&&this!==this.ms_oDnDSource&&this.__AjouteDivsPosition(),t};WDDnDColonne.prototype._vOnDragExit=function(){this.__SupprimeDivsPosition();WDDnDNatif.prototype._vOnDragExit.apply(this,arguments)};WDDnDColonne.prototype._vOnDrop=function(){var n,t;WDDnDNatif.prototype._vOnDrop.apply(this,arguments);this.__SupprimeDivsPosition();n=this.ms_oDnDSource;this!==n&&(t=this.__oPositionAffichageCible(n),this.m_oAffichageColonne.DeplaceColonne(n.m_oColonne,t.m_nPositionAffichage))};WDDnDColonne.prototype._vbEmuleIE9=function(){return bIE&&nIE<10};WDDnDColonne.prototype.__oPositionAffichageCible=function(n){var r=n.m_oColonne.m_nPositionAffichage,t=this.m_oColonne,i=t.m_nPositionAffichage;if(r<i)while(t){if(t.bColonneInsereDroite())return t;t=this.m_oAffichageColonne.oGetColonneInvisible(++i)}else if(i<r)while(t){if(t.bColonneInsereGauche())return t;t=this.m_oAffichageColonne.oGetColonneInvisible(--i)}return null};WDDnDColonne.prototype.__AjouteDivsPosition=function(){this.__SupprimeDivsPosition();var r=this.ms_oDnDSource.m_oColonne.m_nPositionAffichage,n=this.m_oColonne.m_nPositionAffichage,t,i;r<n?(t=n,i=this.m_oAffichageColonne.nGetPositionAffichageValide(n+1,1)):(t=this.m_oAffichageColonne.nGetPositionAffichageValide(n-1,-1),i=n);this.__AjouteUnDivPosition(t,!0,"m_oDivDroit");this.__AjouteUnDivPosition(i,!1,"m_oDivGauche")};WDDnDColonne.prototype.__AjouteUnDivPosition=function(n,t,i){var e,r;if(undefined!==n){var f=this.m_oAffichageColonne.m_oChampTable.oGetIDElement(clWDTableDefs.ID_TITRE,this.m_oAffichageColonne.m_tabPositionAffichage[n].m_oColonne.m_nRangCreation),o=f.clientHeight||f.offsetHeight,u=document.createElement("img");u.src=this.m_oAffichageColonne.m_tabFleches[t?0:1];e=(o-8)/2+"px";u.style.paddingTop=e;u.style.paddingBottom=e;r=document.createElement("div");r.style.position="absolute";r.style.top="0";t?(r.style.right="0",u.style.borderRight="1px solid white",r.style.borderRight="1px solid red"):(r.style.left="0",u.style.borderLeft="1px solid white",r.style.borderLeft="1px solid red");r.appendChild(u);this[i]=f.appendChild(r)}};WDDnDColonne.prototype.__SupprimeDivsPosition=function(){clWDUtil.bHTMLVideDepuisVariable(this,"m_oDivDroit");clWDUtil.bHTMLVideDepuisVariable(this,"m_oDivGauche")}