/*! VersionVI: 30F200066p x */
function WDAJAXRequete(n,t,i,r){this.m_nId=n;this.m_clRequete=t;this.m_bPost=i;this.m_bSynchrone=r;this.m_bValide=!0}function _JAEE(n,t,i,r,u){clWDAJAXMain.AJAXExecuteEvenement(n,t,i,r,u)}function _JAZR(n,t){clWDAJAXMain.SetZRChamp(n,t)}function _JAZREDE(n,t,i,r){clWDAJAXMain.SetZRChampEnrouleDeroule(n,t,i,r)}WDAJAXRequete.prototype.readyStateUninitialized=0;WDAJAXRequete.prototype.readyStateLoading=1;WDAJAXRequete.prototype.readyStateLoaded=2;WDAJAXRequete.prototype.readyStateInteractive=3;WDAJAXRequete.prototype.readyStateComplete=4;WDAJAXRequete.prototype.sHeaderErreur="WebDevError";WDAJAXRequete.prototype.sHeaderRedirPHP="WebDevRedirPHP";WDAJAXRequete.prototype.sHeaderXML="WebDevXMLDoc";WDAJAXRequete.prototype.OnReadyState=function(n){this.m_clRequete&&this.m_clRequete.readyState==this.readyStateComplete&&(this.m_oObjetRequeteTable?this.__OnReadyStateTable(n):this.bValideResultat()&&this.m_fCallback&&(this.m_bValide=!0,this.m_fCallback(this.sGetResultat(n),this.m_nId)),this.Libere())};WDAJAXRequete.prototype.__OnReadyStateTable=function(n){var t=!1;this.bValideResultat()&&(t=clWDAJAXMain.bReponseGenerique(this,n,this.m_oObjetRequeteTable,[]));this.m_oObjetRequeteTable&&this.m_oObjetRequeteTable.SupprimeRequete(!t)};WDAJAXRequete.prototype.__bHeaderHTTPExiste=function(n){try{var t=this.m_clRequete.getResponseHeader(n);return t&&t.length>0}catch(i){return!1}};WDAJAXRequete.prototype.bRedirectionPHP=function(){return this.__bHeaderHTTPExiste(this.sHeaderRedirPHP)};WDAJAXRequete.prototype.bErreurServeur=function(){return this.__bHeaderHTTPExiste(this.sHeaderErreur)};WDAJAXRequete.prototype.xEnvoi=function(n,t){!this.m_bPost&&n.length>0&&(t+=(t.indexOf("?")==-1?"?":"&")+n);this.m_bValide=!1;try{this.m_clRequete.open(this.m_bPost?"POST":"GET",t,!this.m_bSynchrone);this.m_clRequete.setRequestHeader("Content-Type","application/x-www-form-urlencoded");this.m_clRequete.send(this.m_bPost?n:"")}catch(i){throw new WDErreur(500,i.message);}if(bIE&&this.readyStateComplete==this.m_clRequete.readyState&&1e4<this.m_clRequete.status)throw new WDErreur(500,this.m_clRequete.status);};WDAJAXRequete.prototype.sGetDocRequeteAlphabet=function(){var t=document.charset,n;if(!t)return undefined;try{if(n=this.m_clRequete.getResponseHeader("Content-type"),n&&0<n.indexOf("charset="))return n.substring(n.indexOf("charset=")+8)}catch(i){}return t};WDAJAXRequete.prototype.bValideResultat=function(){var r,u,n,i,t;if(this.m_bValide=!1,this.m_clRequete.readyState==this.readyStateComplete&&(r=this.m_clRequete.status,0!=r&&r<400))if(this.bRedirectionPHP())u=this.m_clRequete.responseText,document.location.replace(unescape(u));else if(this.bErreurServeur())n=this.m_clRequete.responseText,i=this.sGetDocRequeteAlphabet(),this.Libere(),clWDAJAXMain.BloqueAJAX(),typeof System!="object"?bIE?nIE>=7?(t=document.open("text/html","replace"),i&&(t.charset=i),t.write(n),t.close()):(t=document.open("text/html","_self","",!0).document,i&&(t.charset=i),clWDUtil.nSetTimeout(function(){t.write(n)},clWDUtil.ms_oTimeoutImmediat)):(t=document,clWDUtil.nSetTimeout(function(){t.write(n);i&&(t.charset=i);document.close()},clWDUtil.ms_oTimeoutImmediat)):(n=n.replace(clWDAJAXMain.ms_oRegExpRC,""),n=n.replace(/\<br\s*\/{0,1}\>/ig,"\r\n"),n=n.replace(/\<P\>/ig,"\r\n"),n=n.replace(/\<[^\>]+\>/ig,""),n=n.replace(/\r\n/g,"<br />"),document.body.innerHTML=n);else return this.m_bValide=!0,!0;return!1};WDAJAXRequete.prototype.sGetResultat=function(n){var t,r,u,i;if(this.m_bValide){t=this.m_clRequete.responseText;r=!1;t.substring(0,5)=="<?xml"&&t.match(clWDAJAXMain.XML_RACINERegExp)&&(u=[],clWDAJAXMain.bReponseGenerique(this,n,null,u),r=!0,t=u[0]);try{if(i=this.m_clRequete.getResponseHeader(this.sHeaderXML),i&&i.length>0)return XMLAjoutDoc(i,r?clWDAJAXMain.oGetXMLDepuisTexte(t):this.m_clRequete.responseXML),i}catch(f){}return t}return""};WDAJAXRequete.prototype.Init=function(n){if(!this.m_bSynchrone){this.m_oObjetRequeteTable=n;var t=this;this.m_clRequete.onreadystatechange=function(){t.OnReadyState(_PAGE_)}}};WDAJAXRequete.prototype.bEnCours=function(){return!!this.m_fCallback};WDAJAXRequete.prototype.Annule=function(){delete this.m_fCallback;this.m_clRequete.onreadystatechange=clWDUtil.m_pfVide;this.Libere()};WDAJAXRequete.prototype.Libere=function(){clWDUtil.SupprimeDansTableauFct(clWDAJAXMain.m_tabConnection,clWDAJAXMain.__s_nCompareConnection,this.m_nId);this.m_oObjetRequeteTable=null;delete this.m_oObjetRequeteTable;this.m_clRequete&&(delete this.m_clRequete.onreadystatechange,bFF&&this.m_clRequete.readyState<this.readyStateComplete&&this.m_clRequete.abort(),delete this.m_clRequete);clWDAJAXMain.ReactualiseActivite(!1)};var clWDAJAXMain={m_tabConnection:[],m_nIdPos:1,m_tabRequetes:[],m_nRequeteSynchrone:0,m_bPageAWP:document.location.pathname.substr(document.location.pathname.length-4,4).toLowerCase()==".awp",m_bBloque:!1,m_pfTraiteAJAXExecuteEvenement:function(){clWDAJAXMain.TraiteAJAXExecuteEvenement()},m_pfReactualiseActivite:function(){clWDAJAXMain._ReactualiseActivite()},m_pfBloqueAJAX:function(){clWDAJAXMain.BloqueAJAX()},m_bWDAJAXMainValide:!0,m_oActiviteChamp:null,m_bActivite:!1,m_nActiviteOption:0,m_tabOnClick:[],sCommandeAjax_Execute:"WD_ACTION_=AJAXEXECUTE",sCommandeAjax_Champ:"WD_ACTION_=AJAXCHAMP",sCommandeAjax_Page:"WD_ACTION_=AJAXPAGE",sCommandeAjax_InitGadget:"WD_ACTION_=AJAXINITGADGET",sCommandeAjax_Erreur:"WD_ACTION_=AJAXERREUR",sCommandeWDAction:"WD_ACTION_",sCommandeAjax_ExecuteProc:"EXECUTEPROC",sCommandeAjax_ExecuteProcChamps:"EXECUTEPROCCHAMPS",sCommandeAjax_Evenement:"EXECUTE",sCommandeAjax_Reglette:"SCROLLTABLE",sCommandeAjax_ClicTable:"CLICTABLE",sCommandeAjax_ActionChamp:"ACTIONCHAMP",sCommandeAjax_SaisieAssistee:"SAISIEASSISTEE",sCommandeAjax_Contexte:"WD_CONTEXTE_",ms_oRegExpRCTabEspaces:new RegExp("[\\s]","g"),ms_oRegExpRCTab:new RegExp("[\\r\\n\\t]","g"),ms_oRegExpRC:new RegExp("[\\r\\n]","g"),ms_oRegExpEspacesMutliples:new RegExp("\\s(\\s)+","g"),ms_oRegExpURLInput:new RegExp("\\(\\'([^\\']*)\\'",""),XML_RACINE:"WAJAX",XML_RACINERegExp:new RegExp("<WAJAX>"),XML_JS:"JS",XML_REDIR:"REDIR",XML_CHAMP:"CHAMP",XML_LISTE:"LISTE",XML_RESULTAT:"RESULTAT",XML_TRACE:"TRACE",XML_TRACE_ID:"WDAJAX_TRACE",XML_LIENSOCIAL:"LIENSOCIAL",XML_LIENSOCIAL_FACEBOOK:1,XML_LIENSOCIAL_TWEETER:2,XML_LIENSOCIAL_GOOGLEPLUS:4,XML_LIENSOCIAL_LINKEDIN:8,XML_CHAMP_ATT_ALIAS:"ALIAS",XML_CHAMP_ATT_TYPE:"TYPE",XML_CHAMP_TYPE_PAGEPRINCIPALE:1,XML_CHAMP_TYPE_SELECTEUR:6,XML_CHAMP_TYPE_LISTE:7,XML_CHAMP_TYPE_TABLE:9,XML_CHAMP_TYPE_CHAMPFORMATE:10,XML_CHAMP_TYPE_ZONEREPETEE:11,XML_CHAMP_TYPE_HTML:12,XML_CHAMP_TYPE_LIEN:16,XML_CHAMP_TYPE_LIBELLEHTML:17,XML_CHAMP_TYPE_WEBCAM:20,XML_CHAMP_TYPE_REGLETTE:21,XML_CHAMP_TYPE_MAPAREA:22,XML_CHAMP_TYPE_CHEMINNAV:23,XML_CHAMP_TYPE_TREEVIEW:25,XML_CHAMP_TYPE_VIGNETTE:26,XML_CHAMP_TYPE_IFRAME:27,XML_CHAMP_TYPE_IFRAME_DEST:31,XML_CHAMP_TYPE_IFRAME_SOURCE:32,XML_CHAMP_TYPE_GRAPHE:33,XML_CHAMP_TYPE_TIROIR:34,XML_CHAMP_TYPE_TABLEHIERARCHIQUE:35,XML_CHAMP_TYPE_SUPERCHAMP:40,XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:42,XML_CHAMP_TYPE_MODELEDECHAMP_DEST:43,XML_CHAMP_TYPE_ONGLET:44,XML_CHAMP_TYPE_PLANSITE:45,XML_CHAMP_TYPE_CALENDRIER:47,XML_CHAMP_TYPE_VOLETONGLET:49,XML_CHAMP_TYPE_SOUSMENU:55,XML_CHAMP_TYPE_COLONNETABLE:56,XML_CHAMP_TYPE_OPTIONMENU:57,XML_CHAMP_TYPE_COLONNETABLEH:68,XML_CHAMP_TYPE_RANGESLIDER:72,XML_CHAMP_TYPE_AGENDA:76,XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE:77,XML_CHAMP_TYPE_VIDEO:78,XML_CHAMP_TYPE_PAGECORNEE:79,XML_CHAMP_TYPE_PLANNING:80,XML_CHAMP_TYPE_CAPTCHA:82,XML_CHAMP_TYPE_JAUGE:83,XML_CHAMP_TYPE_CELLULEMISEENPAGE:84,XML_CHAMP_TYPE_RATING:85,XML_CHAMP_TYPE_POPUP:90,XML_CHAMP_TYPE_CARTE:92,XML_CHAMP_TYPE_POTENTIOMETRE:100,XML_CHAMP_TYPE_LIENSOCIAL:103,XML_CHAMP_TYPE_MENUPOPUP:105,XML_CHAMP_TYPE_ZONETEXTE:109,XML_CHAMP_TYPE_TABLEAUDEBORD:111,XML_CHAMP_ETAT_ETAT:"ETAT",XML_CHAMP_JS:"JS",XML_CHAMP_LIGNES:"LIGNES",XML_CHAMP_LIGNES_COLONNES:"COLONNES",XML_CHAMP_LIGNES_DATA:"DATA",XML_CHAMP_LIGNES_DEBUT:"DEBUT",XML_CHAMP_LIGNES_LIGNE:"LIGNE",XML_CHAMP_LIGNES_LIGNE_CORPS:"CORPS",XML_CHAMP_LIGNES_LIGNE_DEBUT:"DEBUT",XML_CHAMP_LIGNES_LIGNE_FIN:"FIN",XML_CHAMP_LIGNES_LIGNE_INDICE:"INDICE",XML_CHAMP_LIGNES_LIGNE_INVISIBLE:"INVISIBLE",XML_CHAMP_LIGNES_LIGNE_REPLIEE:"REPLIEE",XML_CHAMP_LIGNES_LIGNE_STYLE:"STYLE",XML_CHAMP_LIGNES_NBREPLIEES:"NBREPLIEES",XML_CHAMP_LIGNES_NOMBRE:"NOMBRE",XML_CHAMP_LIGNES_RUPTURES:"RUPTURES",XML_CHAMP_LIGNES_SELECTION:"SELECTION",XML_CHAMP_LIGNES_STYLE:"STYLE",XML_CHAMP_OPTIONS:"OPTIONS",XML_CHAMP_OPTIONS_OPTION:"OPTION",XML_CHAMP_PROP:"PROP",XML_CHAMP_PROP_ATT_NUM:"NUM",XML_CHAMP_PROP_NUM_LIBELLE_TABLE_AJAX:"TABLE_AJAX",XML_CHAMP_PROP_NUM_VISIBLE_PARENTRELATIF:"PARENTRELATIF",XML_CHAMP_PROP_NUM_VISIBLE_PARENTFLUX:"PARENTFLUX",XML_CHAMP_RECHARGE:"RECHARGE",XML_CHAMP_RECHARGE_PARAM:"PARAM",XML_CHAMP_REFRESH:"REFRESH",XML_CHAMP_REFRESH_DATA:"DATA",XML_CHAMP_REFRESH_DEBUT:"DEBUT",XML_CHAMP_REFRESH_NOMBRE:"NOMBRE",XML_CHAMP_REFRESH_RESETTABLE:"RESETTABLE",XML_CHAMP_SAISIEA:"SAISIEA",XML_CHAMP_SAISIEA_FILTRE:"FILTRE",XML_CHAMP_SAISIEA_OUVERTUREAUTO:"OUVERTUREAUTO",XML_CHAMP_SAISIEA_TAILLEMIN:"TAILLEMIN",XML_CHAMP_SAISIEA_DELAI:"DELAI",XML_CHAMP_SAISIEA_SANSCASSE:"SANSCASSE",XML_CHAMP_SAISIEA_OPTION:"OPTION",XML_CHAMP_SAISIEA_SANSOPTION:"SANSOPTION",XML_CHAMP_SATURATION:"SATURATION",XML_CHAMP_TREEVIEW:"TREEVIEW",XML_CHAMP_TREEVIEW_DEROULE:"DEROULE",XML_CHAMP_TREEVIEW_DEROULETAB:"DEROULETAB",XML_CHAMP_TREEVIEW_NOEUDS:"NOEUDS",XML_CHAMP_TREEVIEW_SELECT:"SELECT",XML_WBTRACE_ID:"WB_TRACE",bWDAJAXMainValide:function(){if(!this.m_bChargementTermine){if(document.readyState&&document.readyState!="interactive"&&document.readyState!="complete")return!1;if(this.m_bChargementTermine=!0,bFF){var n=new RegExp("Fire[Ff]ox/\\s*(\\d+)\\.*(\\d+)").exec(navigator.userAgent);(!n||!n[1]||parseInt(n[1],10)<27)&&clWDUtil.AttacheDetacheEvent(!0,window,"beforeunload",this.m_pfBloqueAJAX,!0)}}return this.m_bWDAJAXMainValide},BloqueAJAX:function(){for(this.m_oActiviteChamp=null,this.m_bActivite=!1,this.m_bWDAJAXMainValide=!1;this.m_tabConnection.length>0;)this.m_tabConnection[0].Libere()},nGetNouvelId:function(){return this.m_nIdPos++},clCreeXMLHttpRequest:function(){if(window.XMLHttpRequest)try{return new XMLHttpRequest}catch(n){}if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(n){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}return null},clCreeWDAJAXRequete:function(n,t,i){var u,f,r;return(n==null&&(n=!0),t==null&&(t=!1),u=this.clCreeXMLHttpRequest(),!u)?null:(f=this.nGetNouvelId(),r=new WDAJAXRequete(f,u,n,t),i||r.Init(),t||this.m_tabConnection.push(r),r)},__s_nCompareConnection:function(n,t){return n.m_nId==t},GetWDAJAXRequete:function(n){return clWDUtil.oDansTableauFct(this.m_tabConnection,this.__s_nCompareConnection,n,null)},bReponseGenerique:function(n,t,i,r){return n.bValideResultat()?this.__bReponseGenerique(n,t,i,n.m_clRequete.responseText,n.m_clRequete.responseXML,n.sGetDocRequeteAlphabet(),r):!1},oGetXMLDepuisTexte:function(n){var i,t;if(n&&n.length)if(window.DOMParser){if(i=new DOMParser,i)return i.parseFromString(n,"text/xml")}else if(window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLDOM"),t&&(t.loadXML(n),!t.parseError||0==t.parseError.errorCode)))return t;return null},bReponseGeneriqueDepuisTexte:function(n,t,i){var r=this.oGetXMLDepuisTexte(n);return r?this.__bReponseGenerique(null,t,null,n,r,document.charset,i):!1},__bReponseGenerique:function(n,t,i,r,u,f,e){var o,s;return r.substring(0,5)=="<?xml"&&r.match(this.XML_RACINERegExp)?this.bActionXML(t,i,u,e):(o=r,n&&(n.Libere(),n=null),this.BloqueAJAX(),typeof System!="object"?bIE?(s=document.open("text/html","replace"),f&&(s.charset=f),s.write(o),nIE>=7&&s.close()):(document.write(o),f&&(document.charset=f),document.close()):(o=o.replace(this.ms_oRegExpRC,""),o=o.replace(/\<br\s*\/{0,1}\>/ig,"\r\n"),o=o.replace(/\<P\>/ig,"\r\n"),o=o.replace(/\<[^\>]+\>/ig,""),o=o.replace(/\r\n/g,"<br />"),document.body.innerHTML=o),!0)},sConstruitValeurChampNom:function(n,t){var i=this.__oChercheChamp(n,t);return i?this.sConstruitValeurChamp(i):""},sConstruitValeurChampNomSep:function(n,t){var i=this.sConstruitValeurChampNom(n,t);return i.length>0?"&"+i:i},sConstruitValeurChamp:function(n){var t;if(n.type)switch(n.type.toLowerCase()){case"text":case"hidden":case"textarea":case"password":return t=n.value,n.bIndication===!0&&(t=""),encodeURIComponent(n.name)+"="+encodeURIComponent(t);case"button":return"";case"checkbox":case"radio":return n.checked?encodeURIComponent(n.name)+"="+encodeURIComponent(n.value):"";case"select-one":return n.selectedIndex!=-1?encodeURIComponent(n.name)+"="+encodeURIComponent(n.options[n.selectedIndex].value):"";case"select-multiple":for(var r="",i=0,u=n.options.length,i=0;i<u;i++)n.options[i].selected&&(r.length>0&&(r+="&"),r+=encodeURIComponent(n.name)+"="+n.options[i].value);return r;case"file":case"reset":case"submit":return"";default:return t=n.value,t===undefined?"":encodeURIComponent(n.name)+"="+encodeURIComponent(t)}else return""},sConstruitValeurPage:function(n){for(var i=new Array(n.length),f=n.length,r,u,t=0;t<f;t++)r=n[t],u=r.name,u!=this.sCommandeWDAction&&r.type&&u.substr(0,4)!="PTH_"?(i[t]=(t>0&&i[t-1].charAt(i[t-1].length-1)!="&"?"&":"")+this.sConstruitValeurChamp(r),i[t]=="&"&&(i[t]="")):i[t]="";return i.join("")},sConstruitURL:function(n){return n},sConstuitRequeteProcedure:function(n,t,i){var u=this.sCommandeAjax_ExecuteProc,r;return 0!=(i&1)&&(u=this.sCommandeAjax_ExecuteProcChamps),r=this.sCommandeAjax_Execute,r+="&"+u+"="+encodeURIComponent(n),r+("&"+this.sCommandeAjax_Contexte+"="+encodeURIComponent(t))},sConstuitRequeteTable:function(n){var t=this.sCommandeAjax_Execute;return n.length>0&&(t+="&"+n),t},sConstuitURLRequeteJauge:function(n){return this.sConstruitURL(clWDUtil.sGetPageAction())+"/JAUGE/"+document.forms[0].name+"."+n},SetZRChamp:function(n,t){if(this.m_sZRChamp){this.m_bBloque=!0;return}this._SetZRChamp(n,t)},SetZRChampEnrouleDeroule:function(n,t,i,r){this.m_sZRChamp||this.m_nRupture||(this._SetZRChamp(t,""+i),this.m_nRupture=r,this.AJAXExecuteEvenement(n,t,"ENDETABLE",10))},_SetZRChamp:function(n,t){this.m_sZRChamp=n;this.m_sZRChampValeur=t},sConstuitRequeteEvenement:function(n,t,i,r){var u=[],f="",c=t,e,s,o,h;undefined!==t&&t.length&&0<t.indexOf(";")&&(e=t.split(";"),1<e.length&&e[0].length&&e[1].length&&(t=e[0],c=e[1]));switch(r){case 1:u.push(this.sCommandeAjax_Champ);u.push(this.sCommandeAjax_Evenement+"="+i);u.push(this.sCommandeAjax_Contexte+"="+t);f=this.sConstruitValeurChampNom(n,t);this.m_sZRChamp&&u.push(encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur));break;case 2:u.push(this.sCommandeAjax_Page);u.push(this.sCommandeAjax_Evenement+"="+i);u.push(this.sCommandeAjax_Contexte+"="+t);f=this.sConstruitValeurPage(n.elements);break;case 3:u.push(this.sCommandeAjax_Execute);u.push(this.sCommandeAjax_Reglette+"="+t);u.push(t+"="+i);break;case 4:u.push(this.sCommandeAjax_Page);u.push(this.sCommandeAjax_Reglette+"="+t);s=n[t];s&&(s.value=i);f=this.sConstruitValeurPage(n.elements);break;case 5:u.push(this.sCommandeAjax_Page);u.push(this.sCommandeAjax_ClicTable+"="+t);f=this.sConstruitValeurPage(n.elements);break;case 6:u.push(this.sCommandeAjax_Champ);u.push(this.sCommandeAjax_ClicTable+"="+t);f=this.sConstruitValeurChampNom(n,c);break;case 7:u.push(this.sCommandeAjax_InitGadget);break;case 8:u.push(this.sCommandeAjax_Champ);u.push(this.sCommandeAjax_ActionChamp+"="+(i?i:""));u.push(this.sCommandeAjax_Contexte+"="+t);f=this.sConstruitValeurChampNom(n,t);o=oGetObjetChamp(t);u.push(this.sConstruitValeurChamp(o.oGetElementHTMLValeur()));u.push(this.sConstruitValeurChamp(o.oGetElementHTMLMois()));o.bGestionTableZR_SansPopup()&&u.push(this.sConstruitValeurChampNom(n,o.m_sAliasTableZRParent));break;case 9:u.push(this.sCommandeAjax_Champ);u.push(this.sCommandeAjax_ActionChamp+"="+(i?i:""));u.push(this.sCommandeAjax_Contexte+"="+t);f=this.sConstruitValeurChamp(oGetObjetChamp(t).m_oChampFormulaire);break;case 10:if(undefined!=this.m_nRupture)u.push(this.sCommandeAjax_Champ),u.push(this.sCommandeAjax_ActionChamp+"="+(i?i:"")),u.push(this.sCommandeAjax_Contexte+"="+t),u.push("WD_PARAM_="+this.m_nRupture),u.push(encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur)),h=this.sConstruitValeurChampNom(n,this.m_sZRChamp+"_DATA"),h.length&&u.push(h);else return"";break;case 11:u.push(this.sCommandeAjax_Champ);u.push(this.sCommandeAjax_SaisieAssistee+"="+t);f=this.sConstruitValeurChampNom(n,t);break;default:this.m_sZRChamp&&(f=encodeURIComponent(this.m_sZRChamp)+"="+encodeURIComponent(this.m_sZRChampValeur));u.push(f!=""?this.sCommandeAjax_Champ:this.sCommandeAjax_Execute);u.push(this.sCommandeAjax_Evenement+"="+i);u.push(this.sCommandeAjax_Contexte+"="+t)}return f!==undefined&&f.length>0&&u.push(f),delete this.m_sZRChamp,delete this.m_sZRChampValeur,delete this.m_nRupture,window.FinSubmitAJAX&&typeof FinSubmitAJAX=="function"&&FinSubmitAJAX(),u.join("&")},AJAXDisponible:function(){if(this.m_bAJAXDisponible===undefined){var n=this.clCreeXMLHttpRequest();this.m_bAJAXDisponible=n!=null;n=null}return this.m_bAJAXDisponible},sXMLGetValeur:function(n){var t,u,i,f,r;if(n){if(u=n.childNodes,i=u.length,i==1)return t=u[0].nodeValue,t!==null?t:"";if(i>1){for(f=new Array(i),r=0;r<i;r++)t=u[r].nodeValue,f[r]=t!==null?t:"";return f.join("")}}return""},nXMLGetValeur:function(n){return parseInt(this.sXMLGetValeur(n),10)},bXMLGetValeur:function(n){return this.sXMLGetValeur(n)!="0"},tabXMLGetTableauValeur:function(n,t){var i=[];return clWDUtil.bForEach(n.getElementsByTagName(t),function(n){return i.push(clWDAJAXMain.sXMLGetValeur(n)),!0}),0<i.length?i:null},bXMLAttributExiste:function(n,t){return!!n.attributes.getNamedItem(t)},sXMLGetAttribut:function(n,t){return clWDUtil.sGetAttributValeur(n.attributes.getNamedItem(t))},sXMLGetAttributSafe:function(n,t,i){var r=n.attributes.getNamedItem(t);return r?clWDUtil.sGetAttributValeur(r):i},bXMLGetAttributSafe:function(n,t){return this.sXMLGetAttributSafe(n,t,"0")=="1"},bXMLGetAttributSafe_Vrai:function(n,t){return this.sXMLGetAttributSafe(n,t,"1")!="0"},nXMLGetAttribut:function(n,t){return parseInt(this.sXMLGetAttribut(n,t),10)},nXMLGetAttributSafe:function(n,t,i){var u=this.sXMLGetAttributSafe(n,t,""),r;return u.length>0&&(r=parseInt(u,10),!isNaN(r))?r:i},__sTrim:function(n,t,i){for(var e=new String(n),r,u=0,f;u<e.length;){if(r=e.charAt(u),t&&r==" "){u++;continue}if(i&&r=="\t"){u++;continue}if(t&&(r=="\r"||r=="\n")){u++;continue}break}for(f=e.length;f>u;){if(r=e.charAt(f-1),t&&r==" "){f--;continue}if(i&&r=="\t"){f++;continue}if(t&&(r=="\r"||r=="\n")){f++;continue}break}return e.substring(u,f)},sSupprimeEspacements:function(n){return n.replace(this.ms_oRegExpRCTab,"").replace(this.ms_oRegExpEspacesMutliples," ")},__oChercheChamp:function(n,t,i,r,u){var f;switch(i){case this.XML_CHAMP_TYPE_WEBCAM:case this.XML_CHAMP_TYPE_IFRAME:if(f=this.__oChercheChampInterne(n,n.name+"_"+t,i,r,u),f)return f}return this.__oChercheChampInterne(n,t,i,r,u)},__oChercheChampInterne:function(n,t,i,r,u){var f;if(r){switch(i){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:f=this.__oGetConteneurParent(t,i,!1);break;case WDChamp.prototype.ms_nIDObjetInterrupteur:t.substr(t.length-2,2)=="[]"&&(f=_JGE(t.substr(0,t.length-2),document,r));break;case this.XML_CHAMP_TYPE_CALENDRIER:u==!1&&(f=_JGE(t,document,!1,!0))}f||(f=_JGE(t,document,r))}else switch(i){case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:if(bIEQuirks)break;case WDChamp.prototype.ms_nIDObjetLibelle:case this.XML_CHAMP_TYPE_CHAMPFORMATE:case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:f=_JGE(t,document,!1);break;case this.XML_CHAMP_TYPE_TREEVIEW:f=_JGE(t+"_",document,!1);break;case this.XML_CHAMP_TYPE_LIEN:case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_VOLETONGLET:case this.XML_CHAMP_TYPE_PAGECORNEE:case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:f=document.getElementById(t)}if(f||(f=n[t]),!f&&(f=document.getElementsByName(t),f))switch(i){case this.XML_CHAMP_TYPE_SELECTEUR:break;default:f=f[0]}return f},__oGetConteneurParent:function(n,t,i){var u=t==this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE&&i,r=document.getElementById(u?n+"_POS":"con-"+n);return u&&(r=r.getElementsByTagName("table")[0]),r?r:document.getElementById("ctz"+n)},__oGetConteneurTBODY:function(n,t){var u=n,i,r,f;if(u&&clWDUtil.bBaliseEstTag(u,"table"))for(r=u.childNodes,f=r.length,i=0;i<f;i++)if(clWDUtil.bBaliseEstTag(r[i],"tbody")){if(u=r[i],t==this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE)for(r=u.childNodes,f=r.length,i=0;i<f;i++)if(clWDUtil.bBaliseEstTag(r[i],"tr")){u=r[i];break}break}return u},__oGetConteneurLigne:function(n,t,i){return this.__oGetRemonteFilsUnique(n+"_"+t,i)},__bEstTexteInactif:function(n){return n.nodeName!="#text"?!1:0==n.nodeValue.replace(this.ms_oRegExpRCTabEspaces,"").length},__bAvecFilsActifUnique:function(n){for(var i=!1,r=n.childNodes.length,t=0;t<r;t++)if(!this.__bEstTexteInactif(n.childNodes[t])){if(i)return!1;i=!0}return!0},__oGetRemonteFilsUnique:function(n,t){var r=document.getElementById(n),i;if(r&&t)for(i=r.parentNode;i&&i!=t&&this.__bAvecFilsActifUnique(i);)r=i,i=r.parentNode;return r},__bSupprimeLigne:function(n,t,i,r,u,f){var e=this.__oGetConteneurLigne(n,i,f);if(!e)return!1;switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:this.__SupprimeRuptures(n,i,r,f)}return f?clWDUtil.oSupprimeElement(e):u.removeChild(e),this.__SupprimeStyleLigne(n,i),!0},__SupprimeStyleLigne:function(n,t){var i=document.getElementById("rgs-"+n+"-"+t);i&&i.parentNode&&i.parentNode.removeChild(i)},__oTrouveUneRupture:function(n,t,i,r,u){return this.__oGetRemonteFilsUnique(n+"-"+(t?"H":"B")+"-"+i+"-"+r,u)},__oTrouveRuptureExterne:function(n,t,i,r,u){for(var e,f=0;f<r;f++)if(e=this.__oTrouveUneRupture(n,t,f,i,u),e)return e;return null},__SupprimeUneRupture:function(n,t,i,r,u){clWDUtil.oSupprimeElement(this.__oTrouveUneRupture(n,t,i,r,u))},__SupprimeRuptures:function(n,t,i,r){for(var u=0;u<i;u++)this.__SupprimeUneRupture(n,!0,u,t,r),this.__SupprimeUneRupture(n,!1,u,t,r)},__RemplaceElementDansTable:function(n,t){n.parentNode.replaceChild(clWDUtil.oCreateContextualFragmentSelonElement(n,t),n)},__InsereElementDansTable:function(n,t){0<t.length&&n.parentNode.insertBefore(clWDUtil.oCreateContextualFragmentSelonElement(n,t),n)},__AjouteElementDansTable:function(n,t){var i,r;if(0<t.length)for(i=document.createRange(),i.setStart(n,0),r=clWDUtil.oCreateContextualFragment(i,t).childNodes;r.length>0;)n.appendChild(r[0])},__InsereRemplaceTrTdDansTable:function(n,t,i,r){t=i?t+"<\/tr>":"<tr>"+t;var u=clWDUtil.oCreateContextualFragmentSelonElement(n,t).childNodes;u.length>1&&(i?n.parentNode.insertBefore(u[0],n):n.parentNode.insertBefore(u[1],n.nextSibling));r?n.replaceChild(u[0].firstChild,r):i?n.parentNode.insertBefore(u[0],n):n.previousSibling.appendChild(u[0])},__bHTMLDebutTR:function(n){var t=n.substr(0,4).toLowerCase();return"<tr>"==t||"<tr "==t},__bHTMLDebutTD:function(n){var t=n.substr(0,4).toLowerCase();return"<td>"==t||"<td "==t},__oSauteTableCadrage:function(n){if(n&&clWDUtil.bBaliseEstTag(n,"table"))while(n&&!clWDUtil.bBaliseEstTag(n,"td"))n=n.firstChild;return n},ActionProprieteValeur:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),e,o,s;switch(i){case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_CAPTCHA:case this.XML_CHAMP_TYPE_IFRAME:n&&(n.src=f);break;case this.XML_CHAMP_TYPE_LISTE:n&&(n.selectedIndex=parseInt(f,10));break;case this.XML_CHAMP_TYPE_SELECTEUR:if(e=parseInt(f,10),e<0)if(n&&n.length)for(s=n.length,o=0;o<s;o++)n[o].checked=!1;else n&&(n.checked=!1);else n&&(n.length?e<=n.length&&(n[e].checked=!0):n.checked=!0);break;case WDChamp.prototype.ms_nIDObjetInterrupteur:n&&(n.checked=parseInt(f,10));break;case WDChamp.prototype.ms_nIDObjetLibelle:case this.XML_CHAMP_TYPE_CHAMPFORMATE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(f,!0));break;case WDChamp.prototype.ms_nIDObjetSaisie:n&&(n.value=f,AppelMethodeChamp(u,WDChamp.prototype.ms_sSetValeur,[null,f,n]));break;case this.XML_CHAMP_TYPE_HTML:case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:!n&&t&&(n=t);n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(f,!1,!0));break;case this.XML_CHAMP_TYPE_REGLETTE:n=n.getElementsByTagName("ol")[0];case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(f,!1,!0));break;case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:break;case this.XML_CHAMP_TYPE_ONGLET:case this.XML_CHAMP_TYPE_RANGESLIDER:case this.XML_CHAMP_TYPE_RATING:case this.XML_CHAMP_TYPE_POTENTIOMETRE:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetValeur,[null,f,null]);break;case this.XML_CHAMP_TYPE_TIROIR:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetValeur,[null,parseInt(f,10)!=0,null]);break;case this.XML_CHAMP_TYPE_LIENSOCIAL:if(n&&n.attributes)switch(clWDUtil.sGetTagName(n)){case"a":n.setAttribute("href",f,0);break;case"div":f.length?n.setAttribute("data-href",f,0):n.attributes.getNamedItem("data-href")&&n.removeAttribute("data-href",0)}break;default:n&&(n.value=f)}},ActionProprieteLibelle:function(n,t,i,r){var u=this.sXMLGetValeur(i),o,f,s,e,h,l,c;switch(t){case this.XML_CHAMP_TYPE_PAGEPRINCIPALE:document.title=u;return;case WDChamp.prototype.ms_nIDObjetBouton:f=_JGE("z_"+r+"_IMG",document,!1);f&&!clWDUtil.bBaliseEstTag(f,"img")?(s=f.getElementsByTagName("span"),s&&s.length&&(f=s[0]),o=f):n&&clWDUtil.bBaliseEstTag(n,"button")&&(o=n);o?o.innerHTML=clWDUtil.sEncodeInnerHTML(u,!0):n&&(n.value=u);return;case WDChamp.prototype.ms_nIDObjetLibelle:n=this.__oSauteTableCadrage(n);break;case this.XML_CHAMP_TYPE_LIBELLEHTML:case this.XML_CHAMP_TYPE_ZONETEXTE:n=this.__oSauteTableCadrage(n);n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(u,!1,!0));return;case this.XML_CHAMP_TYPE_LIEN:if(n=_JGE(r,document,!1,!0),n){while(n&&!clWDUtil.bBaliseEstTag(n,"a"))n=n.firstChild;n&&(n.innerHTML=u)}return;case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:n=document.getElementById("lz"+r);n||(n=_JGE(r,document,!1,!0));break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:e=new String(this.sXMLGetAttributSafe(i,this.XML_CHAMP_PROP_NUM_LIBELLE_TABLE_AJAX,""));e.length>0&&(h=e.indexOf(";"),l=oGetObjetChamp(e.substring(0,h)),n=l.oGetIDElement(clWDTableDefs.ID_TITRE,parseInt(e.substring(h+1),10)));n||(n=document.getElementById((t!=this.XML_CHAMP_TYPE_ZONEREPETEE?"lz":"tt")+r),n||(n=_JGE(r,document,!1,!0)));break;case this.XML_CHAMP_TYPE_VOLETONGLET:n&&(c=n.getElementsByTagName("a"),c.length&&(n=c[0]));break;case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:break;default:n=document.getElementById("lz"+r)}n&&(n.innerHTML=clWDUtil.sEncodeInnerHTML(u,!0))},ActionProprieteHauteur:function(n,t,i,r,u){this.__ActionProprieteLargeurHauteur(n,t,i,r,u,"height",WDChamp.prototype.XML_CHAMP_PROP_NUM_HAUTEUR)},ActionProprieteLargeur:function(n,t,i,r,u){this.__ActionProprieteLargeurHauteur(n,t,i,r,u,"width",WDChamp.prototype.XML_CHAMP_PROP_NUM_LARGEUR)},__ActionProprieteLargeurHauteur:function(n,t,i,r,u,f,e){var s,o,h;if(n&&(s=this.nXMLGetValeur(r),s>=0)){o=s+"px";switch(i){case this.XML_CHAMP_TYPE_TIROIR:break;case this.XML_CHAMP_TYPE_JAUGE:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[e,null,s,null,null]);n=_JGE(u,document,!0);n.getElementsByTagName("td")[0][f]=s;this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1);break;case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:for(h=n.getElementsByTagName("td")[0],""!=h.style[f]?h.style[f]=o:h[f]=s,this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1),n=n.parentNode;n&&n!=document.body;)switch(clWDUtil.sGetTagName(n)){case"table":n[f]=s;default:n=n.parentNode;break;case"div":this.ActionProprieteStyleGenerique(n,t,i,u,f,o,!1);n=null}break;case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:this.ActionProprieteStyleGenerique(t,null,i,u,f,o,!1);break;case this.XML_CHAMP_TYPE_ONGLET:this.ActionProprieteStyleGenerique(t,null,i,u,f,o,!1);this.ActionProprieteStyleGenerique(document.getElementById("con-"+u),null,i,f,o,!1);break;case WDChamp.prototype.ms_nIDObjetLibelle:this.ActionProprieteStyleGenerique(n!=t&&document.getElementById("bz"+u)||n,null,i,u,f,o,!1);break;case this.XML_CHAMP_TYPE_GRAPHE:this.ActionProprieteStyleGenerique(document.getElementById(u)||n,null,i,u,f,o,!1);break;default:this.ActionProprieteStyleGenerique(n,t,i,u,f,s+"px",!1)}}},ActionProprieteX:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,clWDUtil.bRTL?"right":"left",this.sXMLGetValeur(i)+"px",!1)},ActionProprieteY:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,"top",this.sXMLGetValeur(i)+"px",!1)},ActionProprieteCouleur:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),e=!1;switch(i){case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_TREEVIEW:e=!0;break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:case this.XML_CHAMP_TYPE_JAUGE:this.ActionProprieteStylePolice(n,null,i,u,"color",f,!1);return;case WDChamp.prototype.ms_nIDObjetSaisie:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR,null,f,n,null]);break;case this.XML_CHAMP_TYPE_LIEN:n=_JGE(u,document,!1,!1)}this.ActionProprieteStyleGenerique(n,t,i,u,"color",f,e)},ActionProprieteCouleurFond:function(n,t,i,r,u){var f=this.sXMLGetValeur(r),o=!1,e;switch(i){case this.XML_CHAMP_TYPE_PAGEPRINCIPALE:document.body.style.backgroundColor=f;return;case this.XML_CHAMP_TYPE_IFRAME_DEST:case this.XML_CHAMP_TYPE_IFRAME_SOURCE:case WDChamp.prototype.ms_nIDObjetCellule:case this.XML_CHAMP_TYPE_SUPERCHAMP:case this.XML_CHAMP_TYPE_MODELEDECHAMP_SOURCE:case this.XML_CHAMP_TYPE_MODELEDECHAMP_DEST:n=_JGE(u,document,!1);break;case this.XML_CHAMP_TYPE_TIROIR:n=_JGE(u,document,!0);break;case this.XML_CHAMP_TYPE_LIEN:e=_JGE(u,document,!0);e&&e.style&&(e.style.backgroundColor=f);break;case this.XML_CHAMP_TYPE_REGLETTE:o=!0;break;case WDChamp.prototype.ms_nIDObjetSaisie:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND,null,f,n,null]);break;case this.XML_CHAMP_TYPE_JAUGE:case this.XML_CHAMP_TYPE_GRAPHE:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND,null,f,n,null]);return;case this.XML_CHAMP_TYPE_TABLEAUDEBORD:n=_JGE(u,document,!1,!0)}this.ActionProprieteStyleGenerique(n,t,i,u,"backgroundColor",f,o)},ActionProprieteEtat:function(n,t,i,r,u){var e=this.nXMLGetAttribut(r,this.XML_CHAMP_ETAT_ETAT),f,o;switch(i){case WDChamp.prototype.ms_nIDObjetSaisie:case this.XML_CHAMP_TYPE_GRAPHE:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT,null,e,n,r]);break;case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_LIEN:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:case this.XML_CHAMP_TYPE_VOLETONGLET:if(f=null,clWDUtil.bBaliseEstTag(n,"a"))f=n;else if(clWDUtil.bBaliseEstTag(n.parentNode,"a"))f=n.parentNode;else break;this._AppliqueAttributEtat(r,f,e,!1)}o=clWDUtil.tabGetElementsByClass(t,"wbstyle");clWDUtil.bForEach(o,function(n){return clWDUtil.ActiveDesactiveClassName(n,"wbgrise",4==e),!0})},_AppliqueAttributEtat:function(n,t,i,r){var h=n.firstChild,o,f,c,s;if(h)for(o=h.attributes,c=o.length,f=0;f<c;f++){var l=o.item(f),u=clWDUtil.sGetAttributNom(l),a=u.toLowerCase(),e=clWDUtil.sGetAttributValeur(l);if(i!=0)switch(a){case"onmouseout":case"onmouseover":case"onclick":t[u]=null;break;default:t.removeAttribute(u,0)}else switch(a){case"onmouseout":case"onmouseover":t[u]=new Function("","document."+e);break;case"onclick":if(r){s="";bFF&&-1!=(e+"").indexOf("event")&&(s="event");t[u]=new Function(s,e);break}default:t.setAttribute(u,e,0)}}},ActionProprieteVisible:function(n,t,i,r,u){var e=this.bXMLGetValeur(r),f=t;switch(i){case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:clWDUtil.SetDisplay(document.getElementById("tt"+u),e);break;case this.XML_CHAMP_TYPE_VOLETONGLET:f=n;case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:clWDUtil.SetDisplay(f,e);e&&"hidden"==f.style.visibility&&(f.style.visibility="");break;default:this.bXMLGetAttributSafe(r,this.XML_CHAMP_PROP_NUM_VISIBLE_PARENTRELATIF)||this.bXMLGetAttributSafe(r,this.XML_CHAMP_PROP_NUM_VISIBLE_PARENTFLUX)?clWDUtil.SetDisplay(f,e):f&&f.style&&(f.style.visibility=e?"inherit":"hidden")}f&&AppelMethode(WDChamp.prototype.ms_sOnDisplay,[f,e])},ActionProprieteImage:function(n,t,i,r){if(n){var u=this.sXMLGetValeur(i);switch(t){case this.XML_CHAMP_TYPE_PAGECORNEE:n.style.backgroundImage=clWDUtil.sGetURICSS(u);AppelMethodeChamp(r,WDCornage.prototype.ms_sInitTailleImage,[u]);break;default:n.src=u}}},ActionProprieteURL:function(n,t,i,r){var f=n,u;switch(t){case this.XML_CHAMP_TYPE_MAPAREA:n&&clWDUtil.bBaliseEstTag(n,"img")&&clWDUtil.bBaliseEstTag(n.parentNode,"a")&&(n=n.parentNode);break;default:n=_JGE(r,document,!1,!0);n||(n=f)}n&&clWDUtil.bBaliseEstTag(n,"td")&&(n=n.firstChild);n&&(u=this.sXMLGetValeur(i),clWDUtil.bBaliseEstTag(n,"input")?this.__PatchOnClick(n,r,this.ms_oRegExpURLInput,function(){return"('"+u+"'"}):n.href=u)},ActionProprieteBulle:function(n,t,i,r){function f(n){return n.title=u,!0}var u=this.sXMLGetValeur(i);switch(t){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:clWDUtil.bForEach(document.getElementsByName(r),f);return;case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:n=this.__oGetConteneurParent(r,t,!1);break;case this.XML_CHAMP_TYPE_VOLETONGLET:n&&clWDUtil.bForEach(n.getElementsByTagName("a"),f);break;case this.XML_CHAMP_TYPE_JAUGE:AppelMethodeChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLE,null,u,null,null]);return;case WDChamp.prototype.ms_nIDObjetBouton:n.firstChild&&(n.firstChild.title=u)}n&&(n.title=u)},ActionProprieteCurseurSouris:function(n,t,i,r){this.ActionProprieteStyleGenerique(n,null,t,r,"cursor",this.sXMLGetValeur(i),!0)},ActionProprietePoliceGras:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontWeight",this.nXMLGetValeur(r),!0)},ActionProprietePoliceItalique:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontStyle",this.bXMLGetValeur(r)?"italic":"normal",!0)},ActionProprietePoliceNom:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontFamily",this.sXMLGetValeur(r),!0)},ActionProprietePoliceSoulignee:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"textDecoration",this.bXMLGetValeur(r)?"underline":"none",!0)},ActionProprietePoliceTaille:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"fontSize",this.sXMLGetValeur(r),!0)},ActionProprieteOpacite:function(n,t,i,r,u){var f=this.nXMLGetValeur(r);isNaN(f)?f=100:f<0?f=0:f>100&&(f=100);switch(i){case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_JAUGE:AppelMethodeChamp(u,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_OPACITE,null,f,n,null]);return;case this.XML_CHAMP_TYPE_PAGECORNEE:break;default:n=t}clWDUtil.nSetOpacite(f,n)},ActionProprieteCadrageH:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"textAlign",this.sXMLGetValeur(r),!0)},ActionProprieteCadrageV:function(n,t,i,r,u){this.ActionProprieteStylePolice(n,t,i,u,"verticalAlign",this.sXMLGetValeur(r),!0)},ActionProprieteSelectionnee:function(n,t,i,r){var u=this.bXMLGetValeur(r),f,e;switch(i){case this.XML_CHAMP_TYPE_SOUSMENU:case this.XML_CHAMP_TYPE_OPTIONMENU:case this.XML_CHAMP_TYPE_MENUPOPUP:f=u?"":"Select";e=u?"Select":"";clWDUtil.bForEach(["WDOngletOption","WDMenuOption"],function(n){return clWDUtil.bForEach(["","Hover"],function(i){return clWDUtil.RemplaceClassNameSiExiste(t,n+f+i,n+e+i),!0}),!0})}},ActionProprieteIndication:function(n,t,i,r){AppelMethodeChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_INDICATION,null,this.sXMLGetValeur(i),n,null])},ActionProprieteBoutonCalendrier:function(n,t,i,r){AppelMethodeChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_BOUTONCALENDRIER,null,this.bXMLGetValeur(i),n,null])},ActionProprieteContenu:function(n,t,i,r,u){switch(i){case WDChamp.prototype.ms_nIDObjetImage:case this.XML_CHAMP_TYPE_MAPAREA:case this.XML_CHAMP_TYPE_VIGNETTE:case this.XML_CHAMP_TYPE_GRAPHE:case this.XML_CHAMP_TYPE_RANGESLIDER:case this.XML_CHAMP_TYPE_AGENDA:case this.XML_CHAMP_TYPE_VIDEO:case this.XML_CHAMP_TYPE_PLANNING:case this.XML_CHAMP_TYPE_JAUGE:case this.XML_CHAMP_TYPE_CARTE:case this.XML_CHAMP_TYPE_POTENTIOMETRE:AppelMethodeChampPtr(u,WDChamp.prototype.DeduitParam,[this.sXMLGetValeur(r)]);break;default:AppelMethodeChampPtr(u,WDChamp.prototype.PreAffecteHTML,[!0]);t.innerHTML=clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(r),!1,!0);AppelMethodeChampPtr(u,WDChamp.prototype.PostAffecteHTML,[!0])}},ActionProprieteValeurSuperieure:function(n,t,i,r){AppelMethodeChamp(r,WDChamp.prototype.ms_sSetProp,[WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURSUPERIEURE,null,this.sXMLGetValeur(i),n,null])},ActionProprieteClasseHTML:function(n,t,i,r){(!n||!bIEQuirks&&(n instanceof HTMLCollection||window.RadioNodeList&&n instanceof RadioNodeList||window.NodeList&&n instanceof NodeList)||bIEQuirks&&1<n.length&&n[0]&&n[0].tagName)&&(n=t);n.className=clWDUtil.sSetClasseHTML(this.sXMLGetValeur(r),n)},ActionProprieteStylePolice:function(n,t,i,r,u,f,e){var o=t;switch(i){case WDChamp.prototype.ms_nIDObjetSaisie:case WDChamp.prototype.ms_nIDObjetBouton:case this.XML_CHAMP_TYPE_LISTE:case this.XML_CHAMP_TYPE_CHAMPFORMATE:case WDChamp.prototype.ms_nIDObjetCombo:case this.XML_CHAMP_TYPE_LIEN:case this.XML_CHAMP_TYPE_TREEVIEW:case WDChamp.prototype.ms_nIDObjetLibelle:o=n;break;case this.XML_CHAMP_TYPE_COLONNETABLE:case this.XML_CHAMP_TYPE_COLONNETABLEH:this.ActionProprieteCouleurFeuilleStyle("#c-"+r,u,f);return;case this.XML_CHAMP_TYPE_JAUGE:o=oGetObjetChamp(r).m_oLibelleInterne}this.ActionProprieteStyleGenerique(o,t,i,r,u,f,e)},ActionProprieteStyleGenerique:function(n,t,i,r,u,f,e){if(n){switch(i){case WDChamp.prototype.ms_nIDObjetInterrupteur:case this.XML_CHAMP_TYPE_SELECTEUR:(!bIEQuirks&&(n instanceof HTMLCollection||window.RadioNodeList&&n instanceof RadioNodeList||window.NodeList&&n instanceof NodeList)||bIEQuirks&&1<n.length&&n[0]&&n[0].tagName)&&clWDUtil.bForEach(n,function(n){var t=n.parentNode;return t&&clWDUtil.bBaliseEstTag(t,"label")&&(n=t),n.style[u]=f,!0});n=_JGE(r.substr(r.length-2,2)=="[]"?r.substr(0,r.length-2):r,document,!1,!0);break;case this.XML_CHAMP_TYPE_CHEMINNAV:case this.XML_CHAMP_TYPE_PLANSITE:case this.XML_CHAMP_TYPE_REGLETTE:case this.XML_CHAMP_TYPE_TREEVIEW:e&&clWDUtil.bForEach(n.getElementsByTagName("a"),function(n){return n.style[u]=f,!0})}n.style&&(n.style[u]=f)}},ActionProprieteCouleurFeuilleStyle:function(n,t,i){for(var f=document.getElementsByTagName("style"),e=f.length,u,r=0;r<e;r++)u=clWDUtil.oStyleTrouveDansBalise(f[r],n),u&&(u.style[t]=i)},ActionChampJS:function(n,t,i){n||(n=_JGE(t,document));n&&eval("arguments[0]"+this.sXMLGetValeur(i))},ActionChampOptions:function(n,t){if(n)for(var i=t.firstChild;i;){switch(i.nodeName){default:case this.XML_CHAMP_OPTIONS_OPTION:n.options[n.options.length]=new Option(this.sXMLGetValeur(i),n.options.length+1);n.options[n.options.length-1].innerHTML=clWDUtil.sEncodeInnerHTML(n.options[n.options.length-1].innerHTML,!1,!0);break;case this.XML_CHAMP_SATURATION:n.options[n.options.length]=new Option(this.sXMLGetValeur(i),-1)}i=i.nextSibling}},ActionChampLignes:function(n,t,i,r,u){var f=oGetObjetChamp(r);f&&f.bActionListeDepuisAJAX?f.bActionListeDepuisAJAX(i,-1):n&&this.ActionChampLignesInterne(n,t,i,r,u)},ActionChampLignesInterne:function(n,t,i,r,u){var et=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_DEBUT),ot=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_NOMBRE),ui=this.nXMLGetAttribut(i,this.XML_CHAMP_LIGNES_SELECTION),k=this.nXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_RUPTURES,0),bt=this.nXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_COLONNES,1),vt=1<bt,fi=u[r+"_DATA"],st,kt,ei,d,it,g,dt,f,c,y,p,nt,oi,a,hi,yt,lt,ci,ut,ti,vi,ii,ri,ft,at,pt,wt;fi&&(fi.value=this.sXMLGetAttributSafe(i,this.XML_CHAMP_LIGNES_DATA,""));for(var tt=parseInt(u[r+"_DEB"].value,10),v,h=this.__oGetConteneurParent(r,t,!0),s=this.__oGetConteneurTBODY(h,t);tt<et&&this.__bSupprimeLigne(r,t,tt,k,h,s);)tt++;if(tt>=et+ot)while(this.__bSupprimeLigne(r,t,tt,k,h,s))tt++;if(0<k)switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_ZONEREPETEE:for(st=i.firstChild;st;)v=this.nXMLGetAttribut(st,this.XML_CHAMP_LIGNES_LIGNE_INDICE),this.__SupprimeRuptures(r,v,k,s),st=st.nextSibling}if(1==this.nXMLGetAttributSafe(i,this.XML_CHAMP_REFRESH_RESETTABLE,0)){for(ei="tt"+r,d=document.getElementById(ei),d&&!clWDUtil.bEstFils(d,s,document)&&(d=null),it=s.childNodes,clWDUtil.bForEachInverse(it,function(n){return n.nodeName=="#text"&&s.removeChild(n),!0}),g=0;g<it.length;)kt=it[g],d?(kt==d&&(g+1<it.length&&it[g+1].offsetHeight<=1&&g++,d=null),g++):s.removeChild(kt);dt="rgs-"+r+"-";clWDUtil.bForEachInverse(document.getElementsByTagName("style"),function(n){var t=n.id;return t&&dt==t.substr(0,dt.length)&&n.parentNode.removeChild(n),!0})}for(bIE&&(f=clWDUtil.bBaliseEstTag(h,"td")?h.innerHTML:h.outerHTML,f=this.sSupprimeEspacements(f)),nt=-1,oi=this.bXMLAttributExiste(i,this.XML_CHAMP_LIGNES_STYLE),p=i.firstChild;p;p=p.nextSibling){v=this.nXMLGetAttribut(p,this.XML_CHAMP_LIGNES_LIGNE_INDICE);var o=this.__oGetConteneurLigne(r,v,s),gt=p.childNodes.length==1,ht=gt?"":clWDUtil.sSupprimeEspacesDebutFin(clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(p.childNodes[0]),!1,!0)),l=clWDUtil.sSupprimeEspacesDebutFin(clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(p.childNodes[gt?0:1]),!1,!0)),ct=gt?"":clWDUtil.sSupprimeEspacesDebutFin(clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(p.childNodes[2]),!1,!0)),ni=this.bXMLGetAttributSafe(p,this.XML_CHAMP_LIGNES_LIGNE_INVISIBLE),si=this.bXMLGetAttributSafe(p,this.XML_CHAMP_LIGNES_LIGNE_REPLIEE),e=ht+l+ct,rt;if(oi&&this.ActionLigneStyle(r,v,this.sXMLGetValeur(p.childNodes[3])),!ni&&!o){for(a=null,hi=et+ot,nt=Math.max(nt-1,v+1);nt<hi&&!a;nt++)a=this.__oTrouveRuptureExterne(r,!0,nt,k,s),a||(a=this.__oGetConteneurLigne(r,nt,s));if(a){0<e.length&&(bIE?(yt=a.outerHTML,yt=this.sSupprimeEspacements(yt),lt=f.indexOf(yt),ci=lt,rt=e.substr(0,4).toLowerCase(),(rt="<tr>")&&rt==f.substr(lt-4,4).toLowerCase()&&(lt-=4),f=f.substring(0,lt)+e+f.substring(ci),y=c=undefined):this.__bHTMLDebutTR(e)?(clWDUtil.bBaliseEstTag(a,"td")&&(a=a.parentNode),si||e.substr(e.length-5,5).toLowerCase()=="<\/tr>"?this.__InsereElementDansTable(a,e):this.__InsereRemplaceTrTdDansTable(a,e,!0,null)):e.substr(e.length-5,5).toLowerCase()=="<\/tr>"?(clWDUtil.bBaliseEstTag(a,"td")&&(a=a.parentNode),this.__InsereRemplaceTrTdDansTable(a,e,!1,null)):this.__AjouteElementDansTable(a.parentNode.previousSibling,e));continue}}if(o)if(bIE){ni&&(e="");ut=o.outerHTML;ut=this.sSupprimeEspacements(ut);var b=f.indexOf(ut),w=ut.length,li=this.__bHTMLDebutTR(e),yi=this.__bHTMLDebutTD(e),ai="<tr>"==f.substr(b-4,4).toLowerCase();li&&ai&&(b-=4,w+=4);rt=e.substr(0,9).toLowerCase();rt=="<\/tr><tr>"&&rt==f.substr(b-9,9).toLowerCase()&&(b-=9,w+=9);vt&&(ti=e.substr(e.length-5,5).toLowerCase(),ti=="<\/tr>"&&ti==f.substr(b+w,5).toLowerCase()?w+=5:(ut.substr(w-5,5).toLowerCase()=="<\/tr>"&&(w-=5),li&&f.substr(b+w,5).toLowerCase()=="<\/tr>"&&(e="<\/tr>"+e,w+=5),yi&&ai&&(b-=4,w+=4)));f=f.substring(0,b)+e+f.substring(b+w);y=c=undefined}else o=document.getElementById(r+"_"+v),t==this.XML_CHAMP_TYPE_ZONEREPETEE&&this.__SupprimeRuptures(r,v,k,s),ni?(clWDUtil.bBaliseEstTag(o,"div")&&clWDUtil.bBaliseEstTag(o.parentNode,"td")&&this.__bAvecFilsActifUnique(o.parentNode)&&(o=o.parentNode,clWDUtil.bBaliseEstTag(o.parentNode,"tr")&&this.__bAvecFilsActifUnique(o.parentNode)&&(o=o.parentNode)),clWDUtil.oSupprimeElement(o)):(clWDUtil.bBaliseEstTag(o,"div")&&clWDUtil.bBaliseEstTag(o.parentNode,"td")&&(o=o.parentNode),this.__bHTMLDebutTR(l)?(vi=o,clWDUtil.bBaliseEstTag(o,"td")&&(o=o.parentNode),si?(this.__InsereElementDansTable(o,l),o=this.__bAvecFilsActifUnique(o)?o:vi,clWDUtil.oSupprimeElement(o)):l.substr(l.length-5,5).toLowerCase()!="<\/tr>"?this.__InsereRemplaceTrTdDansTable(o,l,!0,o.firstChild):this.__RemplaceElementDansTable(o,l)):l.substr(l.length-5,5).toLowerCase()=="<\/tr>"?(clWDUtil.bBaliseEstTag(o,"td")?(ii=o.parentNode,ri=o):(ii=o,ri=o.lastChild),this.__InsereRemplaceTrTdDansTable(ii,l,!1,ri)):this.__RemplaceElementDansTable(o,l)),h==s&&(h=this.__oGetConteneurParent(r,t,!0),s=this.__oGetConteneurTBODY(h,t));else e.length>0&&(bIE?s&&(s!=h||clWDUtil.bBaliseEstTag(s,"table"))?(f||(f=h.outerHTML,f=this.sSupprimeEspacements(f),y=c=undefined),f.substr(f.length-8).toLowerCase()=="<\/table>"?vt?(undefined===y&&(y=f.toLowerCase().lastIndexOf("<\/tr>")),y==-1?(undefined===c&&(c=f.toLowerCase().lastIndexOf("<\/tbody>")),-1==c&&(c=f.toLowerCase().lastIndexOf("<\/table>")),at=!1,ht.toLowerCase().indexOf("<\/tr>")==0?(at=!0,ht=ht.substring(5)):l.toLowerCase().indexOf("<\/tr>")==0&&(at=!0,l=l.substring(5)),ct.toLowerCase().lastIndexOf("<\/tr>")!=ct.length-5&&l.toLowerCase().lastIndexOf("<\/tr>")!=l.length-5&&(at=!0,ct+="<\/tr>"),at&&(e=ht+l+ct),f=f.substring(0,c)+e+f.substring(c),y=undefined,c+=e.length):(f=f.substring(0,y)+e+f.substring(y),y+=e.length,c=undefined)):(undefined===c&&(c=f.toLowerCase().lastIndexOf("<\/tbody>")),-1==c&&(c=f.toLowerCase().lastIndexOf("<\/table>")),t==this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE&&(c=f.toLowerCase().substr(0,c).lastIndexOf("<\/tr>")),f=f.slice(0,c)+e+f.substring(c),y=undefined,c+=e.length):(f+=e+h.tagName,y=c=undefined)):(f=undefined,ft=s,ft.insertAdjacentHTML("beforeEnd",e),h=this.__oGetConteneurParent(r,t,!0),s=this.__oGetConteneurTBODY(h,t)):(ft=s,this.__bHTMLDebutTR(e)?e.substr(l.length-5,5).toLowerCase()!="<\/tr>"&&(e=e+"<\/tr>"):l.substr(l.length-5,5).toLowerCase()=="<\/tr>"?vt?(ft=s.lastChild,e=e.substr(0,l.length-5)):e="<tr>"+e:vt&&this.__bHTMLDebutTD(e)&&(ft=s.lastChild),this.__AjouteElementDansTable(ft,e),h==s&&(h=this.__oGetConteneurParent(r,t,!0),s=this.__oGetConteneurTBODY(h,t))))}for(f?(f=f.replace(/\<\/tr\>\<\/tr\>/ig,"<\/tr>"),f=f.replace(/\<tr\>\<tr\>/ig,"<tr>"),f=f.replace(/\<tr[^\>]*\>\s*\<\/tr\>/ig,""),f=f.replace(/\<tr[^\>]*\>\s*\<tr/ig,"<tr"),clWDUtil.bBaliseEstTag(h,"td")?h.innerHTML=f:h.outerHTML=f,h=this.__oGetConteneurParent(r,t,!0),s=this.__oGetConteneurTBODY(h,t)):clWDUtil.bBaliseEstTag(s,"tbody")&&clWDUtil.bForEachInverse(s.childNodes,function(n){return 0==n.childNodes.length&&s.removeChild(n),!0}),v=et+ot,pt=bt;;)if(this.__bSupprimeLigne(r,t,v,k,h,s))v++,pt=bt;else if(pt>1)v++,pt--;else break;bIE||ot!=0||s==h||s.childNodes.length!=0||clWDUtil.SupprimeFils(h);u[r+"_DEB"].value=et;wt=u["_"+r+"_OCC"];wt===undefined&&(wt=u[r+"_OCC"]);wt.value=ot;ui>=0&&(n.value=ui);switch(t){case this.XML_CHAMP_TYPE_TABLE:case this.XML_CHAMP_TYPE_TABLEHIERARCHIQUE:case this.XML_CHAMP_TYPE_ZONEREPETEE:case this.XML_CHAMP_TYPE_ZONEREPETEEHORIZONTALE:AppelMethodePtr(WDChamp.prototype.OnTableZRAfficheAJAX,[r])}clWDUtil.m_oNotificationsAjoutHTML.LanceNotifications(this,h)},ActionLigneStyle:function(n,t,i){var e,u,f,r,o;if("<style "==i.substr(0,7))this.__SupprimeStyleLigne(n,t),e=document.getElementsByTagName("head")[0],!bIE||10<=nIE?e.insertAdjacentHTML("beforeend",i):(u=clWDUtil.oCreeFeuilleStyle(),u.owningElement.id="rgs-"+n+"-"+t,u.cssText=i.substring(i.indexOf(">")+1,i.lastIndexOf("<")));else for(f=i.split("}"),o=f.length,r=0;r<o;r++)this._ActionLigneStyleLigne(f[r])},_ActionLigneStyleLigne:function(n){var u=n.indexOf("{"),e,i,t,f;if(!(u<=0)){e=n.substring(0,u);i=n.substring(u+1);i=this.__sTrim(i,!0,!0);for(var s=clWDUtil.oGetFeuilleStyle(document.getElementsByTagName("style")[0]),o=e.split(","),h=o.length,r=0;r<h;r++)(t=this.__sTrim(o[r]),t=t.replace(this.ms_oRegExpRC,""),t.length!=0&&t!="#")&&(f=this._oActionSupprimeStyle(bIE?t:t.toLowerCase()),i.length>0&&clWDUtil.CreeStyle(f?f:s,t,i))}},_oActionSupprimeStyle:function(n){for(var s=document.getElementsByTagName("style"),l=s.length,e,t,r,h,c,u=0;u<l;u++)for(var f=clWDUtil.oGetFeuilleStyle(s[u]),o=clWDUtil.tabGetStyleRegles(f),a=o.length,i=0;i<a;i++)if(e=o[i].selectorText,clWDUtil.m_bStyleNorme){if(e)for(t=e.split(","),h=t.length,r=0;r<h;r++)if(t[r]=clWDUtil.sSupprimeEspaces(t[r]),t[r].toLowerCase()==n){t.splice(r,1);c=o[i].style.cssText;clWDUtil.StyleSupprime(f,i);0<t.length&&clWDUtil.CreeStyle(f,t.join(","),c);return}}else if(e==n){clWDUtil.StyleSupprime(f,i);return}},ActionChampTreeview:function(n,t,i){var r,u;document.getElementsByName(i+"_AS")[0].value=this.sXMLGetValeur(t.childNodes[0]);document.getElementsByName(i)[0].value=this.sXMLGetValeur(t.childNodes[1]);r=this.sXMLGetValeur(t.childNodes[2]);document.getElementsByName("NEX_"+i)[0].value=r;window["oItems_"+i]=r.split(",");u=document.getElementById(i+"_");u.innerHTML=clWDUtil.sEncodeInnerHTML(this.sXMLGetValeur(t.childNodes[3]),!1,!0)},ActionChampRecharge:function(n,t,i,r){var e,f,u,o,s;if(n){if(this.bXMLAttributExiste(i,this.XML_CHAMP_RECHARGE_PARAM)){switch(t){case this.XML_CHAMP_TYPE_GRAPHE:e=WDGraphe.prototype.DeduitParamBarre;break;default:e=WDChamp.prototype.DeduitParam}AppelMethodeChampPtr(r,e,[this.sXMLGetAttribut(i,this.XML_CHAMP_RECHARGE_PARAM)])}f=new RegExp("("+r+"\\=)(\\d+)","i");u=n.src;f.test(u)?n.src=u.replace(f,function(n,t,i){return t+(parseInt(i,10)+1)}):(o=new RegExp("("+r+"\\=)([^\\d]|$)","i"),o.test(u)&&(n.src=u.replace(o,function(n,t,i){return t+(new Date).getTime()+i})));s=n.parentNode;clWDUtil.bBaliseEstTag(s,"a")&&this.__PatchOnClick(s,r,f,function(n,t,i){return t+(parseInt(i,10)+1)})}},__PatchOnClick:function(n,t,i,r){if(n.onclick){var u=this.m_tabOnClick[t]||n.getAttributeNode("onclick").value;i.test(u)&&(u=u.replace(i,r),n.onclick=new Function("",u),this.m_tabOnClick[t]=u)}},ActionChampRefresh:function(n,t,i){var s=this.nXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_RESETTABLE,0),r=this.sXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_DEBUT,""),u=-1,f,e,o;r==""||isNaN(parseInt(r,10))||(u=parseInt(r,10),r.indexOf(";")>-1&&(f=r.substring(r.indexOf(";")+1)));e=this.nXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_NOMBRE,undefined);o=this.sXMLGetAttributSafe(t,this.XML_CHAMP_REFRESH_DATA,undefined);i&&i.m_oChampTable.m_sAliasChamp==n&&i.SupprimeRequete(!1);AppelMethodeChampPtr(n,WDChamp.prototype.Refresh,[s,u,f,o,e,t.firstChild])},ActionChampSaisieAssistee:function(n,t){var i,r,u;if(window.$&&(i=$("."+n),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_FILTRE)&&i.data("saisieassistee-filtre",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_FILTRE)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_OUVERTUREAUTO)&&i.data("saisieassistee-ouvertureauto",this.bXMLGetAttributSafe(t,this.XML_CHAMP_SAISIEA_OUVERTUREAUTO)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_TAILLEMIN)&&i.data("saisieassistee-taillemin",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_TAILLEMIN)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_DELAI)&&i.data("saisieassistee-delai",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_DELAI)),this.bXMLAttributExiste(t,this.XML_CHAMP_SAISIEA_SANSCASSE)&&i.data("saisieassistee-sanscasse",this.nXMLGetAttribut(t,this.XML_CHAMP_SAISIEA_SANSCASSE)),r=t.firstChild,r)){for(i.autocomplete("wbRazAutocompleteProg"),u=[];r;){switch(r.nodeName){case this.XML_CHAMP_SAISIEA_OPTION:u.push(this.sXMLGetValeur(r))}r=r.nextSibling}i.autocomplete("wbConcatAutocompleteProg",u)}},ActionChamp:function(n,t,i){for(var r=this.sXMLGetAttribut(t,this.XML_CHAMP_ATT_ALIAS),f=this.nXMLGetAttribut(t,this.XML_CHAMP_ATT_TYPE),e=this.__oChercheChamp(n,r,f),o=this.__oChercheChamp(n,r,f,!0,!1),u=t.firstChild;u!=null;){switch(u.nodeName){case this.XML_CHAMP_PROP:switch(this.nXMLGetAttribut(u,this.XML_CHAMP_PROP_ATT_NUM)){case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURAFFICHEE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEUR:this.ActionProprieteValeur(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLE:case WDChamp.prototype.XML_CHAMP_PROP_NUM_LIBELLEHTML:this.ActionProprieteLibelle(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_HAUTEUR:this.ActionProprieteHauteur(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_LARGEUR:this.ActionProprieteLargeur(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEUR:this.ActionProprieteCouleur(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_COULEURFOND:this.ActionProprieteCouleurFond(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_ETAT:this.ActionProprieteEtat(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_VISIBLE:o=this.__oChercheChamp(n,r,f,!0,!0);this.ActionProprieteVisible(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_IMAGE:this.ActionProprieteImage(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_URL:this.ActionProprieteURL(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_BULLE:this.ActionProprieteBulle(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_X:o=this.__oChercheChamp(n,r,f,!0,!0);this.ActionProprieteX(o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_Y:o=this.__oChercheChamp(n,r,f,!0,!0);this.ActionProprieteY(o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CURSEURSOURIS:this.ActionProprieteCurseurSouris(o,f,u);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEGRAS:this.ActionProprietePoliceGras(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICEITALIQUE:this.ActionProprietePoliceItalique(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICENOM:this.ActionProprietePoliceNom(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICESOULIGNE:this.ActionProprietePoliceSoulignee(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_POLICETAILLE:this.ActionProprietePoliceTaille(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_OPACITE:this.ActionProprieteOpacite(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CADRAGEH:this.ActionProprieteCadrageH(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CADRAGEV:this.ActionProprieteCadrageV(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_SELECTIONNEE:this.ActionProprieteSelectionnee(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_INDICATION:this.ActionProprieteIndication(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_BOUTONCALENDRIER:this.ActionProprieteBoutonCalendrier(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CONTENU:this.ActionProprieteContenu(e,o,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_VALEURSUPERIEURE:this.sXMLGetValeur(e,f,u,r);break;case WDChamp.prototype.XML_CHAMP_PROP_NUM_CLASSE:this.ActionProprieteClasseHTML(e,o,f,u,r)}break;case this.XML_CHAMP_JS:this.ActionChampJS(e,r,u);break;case this.XML_CHAMP_LIGNES:this.ActionChampLignes(e,f,u,r,n);e=this.__oChercheChamp(n,r,f);o=this.__oChercheChamp(n,r,f,!0);break;case this.XML_CHAMP_OPTIONS:this.ActionChampOptions(e,u);break;case this.XML_CHAMP_RECHARGE:this.ActionChampRecharge(e,f,u,r);break;case this.XML_CHAMP_REFRESH:this.ActionChampRefresh(r,u,i);break;case this.XML_CHAMP_SAISIEA:this.ActionChampSaisieAssistee(r,u);break;case this.XML_CHAMP_TREEVIEW:this.ActionChampTreeview(e,u,r)}u=u.nextSibling}},ActionJS:function(n,t){var i=unescape(this.sXMLGetValeur(t));eval(i)},ActionRedirection:function(n,t){var i=this.sXMLGetValeur(t);document.location.replace(unescape(i))},ActionTrace:function(n,t,i){function s(n){n&&f.push(clWDUtil.sGetInnerText(n))}for(var r=_JGE(this.XML_TRACE_ID,document),u=this.sXMLGetValeur(t),f=[],e,o;e=_JGE(this.XML_WBTRACE_ID,document);)i&&s(e),clWDUtil.oSupprimeElement(e);if(i&&(s(r),0<u.length&&f.push(u),u=f.join("\r\n")),u.length==0){clWDUtil.oSupprimeElement(r);return}r||(r=document.createElement("div"),r.id=this.XML_TRACE_ID,r.style.width="1024px",r.style.backgroundColor="#FFFF00",r.style.color="#000000",r.style.fontFamily="Courier New,Courier,mono",r.style.fontSize="small",r.style.textAlign="left",o=document.body.firstChild,r=o?document.body.insertBefore(r,o):document.body.insertBefore(r));r.innerHTML=clWDUtil.sEncodeInnerHTML(u,!0)},ActionMAJLienSociaux:function(n){this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_FACEBOOK,["FB","XFBML"],"parse");this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_TWEETER,["twttr","widgets"],"load");this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_GOOGLEPLUS,["gapi","plusone"],"go");this.__ActionMAJLienSocial(n,this.XML_LIENSOCIAL_LINKEDIN,["IN"],"init")},__ActionMAJLienSocial:function(n,t,i,r){if(t==(n&t)){for(var u=window,e=i.length,f=0;f<e;f++)if(u=u[i[f]],!u)return;u[r]&&u[r]()}},bActionXML:function(n,t,i,r){var u=i.getElementsByTagName(this.XML_RACINE),f,e,s,h;if(u&&(f=u?u[0]:null,f)){var c=function(){for(var i=f.firstChild,o=!1,u,e;i;){switch(i.nodeName){case this.XML_CHAMP:this.ActionChamp(n,i,t);break;case this.XML_JS:this.ActionJS(n,i);break;case this.XML_REDIR:this.ActionRedirection(n,i);break;case this.XML_LISTE:t.ActionListe(i);o=!0;break;case this.XML_RESULTAT:r.push(this.sXMLGetValeur(i));break;case this.XML_TRACE:u=i;break;case this.XML_LIENSOCIAL:e=this.nXMLGetValeur(i)}i=i.nextSibling}u&&this.ActionTrace(n,u,o);e&&this.ActionMAJLienSociaux(e)},l=this,o=function(){c.apply(l,arguments)};return bIE&&nIE<=11?(e=[],clWDUtil.bForEachIn(WDChamp.prototype.ms_tabTablesZRs.m_tabChamps,function(t){var i=n[t+"_DEB"];return i&&i.parentNode&&e.push(i.parentNode),!0}),s=document.body,h=function(n){var i=n.target,t;if(clWDUtil.bBaliseEstTag(i,"input")&&"hidden"==i.type)return!1;for(t=i;t!=s;t=t.parentNode)if(!t)return!1;return clWDUtil.bForEach(e,function(n){return!clWDUtil.bEstFils(i,n,document)})},clWDUtil.bDetecteMutation(document.body,o,h,!0)&&clWDUtil.m_oNotificationsFinAJAX.LanceNotifications()):o(),!0}return!1},ErreurAJAX:function(){var n=clWDUtil.sGetPageAction(null,!0);n+="?"+this.sCommandeAjax_Erreur;document.location=n},AJAXExecuteEvenement:function(n,t,i,r,u){if(this.m_bBloque){this.m_bBloque=!1;return}if(this.bWDAJAXMainValide()){if(!this.AJAXDisponible()){this.NormalExecuteEvenement(n,t,i,r,u);return}var f={};f.oPage=n;f.sChamp=t;f.nEvenement=i;f.nOption=r;f.m_fCodeApresAjax=u;this.m_tabRequetes.push(f);this.ReactualiseActivite(!0);window.WDAnimSurPopup&&WDAnimSurPopup.prototype.s_Pause();this.__SetTimeoutTraiteAJAXExecuteEvenement()}},__SetTimeoutTraiteAJAXExecuteEvenement:function(){this.m_bForceAppelSynchrone?(this.TraiteAJAXExecuteEvenement(),delete this.m_bForceAppelSynchrone):undefined===this.m_nSetTimeout_AJAX&&(this.m_nSetTimeout_AJAX=clWDUtil.nSetTimeout(this.m_pfTraiteAJAXExecuteEvenement,clWDUtil.ms_oTimeoutImmediat))},TraiteAJAXExecuteEvenement:function(){var n,t;for(delete this.m_nSetTimeout_AJAX,this.ReactualiseActivite(!1);this.m_tabRequetes.length>0;)if(n=this.m_tabRequetes[0],this.m_tabRequetes.shift(),t=this.bAJAXExecuteEvenementInterne(n.oPage,n.sChamp,n.nEvenement,n.nOption,n.m_fCodeApresAjax),t||(this.m_tabRequetes.length=0),this.m_bInvokeAndWait&&this.m_tabRequetes.length>0){this.__SetTimeoutTraiteAJAXExecuteEvenement();break}},bAJAXExecuteEvenementInterne:function(n,t,i,r,u){var e,o,f,s;if(this.bWDAJAXMainValide())try{return(e=this.sConstuitRequeteEvenement(n,t,i,r),""==e)?!0:(o=this.sConstruitURL(clWDUtil.sGetPageAction(n)),f=this.clCreeWDAJAXRequete(!0,!0),f?(this.__xEnvoi(f,e,o),s=this.bReponseGenerique(f,n,null,[]),u&&u(),s):(this.ErreurAJAX(),!1))}finally{window.WDAnimSurPopup&&WDAnimSurPopup.prototype.s_Continue()}},__xEnvoi:function(n,t,i){var r=n.m_bSynchrone;try{r&&this.m_nRequeteSynchrone++;this.ReactualiseActivite(!1);n.xEnvoi(t,i)}finally{r&&(this.m_nRequeteSynchrone--,this.ReactualiseActivite(!1))}},NormalExecuteEvenement:function(n,t,i,r){switch(r){case 1:case 2:_JSL(n,t,"_self","","");break;case 3:break;case 4:window["_R"+t](i);break;default:_JCL(n.action+"?"+t,"_self","","")}},_sRequeteSynchroneTexte:function(n,t,i,r){var u=this.clCreeWDAJAXRequete(n,!0),f;return u?(this.__xEnvoi(u,t,i),f=u.bValideResultat()?u.sGetResultat(r):"",u.Libere(),u=null,f):(this.ErreurAJAX(),"")},JSONExecute:function(n){var t=this._sRequeteSynchroneTexte(!1,"",n,_PAGE_);return clWDUtil.oEvalJSON(t,{})},AJAXExecuteSynchrone:function(n,t){return this.__AJAXExecute(n,!1,null,t,0,2,arguments)},AJAXExecuteSynchrone20:function(n,t,i){return this.__AJAXExecute(n,!1,null,t,i,3,arguments)},AJAXExecuteAsynchrone:function(n,t,i){return this.__AJAXExecute(n,!0,t,i,0,3,arguments)},AJAXExecuteAsynchrone20:function(n,t,i,r){return this.__AJAXExecute(n,!0,t,i,r,4,arguments)},__AJAXExecute:function(n,t,i,r,u,f,e){var s,h,o,c;return this.bWDAJAXMainValide()?(s=this.sConstuitRequeteProcedure(n,r,u),s+=clWDUtil.sConstuitProcedureParams(f,e),h=this.sConstruitURL(clWDUtil.sGetPageAction()),t?(o=this.clCreeWDAJAXRequete(!0,!1),o?(c=o.m_nId,i||0==(u&1)||(i=clWDUtil.m_pfVide),o.m_fCallback=i,this.__xEnvoi(o,s,h),c):(this.ErreurAJAX(),"")):this._sRequeteSynchroneTexte(!0,s,h,_PAGE_)):""},AJAXAppelAsynchroneEnCours:function(n){if(!this.bWDAJAXMainValide())return!1;var t=this.GetWDAJAXRequete(n);return t!=null&&t.bEnCours()},AJAXAnnuleAppelAsynchrone:function(n){if(!this.bWDAJAXMainValide())return!1;var t=this.GetWDAJAXRequete(n);t!=null&&t.Annule()},__nAJAXRecupereLignesTable:function(n,t){var r,i,u;return this.bWDAJAXMainValide()?(r=this.sConstruitURL(clWDUtil.sGetPageAction()),i=this.clCreeWDAJAXRequete(!0,!1,!0),i?(i.Init(n),u=i.m_nId,this.__xEnvoi(i,t,r),u):(this.ErreurAJAX(),!1)):!1},nAJAXRecupereLignesTable:function(n,t){var i=this.sConstuitRequeteTable(t);return this.__nAJAXRecupereLignesTable(n,i)},nAJAXRecupereLignesTableSelection:function(n,t,i){var r=this.sConstuitRequeteEvenement(_PAGE_,n.m_oChampTable.m_sAliasChamp,0,i?5:6)+"&"+t;return this.__nAJAXRecupereLignesTable(n,r)},nAJAXRecupereLignesTableEnrouleDeroule:function(n,t,i){this.SetZRChampEnrouleDeroule(_PAGE_,n.m_oChampTable.m_sAliasChamp,t,-1);var r=this.sConstuitRequeteEvenement(_PAGE_,n.m_oChampTable.m_sAliasChamp,"ENDETABLE",10);return i.length>0&&(r+=i),this.__nAJAXRecupereLignesTable(n,r)},oAJAXRecupereJauge:function(n){var t={m_eJauge:0},i,r;return this.bWDAJAXMainValide()&&(i=this.sConstuitURLRequeteJauge(n),r=this._sRequeteSynchroneTexte(!1,"",i,_PAGE_),t=clWDUtil.oEvalJSON(r,t)),t},InitActivite:function(n,t){this.m_oActiviteChamp=_JGE(n,document,!0);this.m_nActiviteOption=t;clWDUtil.AttacheOnScrollResize(this.m_pfReactualiseActivite);this._ReactualiseActivite()},ReactualiseActivite:function(n){var t=this.m_tabConnection.length>0||this.m_nRequeteSynchrone>0||n;this.m_bActivite!=t&&(this.m_bActivite=t,this._ReactualiseActivite())},_ReactualiseActivite:function(){this.m_oActiviteChamp&&(clWDUtil.DeplaceElement(this.m_oActiviteChamp,document,this.m_nActiviteOption,undefined,undefined,!0),this.m_oActiviteChamp.style.visibility=this.m_bActivite?"inherit":"hidden")}}